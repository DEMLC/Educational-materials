<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="generator" content="pandoc">
  <title>データ研磨スキル [中級編後半]</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="04_intermediate_2nd_half_files/reveal.js-3.3.0.1/css/reveal.css"/>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    background-color: #ffffff;
    color: #a0a0a0;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #a0a0a0;  padding-left: 4px; }
div.sourceCode
  { color: #1f1c1b; background-color: #ffffff; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span { color: #1f1c1b; } /* Normal */
code span.al { color: #bf0303; background-color: #f7e6e6; font-weight: bold; } /* Alert */
code span.an { color: #ca60ca; } /* Annotation */
code span.at { color: #0057ae; } /* Attribute */
code span.bn { color: #b08000; } /* BaseN */
code span.bu { color: #644a9b; font-weight: bold; } /* BuiltIn */
code span.cf { color: #1f1c1b; font-weight: bold; } /* ControlFlow */
code span.ch { color: #924c9d; } /* Char */
code span.cn { color: #aa5500; } /* Constant */
code span.co { color: #898887; } /* Comment */
code span.cv { color: #0095ff; } /* CommentVar */
code span.do { color: #607880; } /* Documentation */
code span.dt { color: #0057ae; } /* DataType */
code span.dv { color: #b08000; } /* DecVal */
code span.er { color: #bf0303; text-decoration: underline; } /* Error */
code span.ex { color: #0095ff; font-weight: bold; } /* Extension */
code span.fl { color: #b08000; } /* Float */
code span.fu { color: #644a9b; } /* Function */
code span.im { color: #ff5500; } /* Import */
code span.in { color: #b08000; } /* Information */
code span.kw { color: #1f1c1b; font-weight: bold; } /* Keyword */
code span.op { color: #1f1c1b; } /* Operator */
code span.ot { color: #006e28; } /* Other */
code span.pp { color: #006e28; } /* Preprocessor */
code span.re { color: #0057ae; background-color: #e0e9f8; } /* RegionMarker */
code span.sc { color: #3daee9; } /* SpecialChar */
code span.ss { color: #ff5500; } /* SpecialString */
code span.st { color: #bf0303; } /* String */
code span.va { color: #0057ae; } /* Variable */
code span.vs { color: #bf0303; } /* VerbatimString */
code span.wa { color: #bf0303; } /* Warning */
</style>

<link rel="stylesheet" href="04_intermediate_2nd_half_files/reveal.js-3.3.0.1/css/theme/sky.css" id="theme">


  <!-- some tweaks to reveal css -->
  <style type="text/css">
    .reveal h1 { font-size: 2.0em; }
    .reveal h2 { font-size: 1.5em;  }
    .reveal h3 { font-size: 1.25em;	}
    .reveal h4 { font-size: 1em;	}

    .reveal .slides>section,
    .reveal .slides>section>section {
      padding: 0px 0px;
    }



    .reveal table {
      border-width: 1px;
      border-spacing: 2px;
      border-style: dotted;
      border-color: gray;
      border-collapse: collapse;
      font-size: 0.7em;
    }

    .reveal table th {
      border-width: 1px;
      padding-left: 10px;
      padding-right: 25px;
      font-weight: bold;
      border-style: dotted;
      border-color: gray;
    }

    .reveal table td {
      border-width: 1px;
      padding-left: 10px;
      padding-right: 25px;
      border-style: dotted;
      border-color: gray;
    }

    .reveal .slide-menu-button {
      left: 105px !important;
    }

  </style>

    <style type="text/css">code{white-space: pre;}</style>

    <link rel="stylesheet" href="for-revealjs.css"/>

<!-- Printing and PDF exports -->
<script id="paper-css" type="application/dynamic-css">

/* Default Print Stylesheet Template
   by Rob Glazebrook of CSSnewbie.com
   Last Updated: June 4, 2008

   Feel free (nay, compelled) to edit, append, and
   manipulate this file as you see fit. */


@media print {

	/* SECTION 1: Set default width, margin, float, and
	   background. This prevents elements from extending
	   beyond the edge of the printed page, and prevents
	   unnecessary background images from printing */
	html {
		background: #fff;
		width: auto;
		height: auto;
		overflow: visible;
	}
	body {
		background: #fff;
		font-size: 20pt;
		width: auto;
		height: auto;
		border: 0;
		margin: 0 5%;
		padding: 0;
		overflow: visible;
		float: none !important;
	}

	/* SECTION 2: Remove any elements not needed in print.
	   This would include navigation, ads, sidebars, etc. */
	.nestedarrow,
	.controls,
	.fork-reveal,
	.share-reveal,
	.state-background,
	.reveal .progress,
	.reveal .backgrounds {
		display: none !important;
	}

	/* SECTION 3: Set body font face, size, and color.
	   Consider using a serif font for readability. */
	body, p, td, li, div {
		font-size: 20pt!important;
		font-family: Georgia, "Times New Roman", Times, serif !important;
		color: #000;
	}

	/* SECTION 4: Set heading font face, sizes, and color.
	   Differentiate your headings from your body text.
	   Perhaps use a large sans-serif for distinction. */
	h1,h2,h3,h4,h5,h6 {
		color: #000!important;
		height: auto;
		line-height: normal;
		font-family: Georgia, "Times New Roman", Times, serif !important;
		text-shadow: 0 0 0 #000 !important;
		text-align: left;
		letter-spacing: normal;
	}
	/* Need to reduce the size of the fonts for printing */
	h1 { font-size: 28pt !important;  }
	h2 { font-size: 24pt !important; }
	h3 { font-size: 22pt !important; }
	h4 { font-size: 22pt !important; font-variant: small-caps; }
	h5 { font-size: 21pt !important; }
	h6 { font-size: 20pt !important; font-style: italic; }

	/* SECTION 5: Make hyperlinks more usable.
	   Ensure links are underlined, and consider appending
	   the URL to the end of the link for usability. */
	a:link,
	a:visited {
		color: #000 !important;
		font-weight: bold;
		text-decoration: underline;
	}
	/*
	.reveal a:link:after,
	.reveal a:visited:after {
		content: " (" attr(href) ") ";
		color: #222 !important;
		font-size: 90%;
	}
	*/


	/* SECTION 6: more reveal.js specific additions by @skypanther */
	ul, ol, div, p {
		visibility: visible;
		position: static;
		width: auto;
		height: auto;
		display: block;
		overflow: visible;
		margin: 0;
		text-align: left !important;
	}
	.reveal pre,
	.reveal table {
		margin-left: 0;
		margin-right: 0;
	}
	.reveal pre code {
		padding: 20px;
		border: 1px solid #ddd;
	}
	.reveal blockquote {
		margin: 20px 0;
	}
	.reveal .slides {
		position: static !important;
		width: auto !important;
		height: auto !important;

		left: 0 !important;
		top: 0 !important;
		margin-left: 0 !important;
		margin-top: 0 !important;
		padding: 0 !important;
		zoom: 1 !important;

		overflow: visible !important;
		display: block !important;

		text-align: left !important;
		-webkit-perspective: none;
		   -moz-perspective: none;
		    -ms-perspective: none;
		        perspective: none;

		-webkit-perspective-origin: 50% 50%;
		   -moz-perspective-origin: 50% 50%;
		    -ms-perspective-origin: 50% 50%;
		        perspective-origin: 50% 50%;
	}
	.reveal .slides section {
		visibility: visible !important;
		position: static !important;
		width: auto !important;
		height: auto !important;
		display: block !important;
		overflow: visible !important;

		left: 0 !important;
		top: 0 !important;
		margin-left: 0 !important;
		margin-top: 0 !important;
		padding: 60px 20px !important;
		z-index: auto !important;

		opacity: 1 !important;

		page-break-after: always !important;

		-webkit-transform-style: flat !important;
		   -moz-transform-style: flat !important;
		    -ms-transform-style: flat !important;
		        transform-style: flat !important;

		-webkit-transform: none !important;
		   -moz-transform: none !important;
		    -ms-transform: none !important;
		        transform: none !important;

		-webkit-transition: none !important;
		   -moz-transition: none !important;
		    -ms-transition: none !important;
		        transition: none !important;
	}
	.reveal .slides section.stack {
		padding: 0 !important;
	}
	.reveal section:last-of-type {
		page-break-after: avoid !important;
	}
	.reveal section .fragment {
		opacity: 1 !important;
		visibility: visible !important;

		-webkit-transform: none !important;
		   -moz-transform: none !important;
		    -ms-transform: none !important;
		        transform: none !important;
	}
	.reveal section img {
		display: block;
		margin: 15px 0px;
		background: rgba(255,255,255,1);
		border: 1px solid #666;
		box-shadow: none;
	}

	.reveal section small {
		font-size: 0.8em;
	}

}  
</script>


<script id="pdf-css" type="application/dynamic-css">
    
/**
 * This stylesheet is used to print reveal.js
 * presentations to PDF.
 *
 * https://github.com/hakimel/reveal.js#pdf-export
 */

* {
	-webkit-print-color-adjust: exact;
}

body {
	margin: 0 auto !important;
	border: 0;
	padding: 0;
	float: none !important;
	overflow: visible;
}

html {
	width: 100%;
	height: 100%;
	overflow: visible;
}

/* Remove any elements not needed in print. */
.nestedarrow,
.reveal .controls,
.reveal .progress,
.reveal .playback,
.reveal.overview,
.fork-reveal,
.share-reveal,
.state-background {
	display: none !important;
}

h1, h2, h3, h4, h5, h6 {
	text-shadow: 0 0 0 #000 !important;
}

.reveal pre code {
	overflow: hidden !important;
	font-family: Courier, 'Courier New', monospace !important;
}

ul, ol, div, p {
	visibility: visible;
	position: static;
	width: auto;
	height: auto;
	display: block;
	overflow: visible;
	margin: auto;
}
.reveal {
	width: auto !important;
	height: auto !important;
	overflow: hidden !important;
}
.reveal .slides {
	position: static;
	width: 100%;
	height: auto;

	left: auto;
	top: auto;
	margin: 0 !important;
	padding: 0 !important;

	overflow: visible;
	display: block;

	-webkit-perspective: none;
	   -moz-perspective: none;
	    -ms-perspective: none;
	        perspective: none;

	-webkit-perspective-origin: 50% 50%; /* there isn't a none/auto value but 50-50 is the default */
	   -moz-perspective-origin: 50% 50%;
	    -ms-perspective-origin: 50% 50%;
	        perspective-origin: 50% 50%;
}

.reveal .slides section {
	page-break-after: always !important;

	visibility: visible !important;
	position: relative !important;
	display: block !important;
	position: relative !important;

	margin: 0 !important;
	padding: 0 !important;
	box-sizing: border-box !important;
	min-height: 1px;

	opacity: 1 !important;

	-webkit-transform-style: flat !important;
	   -moz-transform-style: flat !important;
	    -ms-transform-style: flat !important;
	        transform-style: flat !important;

	-webkit-transform: none !important;
	   -moz-transform: none !important;
	    -ms-transform: none !important;
	        transform: none !important;
}

.reveal section.stack {
	margin: 0 !important;
	padding: 0 !important;
	page-break-after: avoid !important;
	height: auto !important;
	min-height: auto !important;
}

.reveal img {
	box-shadow: none;
}

.reveal .roll {
	overflow: visible;
	line-height: 1em;
}

/* Slide backgrounds are placed inside of their slide when exporting to PDF */
.reveal section .slide-background {
	display: block !important;
	position: absolute;
	top: 0;
	left: 0;
	width: 100%;
	z-index: -1;
}

/* All elements should be above the slide-background */
.reveal section>* {
	position: relative;
	z-index: 1;
}

/* Display slide speaker notes when 'showNotes' is enabled */
.reveal .speaker-notes-pdf {
	display: block;
	width: 100%;
	max-height: none;
	left: auto;
	top: auto;
	z-index: 100;
}

/* Display slide numbers when 'slideNumber' is enabled */
.reveal .slide-number-pdf {
	display: block;
	position: absolute;
	font-size: 14px;
}

</script>


<script>
var style = document.createElement( 'style' );
style.type = 'text/css';
var style_script_id = window.location.search.match( /print-pdf/gi ) ? 'pdf-css' : 'paper-css';
var style_script = document.getElementById(style_script_id).text;
style.innerHTML = style_script;
document.getElementsByTagName('head')[0].appendChild(style);
</script>

    <script src="04_intermediate_2nd_half_files/header-attrs-2.7/header-attrs.js"></script>
    <link href="04_intermediate_2nd_half_files/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
    <link href="04_intermediate_2nd_half_files/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />
</head>
<body>
  <div class="reveal">
    <div class="slides">

<section>
    <h1 class="title">データ研磨スキル<br>[中級編後半]</h1>
    <h3 class="date">2021/02/20</h3>
</section>

<section>
<section id="作業の確認" class="title-slide slide level1 unnumbered">
<h1 class="unnumbered">作業の確認</h1>

</section>
<section id="中級の作業イメージ" class="slide level2 unnumbered">
<h2 class="unnumbered">中級の作業イメージ</h2>
<p>左半分を終えたので、右半分を後半で進めていきます。</p>
<p><img src="../pictures/intermediate/story-image-intmed.png" width="65%" style="display: block; margin: auto;" /></p>
</section>
<section id="目次中級後半" class="slide level2 unnumbered">
<h2 class="unnumbered">目次（中級後半）</h2>
<ul>
<li>前半の作業のおさらい</li>
<li>タテ持ちデータ・ヨコ持ちデータ</li>
<li>データの検証</li>
<li>前年度比の算出</li>
<li>演習</li>
<li>データの可視化</li>
<li>ランキングの作成</li>
</ul>
</section></section>
<section>
<section id="前半の作業のおさらい" class="title-slide slide level1">
<h1>前半の作業のおさらい</h1>

</section>
<section id="複数データの読み込み" class="slide level2">
<h2>複数データの読み込み</h2>
<p>listとfor文を使って複数データを一括で読み込みました。</p>
<p><img src="../pictures/intermediate/for-explain.png" width="100%" style="display: block; margin: auto;" /></p>
</section>
<section id="タテ結合とヨコ結合" class="slide level2">
<h2>タテ結合とヨコ結合</h2>
<p>2通りの方法で複数データを結合し、long_dataとwide_dataを作成しました。</p>
<div class="columns">
<div class="column" style="width:48%;">
<p>bind_rowsでタテに結合 （long_data）</p>
<p><img src="../pictures/intermediate/bind-ver.png" width="100%" style="display: block; margin: auto;" /></p>
</div><div class="column" style="width:2%;">

</div><div class="column" style="width:48%;">
<p>left_joinでヨコに結合 （wide_data）</p>
<p><img src="../pictures/intermediate/join-ver.png" width="100%" style="display: block; margin: auto;" /></p>
</div>
</div>
</section></section>
<section>
<section id="widedata_longdata" class="title-slide slide level1">
<h1>タテ持ちデータ・ヨコ持ちデータ</h1>
<ul>
<li>データ保持形式を理解し、タテヨコ変換を習得します</li>
<li>pivot_longer</li>
<li>pivot_wider</li>
</ul>
</section>
<section id="what_widelong" class="slide level2">
<h2>タテ持ち・ヨコ持ちとは</h2>
<ul>
<li>タテ持ちデータとヨコ持ちデータの違いは、<strong>データを保持する形式</strong>の違いだけです</li>
<li>中級前半で作成したlong_dataがタテ持ちデータ、wide_dataがヨコ持ちデータとなっています</li>
<li>スライド上では見やすさのため、従業員数カラムに着目した小規模データで表示しています</li>
</ul>
<div class="columns">
<div class="column" style="width:48%;">
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

#coiqphlojx .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #F4F7E2;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#coiqphlojx .gt_heading {
  background-color: #F4F7E2;
  text-align: center;
  border-bottom-color: #F4F7E2;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#coiqphlojx .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  border-bottom-color: #F4F7E2;
  border-bottom-width: 0;
}

#coiqphlojx .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 4px;
  border-top-color: #F4F7E2;
  border-top-width: 0;
}

#coiqphlojx .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#coiqphlojx .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#coiqphlojx .gt_col_heading {
  color: #333333;
  background-color: #F4F7E2;
  font-size: 100%;
  font-weight: bold;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#coiqphlojx .gt_column_spanner_outer {
  color: #333333;
  background-color: #F4F7E2;
  font-size: 100%;
  font-weight: bold;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#coiqphlojx .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#coiqphlojx .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#coiqphlojx .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#coiqphlojx .gt_group_heading {
  padding: 8px;
  color: #333333;
  background-color: #F4F7E2;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
}

#coiqphlojx .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #F4F7E2;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#coiqphlojx .gt_from_md > :first-child {
  margin-top: 0;
}

#coiqphlojx .gt_from_md > :last-child {
  margin-bottom: 0;
}

#coiqphlojx .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#coiqphlojx .gt_stub {
  color: #333333;
  background-color: #F4F7E2;
  font-size: 100%;
  font-weight: bold;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 12px;
}

#coiqphlojx .gt_summary_row {
  color: #333333;
  background-color: #F4F7E2;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#coiqphlojx .gt_first_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
}

#coiqphlojx .gt_grand_summary_row {
  color: #333333;
  background-color: #F4F7E2;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#coiqphlojx .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#coiqphlojx .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#coiqphlojx .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#coiqphlojx .gt_footnotes {
  color: #333333;
  background-color: #F4F7E2;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#coiqphlojx .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding: 4px;
}

#coiqphlojx .gt_sourcenotes {
  color: #333333;
  background-color: #F4F7E2;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#coiqphlojx .gt_sourcenote {
  font-size: 90%;
  padding: 4px;
}

#coiqphlojx .gt_left {
  text-align: left;
}

#coiqphlojx .gt_center {
  text-align: center;
}

#coiqphlojx .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#coiqphlojx .gt_font_normal {
  font-weight: normal;
}

#coiqphlojx .gt_font_bold {
  font-weight: bold;
}

#coiqphlojx .gt_font_italic {
  font-style: italic;
}

#coiqphlojx .gt_super {
  font-size: 65%;
}

#coiqphlojx .gt_footnote_marks {
  font-style: italic;
  font-size: 65%;
}
</style>
<div id="coiqphlojx" style="overflow-x:auto;overflow-y:auto;width:auto;height:auto;"><table class="gt_table">
  <thead class="gt_header">
    <tr>
      <th colspan="3" class="gt_heading gt_title gt_font_normal" style>long_data</th>
    </tr>
    <tr>
      <th colspan="3" class="gt_heading gt_subtitle gt_font_normal gt_bottom_border" style></th>
    </tr>
  </thead>
  <thead class="gt_col_headings">
    <tr>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1">企業コード</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1">year</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">従業員数</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr>
      <td class="gt_row gt_left">B02111302</td>
      <td class="gt_row gt_left">2012</td>
      <td class="gt_row gt_right">1254</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">B02111302</td>
      <td class="gt_row gt_left">2013</td>
      <td class="gt_row gt_right">768</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">B02111302</td>
      <td class="gt_row gt_left">2014</td>
      <td class="gt_row gt_right">1242</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">B02117802</td>
      <td class="gt_row gt_left">2012</td>
      <td class="gt_row gt_right">82</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">B02117802</td>
      <td class="gt_row gt_left">2013</td>
      <td class="gt_row gt_right">376</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">B02117802</td>
      <td class="gt_row gt_left">2014</td>
      <td class="gt_row gt_right">374</td>
    </tr>
  </tbody>
  
  
</table></div>
</div><div class="column" style="width:2%;">

</div><div class="column" style="width:48%;">
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

#adcdndbrlv .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #F4F7E2;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#adcdndbrlv .gt_heading {
  background-color: #F4F7E2;
  text-align: center;
  border-bottom-color: #F4F7E2;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#adcdndbrlv .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  border-bottom-color: #F4F7E2;
  border-bottom-width: 0;
}

#adcdndbrlv .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 4px;
  border-top-color: #F4F7E2;
  border-top-width: 0;
}

#adcdndbrlv .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#adcdndbrlv .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#adcdndbrlv .gt_col_heading {
  color: #333333;
  background-color: #F4F7E2;
  font-size: 100%;
  font-weight: bold;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#adcdndbrlv .gt_column_spanner_outer {
  color: #333333;
  background-color: #F4F7E2;
  font-size: 100%;
  font-weight: bold;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#adcdndbrlv .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#adcdndbrlv .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#adcdndbrlv .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#adcdndbrlv .gt_group_heading {
  padding: 8px;
  color: #333333;
  background-color: #F4F7E2;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
}

#adcdndbrlv .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #F4F7E2;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#adcdndbrlv .gt_from_md > :first-child {
  margin-top: 0;
}

#adcdndbrlv .gt_from_md > :last-child {
  margin-bottom: 0;
}

#adcdndbrlv .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#adcdndbrlv .gt_stub {
  color: #333333;
  background-color: #F4F7E2;
  font-size: 100%;
  font-weight: bold;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 12px;
}

#adcdndbrlv .gt_summary_row {
  color: #333333;
  background-color: #F4F7E2;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#adcdndbrlv .gt_first_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
}

#adcdndbrlv .gt_grand_summary_row {
  color: #333333;
  background-color: #F4F7E2;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#adcdndbrlv .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#adcdndbrlv .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#adcdndbrlv .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#adcdndbrlv .gt_footnotes {
  color: #333333;
  background-color: #F4F7E2;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#adcdndbrlv .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding: 4px;
}

#adcdndbrlv .gt_sourcenotes {
  color: #333333;
  background-color: #F4F7E2;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#adcdndbrlv .gt_sourcenote {
  font-size: 90%;
  padding: 4px;
}

#adcdndbrlv .gt_left {
  text-align: left;
}

#adcdndbrlv .gt_center {
  text-align: center;
}

#adcdndbrlv .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#adcdndbrlv .gt_font_normal {
  font-weight: normal;
}

#adcdndbrlv .gt_font_bold {
  font-weight: bold;
}

#adcdndbrlv .gt_font_italic {
  font-style: italic;
}

#adcdndbrlv .gt_super {
  font-size: 65%;
}

#adcdndbrlv .gt_footnote_marks {
  font-style: italic;
  font-size: 65%;
}
</style>
<div id="adcdndbrlv" style="overflow-x:auto;overflow-y:auto;width:auto;height:auto;"><table class="gt_table">
  <thead class="gt_header">
    <tr>
      <th colspan="4" class="gt_heading gt_title gt_font_normal" style>wide_data</th>
    </tr>
    <tr>
      <th colspan="4" class="gt_heading gt_subtitle gt_font_normal gt_bottom_border" style></th>
    </tr>
  </thead>
  <thead class="gt_col_headings">
    <tr>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1">企業コード</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">従業員数_2012</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">従業員数_2013</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">従業員数_2014</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr>
      <td class="gt_row gt_left">B02111302</td>
      <td class="gt_row gt_right">1254</td>
      <td class="gt_row gt_right">768</td>
      <td class="gt_row gt_right">1242</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">B02117802</td>
      <td class="gt_row gt_right">82</td>
      <td class="gt_row gt_right">376</td>
      <td class="gt_row gt_right">374</td>
    </tr>
  </tbody>
  
  
</table></div>
</div>
</div>
</section>
<section id="tokutyo_widelong" class="slide level2">
<h2>タテ持ち・ヨコ持ちの特徴</h2>
<ul>
<li>タテ：1行から1つの情報を読み取ります</li>
<li>ヨコ：行と列の交差点から1つの情報を読み取ります</li>
</ul>
<div class="columns">
<div class="column" style="width:50%;">
<table>
<thead>
<tr class="header">
<th style="text-align: center;">特徴項目</th>
<th style="text-align: center;">タテ</th>
<th style="text-align: center;">ヨコ</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">人間が理解しやすい</td>
<td style="text-align: center;">×</td>
<td style="text-align: center;">○</td>
</tr>
<tr class="even">
<td style="text-align: center;">コンピュータが理解しやすい</td>
<td style="text-align: center;">○</td>
<td style="text-align: center;">×</td>
</tr>
<tr class="odd">
<td style="text-align: center;">excelなどで見慣れた形式</td>
<td style="text-align: center;">×</td>
<td style="text-align: center;">○</td>
</tr>
<tr class="even">
<td style="text-align: center;">新しいデータの追加がしやすい</td>
<td style="text-align: center;">○</td>
<td style="text-align: center;">×</td>
</tr>
<tr class="odd">
<td style="text-align: center;">可視化・機械学習に適している</td>
<td style="text-align: center;">○</td>
<td style="text-align: center;">×</td>
</tr>
</tbody>
</table>
</div><div class="column" style="width:2%;">

</div><div class="column" style="width:48%;">
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

#vkjwokdqhh .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #F4F7E2;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#vkjwokdqhh .gt_heading {
  background-color: #F4F7E2;
  text-align: center;
  border-bottom-color: #F4F7E2;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#vkjwokdqhh .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  border-bottom-color: #F4F7E2;
  border-bottom-width: 0;
}

#vkjwokdqhh .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 4px;
  border-top-color: #F4F7E2;
  border-top-width: 0;
}

#vkjwokdqhh .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#vkjwokdqhh .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#vkjwokdqhh .gt_col_heading {
  color: #333333;
  background-color: #F4F7E2;
  font-size: 100%;
  font-weight: bold;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#vkjwokdqhh .gt_column_spanner_outer {
  color: #333333;
  background-color: #F4F7E2;
  font-size: 100%;
  font-weight: bold;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#vkjwokdqhh .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#vkjwokdqhh .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#vkjwokdqhh .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#vkjwokdqhh .gt_group_heading {
  padding: 8px;
  color: #333333;
  background-color: #F4F7E2;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
}

#vkjwokdqhh .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #F4F7E2;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#vkjwokdqhh .gt_from_md > :first-child {
  margin-top: 0;
}

#vkjwokdqhh .gt_from_md > :last-child {
  margin-bottom: 0;
}

#vkjwokdqhh .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#vkjwokdqhh .gt_stub {
  color: #333333;
  background-color: #F4F7E2;
  font-size: 100%;
  font-weight: bold;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 12px;
}

#vkjwokdqhh .gt_summary_row {
  color: #333333;
  background-color: #F4F7E2;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#vkjwokdqhh .gt_first_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
}

#vkjwokdqhh .gt_grand_summary_row {
  color: #333333;
  background-color: #F4F7E2;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#vkjwokdqhh .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#vkjwokdqhh .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#vkjwokdqhh .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#vkjwokdqhh .gt_footnotes {
  color: #333333;
  background-color: #F4F7E2;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#vkjwokdqhh .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding: 4px;
}

#vkjwokdqhh .gt_sourcenotes {
  color: #333333;
  background-color: #F4F7E2;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#vkjwokdqhh .gt_sourcenote {
  font-size: 90%;
  padding: 4px;
}

#vkjwokdqhh .gt_left {
  text-align: left;
}

#vkjwokdqhh .gt_center {
  text-align: center;
}

#vkjwokdqhh .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#vkjwokdqhh .gt_font_normal {
  font-weight: normal;
}

#vkjwokdqhh .gt_font_bold {
  font-weight: bold;
}

#vkjwokdqhh .gt_font_italic {
  font-style: italic;
}

#vkjwokdqhh .gt_super {
  font-size: 65%;
}

#vkjwokdqhh .gt_footnote_marks {
  font-style: italic;
  font-size: 65%;
}
</style>
<div id="vkjwokdqhh" style="overflow-x:auto;overflow-y:auto;width:auto;height:auto;"><table class="gt_table">
  <thead class="gt_header">
    <tr>
      <th colspan="3" class="gt_heading gt_title gt_font_normal" style>long_data</th>
    </tr>
    <tr>
      <th colspan="3" class="gt_heading gt_subtitle gt_font_normal gt_bottom_border" style></th>
    </tr>
  </thead>
  <thead class="gt_col_headings">
    <tr>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1">企業コード</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1">year</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">従業員数</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr>
      <td class="gt_row gt_left">B02111302</td>
      <td class="gt_row gt_left">2012</td>
      <td class="gt_row gt_right">1254</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">B02111302</td>
      <td class="gt_row gt_left">2013</td>
      <td class="gt_row gt_right">768</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">B02111302</td>
      <td class="gt_row gt_left">2014</td>
      <td class="gt_row gt_right">1242</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">B02117802</td>
      <td class="gt_row gt_left">2012</td>
      <td class="gt_row gt_right">82</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">B02117802</td>
      <td class="gt_row gt_left">2013</td>
      <td class="gt_row gt_right">376</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">B02117802</td>
      <td class="gt_row gt_left">2014</td>
      <td class="gt_row gt_right">374</td>
    </tr>
  </tbody>
  
  
</table></div>
<p><br></p>
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

#ypntfnlehw .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #F4F7E2;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#ypntfnlehw .gt_heading {
  background-color: #F4F7E2;
  text-align: center;
  border-bottom-color: #F4F7E2;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#ypntfnlehw .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  border-bottom-color: #F4F7E2;
  border-bottom-width: 0;
}

#ypntfnlehw .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 4px;
  border-top-color: #F4F7E2;
  border-top-width: 0;
}

#ypntfnlehw .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ypntfnlehw .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#ypntfnlehw .gt_col_heading {
  color: #333333;
  background-color: #F4F7E2;
  font-size: 100%;
  font-weight: bold;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#ypntfnlehw .gt_column_spanner_outer {
  color: #333333;
  background-color: #F4F7E2;
  font-size: 100%;
  font-weight: bold;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#ypntfnlehw .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#ypntfnlehw .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#ypntfnlehw .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#ypntfnlehw .gt_group_heading {
  padding: 8px;
  color: #333333;
  background-color: #F4F7E2;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
}

#ypntfnlehw .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #F4F7E2;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#ypntfnlehw .gt_from_md > :first-child {
  margin-top: 0;
}

#ypntfnlehw .gt_from_md > :last-child {
  margin-bottom: 0;
}

#ypntfnlehw .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#ypntfnlehw .gt_stub {
  color: #333333;
  background-color: #F4F7E2;
  font-size: 100%;
  font-weight: bold;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 12px;
}

#ypntfnlehw .gt_summary_row {
  color: #333333;
  background-color: #F4F7E2;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#ypntfnlehw .gt_first_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
}

#ypntfnlehw .gt_grand_summary_row {
  color: #333333;
  background-color: #F4F7E2;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#ypntfnlehw .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#ypntfnlehw .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#ypntfnlehw .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ypntfnlehw .gt_footnotes {
  color: #333333;
  background-color: #F4F7E2;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#ypntfnlehw .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding: 4px;
}

#ypntfnlehw .gt_sourcenotes {
  color: #333333;
  background-color: #F4F7E2;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#ypntfnlehw .gt_sourcenote {
  font-size: 90%;
  padding: 4px;
}

#ypntfnlehw .gt_left {
  text-align: left;
}

#ypntfnlehw .gt_center {
  text-align: center;
}

#ypntfnlehw .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#ypntfnlehw .gt_font_normal {
  font-weight: normal;
}

#ypntfnlehw .gt_font_bold {
  font-weight: bold;
}

#ypntfnlehw .gt_font_italic {
  font-style: italic;
}

#ypntfnlehw .gt_super {
  font-size: 65%;
}

#ypntfnlehw .gt_footnote_marks {
  font-style: italic;
  font-size: 65%;
}
</style>
<div id="ypntfnlehw" style="overflow-x:auto;overflow-y:auto;width:auto;height:auto;"><table class="gt_table">
  <thead class="gt_header">
    <tr>
      <th colspan="4" class="gt_heading gt_title gt_font_normal" style>wide_data</th>
    </tr>
    <tr>
      <th colspan="4" class="gt_heading gt_subtitle gt_font_normal gt_bottom_border" style></th>
    </tr>
  </thead>
  <thead class="gt_col_headings">
    <tr>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1">企業コード</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">従業員数_2012</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">従業員数_2013</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">従業員数_2014</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr>
      <td class="gt_row gt_left">B02111302</td>
      <td class="gt_row gt_right">1254</td>
      <td class="gt_row gt_right">768</td>
      <td class="gt_row gt_right">1242</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">B02117802</td>
      <td class="gt_row gt_right">82</td>
      <td class="gt_row gt_right">376</td>
      <td class="gt_row gt_right">374</td>
    </tr>
  </tbody>
  
  
</table></div>
</div>
</div>
</section>
<section id="タテヨコ変換" class="slide level2">
<h2>タテ⇔ヨコ変換</h2>
<ul>
<li>以下2点のような理由から、データを自在にタテヨコ変換できるようになる必要があります
<ul>
<li>タテ持ちデータで可視化・機械学習をすることが多い</li>
<li>ヨコ持ちデータでのファイル出力を求められる場合がある</li>
</ul></li>
<li>タテとヨコの変換には、<strong>pivot_longer</strong>と<strong>pivot_wider</strong>という関数を使用します</li>
<li>先にタテヨコ変換のイメージをつかんでもらった後に、上記関数を用いたタテヨコ変換の実装をします</li>
</ul>
</section>
<section id="タテヨコ変換イメージ画像" class="slide level2">
<h2>タテヨコ変換イメージ画像</h2>
<p>次頁にgifのモーション画像があります。</p>
<div class="columns">
<div class="column" style="width:30%;">
<p><img src="../pictures/intermediate/long-data.png" width="70%" style="display: block; margin: auto;" /></p>
</div><div class="column" style="width:2%;">

</div><div class="column" style="width:48%;">
<p><img src="../pictures/intermediate/wide-data.png" width="100%" style="display: block; margin: auto;" /></p>
</div>
</div>
</section>
<section id="image_wide_long_2" class="slide level2">
<h2>タテヨコ変換イメージgif</h2>
<div class="columns">
<div class="column" style="width:48%;">
<p><img src="../pictures/intermediate/tidyr-spread-gather.gif" width="100%" style="display: block; margin: auto;" /></p>
</div><div class="column" style="width:2%;">

</div><div class="column" style="width:48%;">
<ul>
<li>ヨコ→タテは、選択したカラム名でkeyカラムを作り、選択したカラム名にあったデータでvalueカラムを作る操作です</li>
<li>タテ→ヨコは、選択したkeyカラムのデータをカラム化し、選択したvalueカラムのデータを行と列に対応した位置へ移動します</li>
</ul>
</div>
</div>
</section>
<section id="image_jisso" class="slide level2">
<h2>タテヨコ変換実装</h2>
<div class="columns">
<div class="column" style="width:55%;">
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>wide_data <span class="sc">%&gt;%</span> </span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(企業コード,</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>      <span class="fu">contains</span>(<span class="st">&quot;従業員数&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">cols =</span> <span class="sc">-</span><span class="st">&quot;企業コード&quot;</span>, </span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_to =</span> <span class="st">&quot;year&quot;</span>, </span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_prefix =</span> <span class="st">&quot;従業員数_&quot;</span>,</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_to =</span> <span class="st">&quot;従業員数&quot;</span>) </span></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>long_data <span class="sc">%&gt;%</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="st">&quot;企業コード&quot;</span>,</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>         <span class="st">&quot;year&quot;</span>,<span class="st">&quot;従業員数&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_from=</span><span class="st">&quot;year&quot;</span>, </span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_prefix =</span> <span class="st">&quot;従業員数_&quot;</span>,</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_from=</span><span class="st">&quot;従業員数&quot;</span>)</span></code></pre></div>
</div><div class="column" style="width:2%;">

</div><div class="column" style="width:43%;">
<p>詳細は次頁で解説します</p>
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

#jbtlsbuvbt .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #F4F7E2;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#jbtlsbuvbt .gt_heading {
  background-color: #F4F7E2;
  text-align: center;
  border-bottom-color: #F4F7E2;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#jbtlsbuvbt .gt_title {
  color: #333333;
  font-size: 12px;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  border-bottom-color: #F4F7E2;
  border-bottom-width: 0;
}

#jbtlsbuvbt .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 4px;
  border-top-color: #F4F7E2;
  border-top-width: 0;
}

#jbtlsbuvbt .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#jbtlsbuvbt .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#jbtlsbuvbt .gt_col_heading {
  color: #333333;
  background-color: #F4F7E2;
  font-size: 100%;
  font-weight: bold;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#jbtlsbuvbt .gt_column_spanner_outer {
  color: #333333;
  background-color: #F4F7E2;
  font-size: 100%;
  font-weight: bold;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#jbtlsbuvbt .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#jbtlsbuvbt .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#jbtlsbuvbt .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#jbtlsbuvbt .gt_group_heading {
  padding: 8px;
  color: #333333;
  background-color: #F4F7E2;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
}

#jbtlsbuvbt .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #F4F7E2;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#jbtlsbuvbt .gt_from_md > :first-child {
  margin-top: 0;
}

#jbtlsbuvbt .gt_from_md > :last-child {
  margin-bottom: 0;
}

#jbtlsbuvbt .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#jbtlsbuvbt .gt_stub {
  color: #333333;
  background-color: #F4F7E2;
  font-size: 100%;
  font-weight: bold;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 12px;
}

#jbtlsbuvbt .gt_summary_row {
  color: #333333;
  background-color: #F4F7E2;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#jbtlsbuvbt .gt_first_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
}

#jbtlsbuvbt .gt_grand_summary_row {
  color: #333333;
  background-color: #F4F7E2;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#jbtlsbuvbt .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#jbtlsbuvbt .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#jbtlsbuvbt .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#jbtlsbuvbt .gt_footnotes {
  color: #333333;
  background-color: #F4F7E2;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#jbtlsbuvbt .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding: 4px;
}

#jbtlsbuvbt .gt_sourcenotes {
  color: #333333;
  background-color: #F4F7E2;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#jbtlsbuvbt .gt_sourcenote {
  font-size: 90%;
  padding: 4px;
}

#jbtlsbuvbt .gt_left {
  text-align: left;
}

#jbtlsbuvbt .gt_center {
  text-align: center;
}

#jbtlsbuvbt .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#jbtlsbuvbt .gt_font_normal {
  font-weight: normal;
}

#jbtlsbuvbt .gt_font_bold {
  font-weight: bold;
}

#jbtlsbuvbt .gt_font_italic {
  font-style: italic;
}

#jbtlsbuvbt .gt_super {
  font-size: 65%;
}

#jbtlsbuvbt .gt_footnote_marks {
  font-style: italic;
  font-size: 65%;
}
</style>
<div id="jbtlsbuvbt" style="overflow-x:auto;overflow-y:auto;width:auto;height:auto;"><table class="gt_table">
  <thead class="gt_header">
    <tr>
      <th colspan="3" class="gt_heading gt_title gt_font_normal" style>long_data</th>
    </tr>
    <tr>
      <th colspan="3" class="gt_heading gt_subtitle gt_font_normal gt_bottom_border" style></th>
    </tr>
  </thead>
  <thead class="gt_col_headings">
    <tr>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1">企業コード</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1">year</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">従業員数</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr>
      <td class="gt_row gt_left">B02111302</td>
      <td class="gt_row gt_left">2012</td>
      <td class="gt_row gt_right">1254</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">B02111302</td>
      <td class="gt_row gt_left">2013</td>
      <td class="gt_row gt_right">768</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">B02111302</td>
      <td class="gt_row gt_left">2014</td>
      <td class="gt_row gt_right">1242</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">B02117802</td>
      <td class="gt_row gt_left">2012</td>
      <td class="gt_row gt_right">82</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">B02117802</td>
      <td class="gt_row gt_left">2013</td>
      <td class="gt_row gt_right">376</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">B02117802</td>
      <td class="gt_row gt_left">2014</td>
      <td class="gt_row gt_right">374</td>
    </tr>
  </tbody>
  
  
</table></div>
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

#ccmpvksfqv .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #F4F7E2;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#ccmpvksfqv .gt_heading {
  background-color: #F4F7E2;
  text-align: center;
  border-bottom-color: #F4F7E2;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#ccmpvksfqv .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  border-bottom-color: #F4F7E2;
  border-bottom-width: 0;
}

#ccmpvksfqv .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 4px;
  border-top-color: #F4F7E2;
  border-top-width: 0;
}

#ccmpvksfqv .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ccmpvksfqv .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#ccmpvksfqv .gt_col_heading {
  color: #333333;
  background-color: #F4F7E2;
  font-size: 100%;
  font-weight: bold;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#ccmpvksfqv .gt_column_spanner_outer {
  color: #333333;
  background-color: #F4F7E2;
  font-size: 100%;
  font-weight: bold;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#ccmpvksfqv .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#ccmpvksfqv .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#ccmpvksfqv .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#ccmpvksfqv .gt_group_heading {
  padding: 8px;
  color: #333333;
  background-color: #F4F7E2;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
}

#ccmpvksfqv .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #F4F7E2;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#ccmpvksfqv .gt_from_md > :first-child {
  margin-top: 0;
}

#ccmpvksfqv .gt_from_md > :last-child {
  margin-bottom: 0;
}

#ccmpvksfqv .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#ccmpvksfqv .gt_stub {
  color: #333333;
  background-color: #F4F7E2;
  font-size: 100%;
  font-weight: bold;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 12px;
}

#ccmpvksfqv .gt_summary_row {
  color: #333333;
  background-color: #F4F7E2;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#ccmpvksfqv .gt_first_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
}

#ccmpvksfqv .gt_grand_summary_row {
  color: #333333;
  background-color: #F4F7E2;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#ccmpvksfqv .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#ccmpvksfqv .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#ccmpvksfqv .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ccmpvksfqv .gt_footnotes {
  color: #333333;
  background-color: #F4F7E2;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#ccmpvksfqv .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding: 4px;
}

#ccmpvksfqv .gt_sourcenotes {
  color: #333333;
  background-color: #F4F7E2;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#ccmpvksfqv .gt_sourcenote {
  font-size: 90%;
  padding: 4px;
}

#ccmpvksfqv .gt_left {
  text-align: left;
}

#ccmpvksfqv .gt_center {
  text-align: center;
}

#ccmpvksfqv .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#ccmpvksfqv .gt_font_normal {
  font-weight: normal;
}

#ccmpvksfqv .gt_font_bold {
  font-weight: bold;
}

#ccmpvksfqv .gt_font_italic {
  font-style: italic;
}

#ccmpvksfqv .gt_super {
  font-size: 65%;
}

#ccmpvksfqv .gt_footnote_marks {
  font-style: italic;
  font-size: 65%;
}
</style>
<div id="ccmpvksfqv" style="overflow-x:auto;overflow-y:auto;width:auto;height:auto;"><table class="gt_table">
  <thead class="gt_header">
    <tr>
      <th colspan="4" class="gt_heading gt_title gt_font_normal" style>wide_data</th>
    </tr>
    <tr>
      <th colspan="4" class="gt_heading gt_subtitle gt_font_normal gt_bottom_border" style></th>
    </tr>
  </thead>
  <thead class="gt_col_headings">
    <tr>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1">企業コード</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">従業員数_2012</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">従業員数_2013</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">従業員数_2014</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr>
      <td class="gt_row gt_left">B02111302</td>
      <td class="gt_row gt_right">1254</td>
      <td class="gt_row gt_right">768</td>
      <td class="gt_row gt_right">1242</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">B02117802</td>
      <td class="gt_row gt_right">82</td>
      <td class="gt_row gt_right">376</td>
      <td class="gt_row gt_right">374</td>
    </tr>
  </tbody>
  
  
</table></div>
</div>
</div>
</section>
<section id="wide_to_long" class="slide level2">
<h2><strong>pivot_longer</strong>でヨコ → タテ変換</h2>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">引数</th>
<th style="text-align: left;">意味</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">cols</td>
<td style="text-align: left;">keyカラムに格納するカラム名を、select関数と同様にして選択</td>
</tr>
<tr class="even">
<td style="text-align: left;">names_to</td>
<td style="text-align: left;">keyカラムのカラム名を指定</td>
</tr>
<tr class="odd">
<td style="text-align: left;">names_prefix</td>
<td style="text-align: left;">colsで選択したカラム名から消去したい接頭辞を指定</td>
</tr>
<tr class="even">
<td style="text-align: left;">values_to</td>
<td style="text-align: left;">valueカラムのカラム名を指定</td>
</tr>
</tbody>
</table>
<div class="columns">
<div class="column" style="width:55%;">
<p><br></p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>wide_data <span class="sc">%&gt;%</span> </span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(企業コード,</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>      <span class="fu">contains</span>(<span class="st">&quot;従業員数&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">cols =</span> <span class="sc">-</span><span class="st">&quot;企業コード&quot;</span>, </span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_to =</span> <span class="st">&quot;year&quot;</span>, </span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_prefix =</span> <span class="st">&quot;従業員数_&quot;</span>,</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_to =</span> <span class="st">&quot;従業員数&quot;</span>) </span></code></pre></div>
</div><div class="column" style="width:2%;">

</div><div class="column" style="width:35%;">
<p><br></p>
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

#hrewwowokq .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 20px;
  font-weight: normal;
  font-style: normal;
  background-color: #F4F7E2;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#hrewwowokq .gt_heading {
  background-color: #F4F7E2;
  text-align: center;
  border-bottom-color: #F4F7E2;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#hrewwowokq .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  border-bottom-color: #F4F7E2;
  border-bottom-width: 0;
}

#hrewwowokq .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 4px;
  border-top-color: #F4F7E2;
  border-top-width: 0;
}

#hrewwowokq .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#hrewwowokq .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#hrewwowokq .gt_col_heading {
  color: #333333;
  background-color: #F4F7E2;
  font-size: 100%;
  font-weight: bold;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#hrewwowokq .gt_column_spanner_outer {
  color: #333333;
  background-color: #F4F7E2;
  font-size: 100%;
  font-weight: bold;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#hrewwowokq .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#hrewwowokq .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#hrewwowokq .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#hrewwowokq .gt_group_heading {
  padding: 8px;
  color: #333333;
  background-color: #F4F7E2;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
}

#hrewwowokq .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #F4F7E2;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#hrewwowokq .gt_from_md > :first-child {
  margin-top: 0;
}

#hrewwowokq .gt_from_md > :last-child {
  margin-bottom: 0;
}

#hrewwowokq .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#hrewwowokq .gt_stub {
  color: #333333;
  background-color: #F4F7E2;
  font-size: 100%;
  font-weight: bold;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 12px;
}

#hrewwowokq .gt_summary_row {
  color: #333333;
  background-color: #F4F7E2;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#hrewwowokq .gt_first_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
}

#hrewwowokq .gt_grand_summary_row {
  color: #333333;
  background-color: #F4F7E2;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#hrewwowokq .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#hrewwowokq .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#hrewwowokq .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#hrewwowokq .gt_footnotes {
  color: #333333;
  background-color: #F4F7E2;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#hrewwowokq .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding: 4px;
}

#hrewwowokq .gt_sourcenotes {
  color: #333333;
  background-color: #F4F7E2;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#hrewwowokq .gt_sourcenote {
  font-size: 90%;
  padding: 4px;
}

#hrewwowokq .gt_left {
  text-align: left;
}

#hrewwowokq .gt_center {
  text-align: center;
}

#hrewwowokq .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#hrewwowokq .gt_font_normal {
  font-weight: normal;
}

#hrewwowokq .gt_font_bold {
  font-weight: bold;
}

#hrewwowokq .gt_font_italic {
  font-style: italic;
}

#hrewwowokq .gt_super {
  font-size: 65%;
}

#hrewwowokq .gt_footnote_marks {
  font-style: italic;
  font-size: 65%;
}
</style>
<div id="hrewwowokq" style="overflow-x:auto;overflow-y:auto;width:auto;height:auto;"><table class="gt_table">
  <thead class="gt_header">
    <tr>
      <th colspan="3" class="gt_heading gt_title gt_font_normal" style>long_data</th>
    </tr>
    <tr>
      <th colspan="3" class="gt_heading gt_subtitle gt_font_normal gt_bottom_border" style></th>
    </tr>
  </thead>
  <thead class="gt_col_headings">
    <tr>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1">企業コード</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1">year</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">従業員数</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr>
      <td class="gt_row gt_left">B02111302</td>
      <td class="gt_row gt_left">2012</td>
      <td class="gt_row gt_right">1254</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">B02111302</td>
      <td class="gt_row gt_left">2013</td>
      <td class="gt_row gt_right">768</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">B02111302</td>
      <td class="gt_row gt_left">2014</td>
      <td class="gt_row gt_right">1242</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">B02117802</td>
      <td class="gt_row gt_left">2012</td>
      <td class="gt_row gt_right">82</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">B02117802</td>
      <td class="gt_row gt_left">2013</td>
      <td class="gt_row gt_right">376</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">B02117802</td>
      <td class="gt_row gt_left">2014</td>
      <td class="gt_row gt_right">374</td>
    </tr>
  </tbody>
  
  
</table></div>
</div>
</div>
</section>
<section id="long_to_wide" class="slide level2">
<h2><strong>pivot_wider</strong>でタテ → ヨコ変換</h2>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">引数</th>
<th style="text-align: left;">意味</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">names_from</td>
<td style="text-align: left;">カラム化したいデータが入っているカラム名(keyカラム)を指定</td>
</tr>
<tr class="even">
<td style="text-align: left;">names_prefix</td>
<td style="text-align: left;">付与する接頭辞を指定</td>
</tr>
<tr class="odd">
<td style="text-align: left;">values_from</td>
<td style="text-align: left;">行と列で対応させたいデータのカラム名を指定</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>long_data <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="st">&quot;企業コード&quot;</span>, <span class="st">&quot;year&quot;</span>, <span class="st">&quot;従業員数&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from=</span><span class="st">&quot;year&quot;</span>, </span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>              <span class="at">names_prefix =</span> <span class="st">&quot;従業員数_&quot;</span>,</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>              <span class="at">values_from=</span><span class="st">&quot;従業員数&quot;</span>)</span></code></pre></div>
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

#nzyruwqtea .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 20px;
  font-weight: normal;
  font-style: normal;
  background-color: #F4F7E2;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#nzyruwqtea .gt_heading {
  background-color: #F4F7E2;
  text-align: center;
  border-bottom-color: #F4F7E2;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#nzyruwqtea .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  border-bottom-color: #F4F7E2;
  border-bottom-width: 0;
}

#nzyruwqtea .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 4px;
  border-top-color: #F4F7E2;
  border-top-width: 0;
}

#nzyruwqtea .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#nzyruwqtea .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#nzyruwqtea .gt_col_heading {
  color: #333333;
  background-color: #F4F7E2;
  font-size: 100%;
  font-weight: bold;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#nzyruwqtea .gt_column_spanner_outer {
  color: #333333;
  background-color: #F4F7E2;
  font-size: 100%;
  font-weight: bold;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#nzyruwqtea .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#nzyruwqtea .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#nzyruwqtea .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#nzyruwqtea .gt_group_heading {
  padding: 8px;
  color: #333333;
  background-color: #F4F7E2;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
}

#nzyruwqtea .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #F4F7E2;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#nzyruwqtea .gt_from_md > :first-child {
  margin-top: 0;
}

#nzyruwqtea .gt_from_md > :last-child {
  margin-bottom: 0;
}

#nzyruwqtea .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#nzyruwqtea .gt_stub {
  color: #333333;
  background-color: #F4F7E2;
  font-size: 100%;
  font-weight: bold;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 12px;
}

#nzyruwqtea .gt_summary_row {
  color: #333333;
  background-color: #F4F7E2;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#nzyruwqtea .gt_first_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
}

#nzyruwqtea .gt_grand_summary_row {
  color: #333333;
  background-color: #F4F7E2;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#nzyruwqtea .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#nzyruwqtea .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#nzyruwqtea .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#nzyruwqtea .gt_footnotes {
  color: #333333;
  background-color: #F4F7E2;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#nzyruwqtea .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding: 4px;
}

#nzyruwqtea .gt_sourcenotes {
  color: #333333;
  background-color: #F4F7E2;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#nzyruwqtea .gt_sourcenote {
  font-size: 90%;
  padding: 4px;
}

#nzyruwqtea .gt_left {
  text-align: left;
}

#nzyruwqtea .gt_center {
  text-align: center;
}

#nzyruwqtea .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#nzyruwqtea .gt_font_normal {
  font-weight: normal;
}

#nzyruwqtea .gt_font_bold {
  font-weight: bold;
}

#nzyruwqtea .gt_font_italic {
  font-style: italic;
}

#nzyruwqtea .gt_super {
  font-size: 65%;
}

#nzyruwqtea .gt_footnote_marks {
  font-style: italic;
  font-size: 65%;
}
</style>
<div id="nzyruwqtea" style="overflow-x:auto;overflow-y:auto;width:auto;height:auto;"><table class="gt_table">
  <thead class="gt_header">
    <tr>
      <th colspan="4" class="gt_heading gt_title gt_font_normal" style>wide_data</th>
    </tr>
    <tr>
      <th colspan="4" class="gt_heading gt_subtitle gt_font_normal gt_bottom_border" style></th>
    </tr>
  </thead>
  <thead class="gt_col_headings">
    <tr>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1">企業コード</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">従業員数_2012</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">従業員数_2013</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">従業員数_2014</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr>
      <td class="gt_row gt_left">B02111302</td>
      <td class="gt_row gt_right">1254</td>
      <td class="gt_row gt_right">768</td>
      <td class="gt_row gt_right">1242</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">B02117802</td>
      <td class="gt_row gt_right">82</td>
      <td class="gt_row gt_right">376</td>
      <td class="gt_row gt_right">374</td>
    </tr>
  </tbody>
  
  
</table></div>
</section></section>
<section>
<section id="研磨データの比較検証" class="title-slide slide level1">
<h1>研磨データの比較検証</h1>
<ul>
<li>データの比較検証方法を習得します</li>
</ul>
</section>
<section id="比較検証をする理由" class="slide level2">
<h2>比較検証をする理由</h2>
<ul>
<li>世の中に「研磨データの正解データ」はありません</li>
<li>そのため研磨データの正確性を担保するために、2人以上で研磨データを作成して比較検証をおこなう（ダブルチェック）ことがあります</li>
</ul>
</section>
<section id="比較検証をする方法" class="slide level2">
<h2>比較検証をする方法</h2>
<ul>
<li>比較検証の練習として、long_dataと、wide_dataをタテ持ち変換したデータの比較検証を行います</li>
<li>前節のとおり、タテ持ちとヨコ持ちの違いは<strong>データを保持する形式の違い</strong>だけなので、データ保持形式を揃えたらデータが一致するはずだからです</li>
<li>なおデータ比較の際には、以下の項目を事前にそろえておく必要があります
<ul>
<li>カラムの名前・順番・型、レコードの順番</li>
</ul></li>
<li>ここでは<strong>diffdf</strong>パッケージを用いてデータの比較検証をおこなうので、diffdfのインストールと読み込みをします</li>
</ul>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages(&quot;diffdf&quot;) # diffdfのインストール</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(diffdf) <span class="co"># diffdfの読み込み</span></span></code></pre></div>
</section>
<section id="検証データの作成long_data" class="slide level2">
<h2>検証データの作成：long_data</h2>
<ul>
<li>まずはlong_dataから検証データを作成します</li>
<li>練習なので、従業員数カラムに注目して検証します</li>
<li>long_dataからlong_emp_lを、以下の仕様で作成します
<ul>
<li>企業コード, year, 従業員数の3つのカラムを選択</li>
<li>企業コードとyearでソート</li>
</ul></li>
</ul>
<div class="columns">
<div class="column" style="width:46%;">
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>long_emp_l <span class="ot">&lt;-</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>  long_data <span class="sc">%&gt;%</span> </span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(企業コード, </span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>         year,</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>         従業員数) <span class="sc">%&gt;%</span> </span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(企業コード, year)</span></code></pre></div>
</div><div class="column" style="width:1%;">

</div><div class="column" style="width:53%;">
<p>long_emp_l</p>
<pre><code># A tibble: 14,972 x 3
   企業コード year  従業員数
   &lt;chr&gt;      &lt;chr&gt;    &lt;dbl&gt;
 1 B02111302  2012      1254
 2 B02111302  2013       768
 3 B02111302  2014      1242
 4 B02111302  2015      1409
 5 B02111302  2016       728
 6 B02111302  2017      1401
 7 B02111302  2018      1096
 8 B02117802  2012        82
 9 B02117802  2013       376
10 B02117802  2014       374
# ... with 14,962 more rows</code></pre>
</div>
</div>
</section>
<section id="wide_data2" class="slide level2">
<h2>検証データの作成：wide_data</h2>
<ul>
<li>次にwide_dataをタテ変換してlong_emp_wを作成します</li>
<li>こちらもlong_emp_lと同様の仕様で作成します</li>
</ul>
<div class="columns">
<div class="column" style="width:48;">
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>long_emp_w <span class="ot">&lt;-</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>  wide_data <span class="sc">%&gt;%</span> </span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(企業コード,</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>      <span class="fu">contains</span>(<span class="st">&quot;従業員数&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">cols =</span> <span class="sc">-</span>企業コード,</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_to =</span> <span class="st">&quot;year&quot;</span>, </span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_to =</span> <span class="st">&quot;従業員数&quot;</span>,</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_prefix=</span><span class="st">&quot;従業員数_&quot;</span>)<span class="sc">%&gt;%</span></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(企業コード, year)</span></code></pre></div>
</div><div class="column" style="width:1%;">

</div><div class="column" style="width:50%;">
<p>long_emp_w</p>
<pre><code># A tibble: 15,232 x 3
   企業コード year  従業員数
   &lt;chr&gt;      &lt;chr&gt;    &lt;dbl&gt;
 1 B02111302  2012      1254
 2 B02111302  2013       768
 3 B02111302  2014      1242
 4 B02111302  2015      1409
 5 B02111302  2016       728
 6 B02111302  2017      1401
 7 B02111302  2018      1096
 8 B02117802  2012        82
 9 B02117802  2013       376
10 B02117802  2014       374
# ... with 15,222 more rows</code></pre>
</div>
</div>
</section>
<section id="diffdfで一致確認" class="slide level2">
<h2>diffdfで一致確認</h2>
<ul>
<li>long_dataと、wide_dataをタテ持ちデータにしたものを比較検証すると、一致しなかったデータに関するメッセージがたくさん出てきました</li>
<li>なぜ一致しないのか確認していきましょう</li>
</ul>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(diffdf)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="fu">diffdf</span>(long_emp_l, long_emp_w)</span></code></pre></div>
<pre><code>Differences found between the objects!

A summary is given below.

There are rows in COMPARE that are not in BASE !!
First 10 of 260 rows are shown in table below

  ===============
   ..ROWNUMBER.. 
  ---------------
       14973     
       14974     
       14975     
       14976     
       14977     
       14978     
       14979     
       14980     
       14981     
       14982     
  ---------------

Not all Values Compared Equal
All rows are shown in table below

  =============================
   Variable  No of Differences 
  -----------------------------
    企業コード          14335       
     year          12912       
     従業員数          14911       
  -----------------------------


First 10 of 14335 rows are shown in table below

  ===============================================
   VARIABLE  ..ROWNUMBER..    BASE      COMPARE  
  -----------------------------------------------
    企業コード         15        B02119859  B02122250 
    企業コード         22        B02122250  B02122602 
    企業コード         29        B02122602  B02124175 
    企業コード         34        B02125529  B02124175 
    企業コード         35        B02125529  B02124175 
    企業コード         41        B02128716  B02125529 
    企業コード         42        B02128716  B02125529 
    企業コード         48        B02129789  B02128716 
    企業コード         49        B02129789  B02128716 
    企業コード         55        B02153443  B02129789 
  -----------------------------------------------


First 10 of 12912 rows are shown in table below

  ========================================
   VARIABLE  ..ROWNUMBER..  BASE  COMPARE 
  ----------------------------------------
     year         15        2018   2012   
     year         16        2012   2013   
     year         17        2013   2014   
     year         18        2014   2015   
     year         19        2015   2016   
     year         20        2016   2017   
     year         21        2017   2018   
     year         22        2018   2012   
     year         23        2012   2013   
     year         24        2013   2014   
  ----------------------------------------


First 10 of 14911 rows are shown in table below

  =========================================
   VARIABLE  ..ROWNUMBER..  BASE   COMPARE 
  -----------------------------------------
     従業員数         15          205     790  
     従業員数         16          790     690  
     従業員数         17          690    1074  
     従業員数         18         1074    1123  
     従業員数         19         1123     297  
     従業員数         20          297     523  
     従業員数         21          523     695  
     従業員数         22          695   23216  
     従業員数         23        23216    4217  
     従業員数         24         4217    6092  
  -----------------------------------------</code></pre>
</section>
<section id="不一致の原因" class="slide level2">
<h2>不一致の原因</h2>
<ul>
<li>レコード数が異なることやレコードがズレていることから、タテとヨコのデータの結合方法の違いが不一致の原因と考えられます</li>
<li>たとえば企業コードが“B02119859”のデータは、long_dataにはありますがwide_dataにはありません</li>
</ul>
<div class="columns">
<div class="column" style="width:48%;">
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>long_data <span class="sc">%&gt;%</span> </span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>    企業コード<span class="sc">==</span><span class="st">&quot;B02119859&quot;</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span> </span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">nrow</span>()</span></code></pre></div>
<pre><code>[1] 1</code></pre>
</div><div class="column" style="width:2%;">

</div><div class="column" style="width:48%;">
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>wide_data <span class="sc">%&gt;%</span> </span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>    企業コード<span class="sc">==</span><span class="st">&quot;B02119859&quot;</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span> </span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">nrow</span>()</span></code></pre></div>
<pre><code>[1] 0</code></pre>
</div>
</div>
</section>
<section id="不一致の理由" class="slide level2">
<h2>不一致の理由</h2>
<ul>
<li>long_dataは全データをタテ結合したので、「2012年の企業コード以外」の「企業コード」も存在します</li>
<li>wide_dataは2012年の企業コードをキーにしてleft_joinでヨコ結合したので、「2012年のデータにある企業コード」のみが存在します</li>
</ul>
<p>データを一致させるために、「2012年から2018年までの7年ぶんのレコードがすべて存在するデータ」という条件で絞って再度検証してみましょう</p>
</section>
<section id="条件を揃える準備" class="slide level2">
<h2>条件を揃える準備</h2>
<ul>
<li>7年ぶんのレコードが揃っている企業コードを抽出します</li>
</ul>
<div class="columns">
<div class="column" style="width:44%;">
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>code_7year <span class="ot">&lt;-</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>  long_emp_l <span class="sc">%&gt;%</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(企業コード) <span class="sc">%&gt;%</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>() <span class="sc">%&gt;%</span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(n <span class="sc">==</span> <span class="dv">7</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() </span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a><span class="co"># グループ解除(参考参照)</span></span></code></pre></div>
</div><div class="column" style="width:2%;">

</div><div class="column" style="width:54%;">
<pre><code># A tibble: 1,788 x 2
   企業コード     n
   &lt;chr&gt;      &lt;int&gt;
 1 B02111302      7
 2 B02117802      7
 3 B02122250      7
 4 B02122602      7
 5 B02125529      7
 6 B02128716      7
 7 B02129789      7
 8 B02153443      7
 9 B02505784      7
10 B02514384      7
# ... with 1,778 more rows</code></pre>
</div>
</div>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># nは不要なので消しておきます</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>code_7year <span class="ot">&lt;-</span> code_7year <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="sc">-</span>n)</span></code></pre></div>
</section>
<section id="再度検証" class="slide level2">
<h2>再度検証</h2>
<ul>
<li>7年ぶん揃っている企業コードのcode_7yearに対して、“企業コード”をキーにlong_emp_lとlong_emp_wをそれぞれleft_joinすることで、条件を満たすデータを抽出します</li>
<li>条件を合わせたデータで再度検証したところ、データが一致したことが確認できました</li>
</ul>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>long_emp_l <span class="ot">&lt;-</span> code_7year <span class="sc">%&gt;%</span> <span class="fu">left_join</span>(long_emp_l, <span class="at">by =</span> <span class="st">&quot;企業コード&quot;</span>)</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>long_emp_w <span class="ot">&lt;-</span> code_7year <span class="sc">%&gt;%</span> <span class="fu">left_join</span>(long_emp_w, <span class="at">by =</span> <span class="st">&quot;企業コード&quot;</span>)</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a><span class="fu">diffdf</span>(long_emp_l, long_emp_w)</span></code></pre></div>
<pre><code>No issues were found!</code></pre>
</section>
<section id="hikaku_sanko" class="slide level2">
<h2>参考：グループ解除</h2>
<ul>
<li>group_byを使ってグループ化されたデータは、ungroupするまでグループ化が継続されます</li>
</ul>
<div class="columns">
<div class="column" style="width:48%;">
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>code_7year_g <span class="ot">&lt;-</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>  long_emp_l <span class="sc">%&gt;%</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(企業コード) <span class="sc">%&gt;%</span></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>() <span class="sc">%&gt;%</span></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(n <span class="sc">==</span> <span class="dv">7</span>) </span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>code_7year_g</span></code></pre></div>
<pre><code># A tibble: 1,788 x 2
# Groups:   企業コード [1,788]
   企業コード     n
   &lt;chr&gt;      &lt;int&gt;
 1 B02111302      7
 2 B02117802      7
 3 B02122250      7
 4 B02122602      7
 5 B02125529      7
 6 B02128716      7
 7 B02129789      7
 8 B02153443      7
 9 B02505784      7
10 B02514384      7
# ... with 1,778 more rows</code></pre>
</div><div class="column" style="width:2%;">

</div><div class="column" style="width:48%;">
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>code_7year_ug <span class="ot">&lt;-</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>  long_emp_l <span class="sc">%&gt;%</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(企業コード) <span class="sc">%&gt;%</span></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>() <span class="sc">%&gt;%</span></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(n <span class="sc">==</span> <span class="dv">7</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>code_7year_ug</span></code></pre></div>
<pre><code># A tibble: 1,788 x 2
   企業コード     n
   &lt;chr&gt;      &lt;int&gt;
 1 B02111302      7
 2 B02117802      7
 3 B02122250      7
 4 B02122602      7
 5 B02125529      7
 6 B02128716      7
 7 B02129789      7
 8 B02153443      7
 9 B02505784      7
10 B02514384      7
# ... with 1,778 more rows</code></pre>
</div>
</div>
</section>
<section class="slide level2">

<ul>
<li>group化されたデータに対してjoinをしても、group化は勝手に解除されることはないので注意しましょう</li>
<li>group化が残っていると、意図せぬに挙動になることがままあります</li>
</ul>
<div class="columns">
<div class="column" style="width:48%;">
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>code_7year_g <span class="sc">%&gt;%</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(long_emp_l,</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>            <span class="at">by=</span><span class="st">&quot;企業コード&quot;</span>)</span></code></pre></div>
<pre><code># A tibble: 12,516 x 4
# Groups:   企業コード [1,788]
   企業コード     n year  従業員数
   &lt;chr&gt;      &lt;int&gt; &lt;chr&gt;    &lt;dbl&gt;
 1 B02111302      7 2012      1254
 2 B02111302      7 2013       768
 3 B02111302      7 2014      1242
 4 B02111302      7 2015      1409
 5 B02111302      7 2016       728
 6 B02111302      7 2017      1401
 7 B02111302      7 2018      1096
 8 B02117802      7 2012        82
 9 B02117802      7 2013       376
10 B02117802      7 2014       374
# ... with 12,506 more rows</code></pre>
</div><div class="column" style="width:2%;">

</div><div class="column" style="width:48%;">
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>code_7year_ug <span class="sc">%&gt;%</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(long_emp_l,</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>            <span class="at">by=</span><span class="st">&quot;企業コード&quot;</span>)</span></code></pre></div>
<pre><code># A tibble: 12,516 x 4
   企業コード     n year  従業員数
   &lt;chr&gt;      &lt;int&gt; &lt;chr&gt;    &lt;dbl&gt;
 1 B02111302      7 2012      1254
 2 B02111302      7 2013       768
 3 B02111302      7 2014      1242
 4 B02111302      7 2015      1409
 5 B02111302      7 2016       728
 6 B02111302      7 2017      1401
 7 B02111302      7 2018      1096
 8 B02117802      7 2012        82
 9 B02117802      7 2013       376
10 B02117802      7 2014       374
# ... with 12,506 more rows</code></pre>
</div>
</div>
</section></section>
<section>
<section id="前年度比の算出" class="title-slide slide level1">
<h1>前年度比の算出</h1>
<ul>
<li>整った複数年の結合データで指標を算出します</li>
</ul>
</section>
<section id="hi_result" class="slide level2">
<h2>結果の確認</h2>
<div class="columns">
<div class="column" style="width:48%;">
<ul>
<li>右のように、long_empに従業員数伸び率カラムを作成します</li>
<li>従業員数伸び率カラムは、企業コードごとに<span class="math inline">\(\frac{\mbox{n年の従業員数}}{\mbox{n-1年の従業員数}}\)</span>で算出します</li>
</ul>
</div><div class="column" style="width:2%;">

</div><div class="column" style="width:48%;">
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

#erxdducnyz .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 22px;
  font-weight: normal;
  font-style: normal;
  background-color: #F4F7E2;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#erxdducnyz .gt_heading {
  background-color: #F4F7E2;
  text-align: center;
  border-bottom-color: #F4F7E2;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#erxdducnyz .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  border-bottom-color: #F4F7E2;
  border-bottom-width: 0;
}

#erxdducnyz .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 4px;
  border-top-color: #F4F7E2;
  border-top-width: 0;
}

#erxdducnyz .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#erxdducnyz .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#erxdducnyz .gt_col_heading {
  color: #333333;
  background-color: #F4F7E2;
  font-size: 26px;
  font-weight: bold;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#erxdducnyz .gt_column_spanner_outer {
  color: #333333;
  background-color: #F4F7E2;
  font-size: 26px;
  font-weight: bold;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#erxdducnyz .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#erxdducnyz .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#erxdducnyz .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#erxdducnyz .gt_group_heading {
  padding: 8px;
  color: #333333;
  background-color: #F4F7E2;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
}

#erxdducnyz .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #F4F7E2;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#erxdducnyz .gt_from_md > :first-child {
  margin-top: 0;
}

#erxdducnyz .gt_from_md > :last-child {
  margin-bottom: 0;
}

#erxdducnyz .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#erxdducnyz .gt_stub {
  color: #333333;
  background-color: #F4F7E2;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 12px;
}

#erxdducnyz .gt_summary_row {
  color: #333333;
  background-color: #F4F7E2;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#erxdducnyz .gt_first_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
}

#erxdducnyz .gt_grand_summary_row {
  color: #333333;
  background-color: #F4F7E2;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#erxdducnyz .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#erxdducnyz .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#erxdducnyz .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#erxdducnyz .gt_footnotes {
  color: #333333;
  background-color: #F4F7E2;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#erxdducnyz .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding: 4px;
}

#erxdducnyz .gt_sourcenotes {
  color: #333333;
  background-color: #F4F7E2;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#erxdducnyz .gt_sourcenote {
  font-size: 90%;
  padding: 4px;
}

#erxdducnyz .gt_left {
  text-align: left;
}

#erxdducnyz .gt_center {
  text-align: center;
}

#erxdducnyz .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#erxdducnyz .gt_font_normal {
  font-weight: normal;
}

#erxdducnyz .gt_font_bold {
  font-weight: bold;
}

#erxdducnyz .gt_font_italic {
  font-style: italic;
}

#erxdducnyz .gt_super {
  font-size: 65%;
}

#erxdducnyz .gt_footnote_marks {
  font-style: italic;
  font-size: 65%;
}
</style>
<div id="erxdducnyz" style="overflow-x:auto;overflow-y:auto;width:auto;height:500px;"><table class="gt_table">
  <thead class="gt_header">
    <tr>
      <th colspan="4" class="gt_heading gt_title gt_font_normal" style>long_emp</th>
    </tr>
    <tr>
      <th colspan="4" class="gt_heading gt_subtitle gt_font_normal gt_bottom_border" style></th>
    </tr>
  </thead>
  <thead class="gt_col_headings">
    <tr>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1">企業コード</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1">year</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">従業員数</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">従業員数伸び率</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr>
      <td class="gt_row gt_left">B02111302</td>
      <td class="gt_row gt_left">2012</td>
      <td class="gt_row gt_right">1254</td>
      <td class="gt_row gt_right">NA</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">B02111302</td>
      <td class="gt_row gt_left">2013</td>
      <td class="gt_row gt_right">768</td>
      <td class="gt_row gt_right">0.612</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">B02111302</td>
      <td class="gt_row gt_left">2014</td>
      <td class="gt_row gt_right">1242</td>
      <td class="gt_row gt_right">1.617</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">B02111302</td>
      <td class="gt_row gt_left">2015</td>
      <td class="gt_row gt_right">1409</td>
      <td class="gt_row gt_right">1.134</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">B02111302</td>
      <td class="gt_row gt_left">2016</td>
      <td class="gt_row gt_right">728</td>
      <td class="gt_row gt_right">0.517</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">B02111302</td>
      <td class="gt_row gt_left">2017</td>
      <td class="gt_row gt_right">1401</td>
      <td class="gt_row gt_right">1.924</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">B02111302</td>
      <td class="gt_row gt_left">2018</td>
      <td class="gt_row gt_right">1096</td>
      <td class="gt_row gt_right">0.782</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">B02117802</td>
      <td class="gt_row gt_left">2012</td>
      <td class="gt_row gt_right">82</td>
      <td class="gt_row gt_right">NA</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">B02117802</td>
      <td class="gt_row gt_left">2013</td>
      <td class="gt_row gt_right">376</td>
      <td class="gt_row gt_right">4.585</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">B02117802</td>
      <td class="gt_row gt_left">2014</td>
      <td class="gt_row gt_right">374</td>
      <td class="gt_row gt_right">0.995</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">B02117802</td>
      <td class="gt_row gt_left">2015</td>
      <td class="gt_row gt_right">294</td>
      <td class="gt_row gt_right">0.786</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">B02117802</td>
      <td class="gt_row gt_left">2016</td>
      <td class="gt_row gt_right">422</td>
      <td class="gt_row gt_right">1.435</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">B02117802</td>
      <td class="gt_row gt_left">2017</td>
      <td class="gt_row gt_right">233</td>
      <td class="gt_row gt_right">0.552</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">B02117802</td>
      <td class="gt_row gt_left">2018</td>
      <td class="gt_row gt_right">173</td>
      <td class="gt_row gt_right">0.742</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">B02122250</td>
      <td class="gt_row gt_left">2012</td>
      <td class="gt_row gt_right">790</td>
      <td class="gt_row gt_right">NA</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">B02122250</td>
      <td class="gt_row gt_left">2013</td>
      <td class="gt_row gt_right">690</td>
      <td class="gt_row gt_right">0.873</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">B02122250</td>
      <td class="gt_row gt_left">2014</td>
      <td class="gt_row gt_right">1074</td>
      <td class="gt_row gt_right">1.557</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">B02122250</td>
      <td class="gt_row gt_left">2015</td>
      <td class="gt_row gt_right">1123</td>
      <td class="gt_row gt_right">1.046</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">B02122250</td>
      <td class="gt_row gt_left">2016</td>
      <td class="gt_row gt_right">297</td>
      <td class="gt_row gt_right">0.264</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">B02122250</td>
      <td class="gt_row gt_left">2017</td>
      <td class="gt_row gt_right">523</td>
      <td class="gt_row gt_right">1.761</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">B02122250</td>
      <td class="gt_row gt_left">2018</td>
      <td class="gt_row gt_right">695</td>
      <td class="gt_row gt_right">1.329</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">B02122602</td>
      <td class="gt_row gt_left">2012</td>
      <td class="gt_row gt_right">23216</td>
      <td class="gt_row gt_right">NA</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">B02122602</td>
      <td class="gt_row gt_left">2013</td>
      <td class="gt_row gt_right">4217</td>
      <td class="gt_row gt_right">0.182</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">B02122602</td>
      <td class="gt_row gt_left">2014</td>
      <td class="gt_row gt_right">6092</td>
      <td class="gt_row gt_right">1.445</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">B02122602</td>
      <td class="gt_row gt_left">2015</td>
      <td class="gt_row gt_right">710</td>
      <td class="gt_row gt_right">0.117</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">B02122602</td>
      <td class="gt_row gt_left">2016</td>
      <td class="gt_row gt_right">17013</td>
      <td class="gt_row gt_right">23.962</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">B02122602</td>
      <td class="gt_row gt_left">2017</td>
      <td class="gt_row gt_right">7564</td>
      <td class="gt_row gt_right">0.445</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">B02122602</td>
      <td class="gt_row gt_left">2018</td>
      <td class="gt_row gt_right">12493</td>
      <td class="gt_row gt_right">1.652</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">B02125529</td>
      <td class="gt_row gt_left">2012</td>
      <td class="gt_row gt_right">2977</td>
      <td class="gt_row gt_right">NA</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">B02125529</td>
      <td class="gt_row gt_left">2013</td>
      <td class="gt_row gt_right">2762</td>
      <td class="gt_row gt_right">0.928</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">B02125529</td>
      <td class="gt_row gt_left">2014</td>
      <td class="gt_row gt_right">1369</td>
      <td class="gt_row gt_right">0.496</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">B02125529</td>
      <td class="gt_row gt_left">2015</td>
      <td class="gt_row gt_right">1466</td>
      <td class="gt_row gt_right">1.071</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">B02125529</td>
      <td class="gt_row gt_left">2016</td>
      <td class="gt_row gt_right">2211</td>
      <td class="gt_row gt_right">1.508</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">B02125529</td>
      <td class="gt_row gt_left">2017</td>
      <td class="gt_row gt_right">2274</td>
      <td class="gt_row gt_right">1.028</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">B02125529</td>
      <td class="gt_row gt_left">2018</td>
      <td class="gt_row gt_right">2472</td>
      <td class="gt_row gt_right">1.087</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">B02128716</td>
      <td class="gt_row gt_left">2012</td>
      <td class="gt_row gt_right">299</td>
      <td class="gt_row gt_right">NA</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">B02128716</td>
      <td class="gt_row gt_left">2013</td>
      <td class="gt_row gt_right">280</td>
      <td class="gt_row gt_right">0.936</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">B02128716</td>
      <td class="gt_row gt_left">2014</td>
      <td class="gt_row gt_right">42</td>
      <td class="gt_row gt_right">0.150</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">B02128716</td>
      <td class="gt_row gt_left">2015</td>
      <td class="gt_row gt_right">401</td>
      <td class="gt_row gt_right">9.548</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">B02128716</td>
      <td class="gt_row gt_left">2016</td>
      <td class="gt_row gt_right">327</td>
      <td class="gt_row gt_right">0.815</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">B02128716</td>
      <td class="gt_row gt_left">2017</td>
      <td class="gt_row gt_right">261</td>
      <td class="gt_row gt_right">0.798</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">B02128716</td>
      <td class="gt_row gt_left">2018</td>
      <td class="gt_row gt_right">376</td>
      <td class="gt_row gt_right">1.441</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">B02129789</td>
      <td class="gt_row gt_left">2012</td>
      <td class="gt_row gt_right">683</td>
      <td class="gt_row gt_right">NA</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">B02129789</td>
      <td class="gt_row gt_left">2013</td>
      <td class="gt_row gt_right">1022</td>
      <td class="gt_row gt_right">1.496</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">B02129789</td>
      <td class="gt_row gt_left">2014</td>
      <td class="gt_row gt_right">893</td>
      <td class="gt_row gt_right">0.874</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">B02129789</td>
      <td class="gt_row gt_left">2015</td>
      <td class="gt_row gt_right">789</td>
      <td class="gt_row gt_right">0.884</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">B02129789</td>
      <td class="gt_row gt_left">2016</td>
      <td class="gt_row gt_right">1091</td>
      <td class="gt_row gt_right">1.383</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">B02129789</td>
      <td class="gt_row gt_left">2017</td>
      <td class="gt_row gt_right">645</td>
      <td class="gt_row gt_right">0.591</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">B02129789</td>
      <td class="gt_row gt_left">2018</td>
      <td class="gt_row gt_right">986</td>
      <td class="gt_row gt_right">1.529</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">B02153443</td>
      <td class="gt_row gt_left">2012</td>
      <td class="gt_row gt_right">1787</td>
      <td class="gt_row gt_right">NA</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">B02153443</td>
      <td class="gt_row gt_left">2013</td>
      <td class="gt_row gt_right">3066</td>
      <td class="gt_row gt_right">1.716</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">B02153443</td>
      <td class="gt_row gt_left">2014</td>
      <td class="gt_row gt_right">4522</td>
      <td class="gt_row gt_right">1.475</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">B02153443</td>
      <td class="gt_row gt_left">2015</td>
      <td class="gt_row gt_right">6582</td>
      <td class="gt_row gt_right">1.456</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">B02153443</td>
      <td class="gt_row gt_left">2016</td>
      <td class="gt_row gt_right">3606</td>
      <td class="gt_row gt_right">0.548</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">B02153443</td>
      <td class="gt_row gt_left">2017</td>
      <td class="gt_row gt_right">3960</td>
      <td class="gt_row gt_right">1.098</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">B02153443</td>
      <td class="gt_row gt_left">2018</td>
      <td class="gt_row gt_right">5563</td>
      <td class="gt_row gt_right">1.405</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">B02505784</td>
      <td class="gt_row gt_left">2012</td>
      <td class="gt_row gt_right">340</td>
      <td class="gt_row gt_right">NA</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">B02505784</td>
      <td class="gt_row gt_left">2013</td>
      <td class="gt_row gt_right">636</td>
      <td class="gt_row gt_right">1.871</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">B02505784</td>
      <td class="gt_row gt_left">2014</td>
      <td class="gt_row gt_right">990</td>
      <td class="gt_row gt_right">1.557</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">B02505784</td>
      <td class="gt_row gt_left">2015</td>
      <td class="gt_row gt_right">681</td>
      <td class="gt_row gt_right">0.688</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">B02505784</td>
      <td class="gt_row gt_left">2016</td>
      <td class="gt_row gt_right">498</td>
      <td class="gt_row gt_right">0.731</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">B02505784</td>
      <td class="gt_row gt_left">2017</td>
      <td class="gt_row gt_right">902</td>
      <td class="gt_row gt_right">1.811</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">B02505784</td>
      <td class="gt_row gt_left">2018</td>
      <td class="gt_row gt_right">728</td>
      <td class="gt_row gt_right">0.807</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">B02514384</td>
      <td class="gt_row gt_left">2012</td>
      <td class="gt_row gt_right">18</td>
      <td class="gt_row gt_right">NA</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">B02514384</td>
      <td class="gt_row gt_left">2013</td>
      <td class="gt_row gt_right">160</td>
      <td class="gt_row gt_right">8.889</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">B02514384</td>
      <td class="gt_row gt_left">2014</td>
      <td class="gt_row gt_right">81</td>
      <td class="gt_row gt_right">0.506</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">B02514384</td>
      <td class="gt_row gt_left">2015</td>
      <td class="gt_row gt_right">316</td>
      <td class="gt_row gt_right">3.901</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">B02514384</td>
      <td class="gt_row gt_left">2016</td>
      <td class="gt_row gt_right">238</td>
      <td class="gt_row gt_right">0.753</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">B02514384</td>
      <td class="gt_row gt_left">2017</td>
      <td class="gt_row gt_right">154</td>
      <td class="gt_row gt_right">0.647</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">B02514384</td>
      <td class="gt_row gt_left">2018</td>
      <td class="gt_row gt_right">324</td>
      <td class="gt_row gt_right">2.104</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">B12083033</td>
      <td class="gt_row gt_left">2012</td>
      <td class="gt_row gt_right">4241</td>
      <td class="gt_row gt_right">NA</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">B12083033</td>
      <td class="gt_row gt_left">2013</td>
      <td class="gt_row gt_right">2705</td>
      <td class="gt_row gt_right">0.638</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">B12083033</td>
      <td class="gt_row gt_left">2014</td>
      <td class="gt_row gt_right">2048</td>
      <td class="gt_row gt_right">0.757</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">B12083033</td>
      <td class="gt_row gt_left">2015</td>
      <td class="gt_row gt_right">2047</td>
      <td class="gt_row gt_right">1.000</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">B12083033</td>
      <td class="gt_row gt_left">2016</td>
      <td class="gt_row gt_right">3418</td>
      <td class="gt_row gt_right">1.670</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">B12083033</td>
      <td class="gt_row gt_left">2017</td>
      <td class="gt_row gt_right">955</td>
      <td class="gt_row gt_right">0.279</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">B12083033</td>
      <td class="gt_row gt_left">2018</td>
      <td class="gt_row gt_right">3454</td>
      <td class="gt_row gt_right">3.617</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">B12117505</td>
      <td class="gt_row gt_left">2012</td>
      <td class="gt_row gt_right">2479</td>
      <td class="gt_row gt_right">NA</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">B12117505</td>
      <td class="gt_row gt_left">2013</td>
      <td class="gt_row gt_right">3915</td>
      <td class="gt_row gt_right">1.579</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">B12117505</td>
      <td class="gt_row gt_left">2014</td>
      <td class="gt_row gt_right">2430</td>
      <td class="gt_row gt_right">0.621</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">B12117505</td>
      <td class="gt_row gt_left">2015</td>
      <td class="gt_row gt_right">2792</td>
      <td class="gt_row gt_right">1.149</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">B12117505</td>
      <td class="gt_row gt_left">2016</td>
      <td class="gt_row gt_right">1246</td>
      <td class="gt_row gt_right">0.446</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">B12117505</td>
      <td class="gt_row gt_left">2017</td>
      <td class="gt_row gt_right">187</td>
      <td class="gt_row gt_right">0.150</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">B12117505</td>
      <td class="gt_row gt_left">2018</td>
      <td class="gt_row gt_right">730</td>
      <td class="gt_row gt_right">3.904</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">B12121772</td>
      <td class="gt_row gt_left">2012</td>
      <td class="gt_row gt_right">855</td>
      <td class="gt_row gt_right">NA</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">B12121772</td>
      <td class="gt_row gt_left">2013</td>
      <td class="gt_row gt_right">810</td>
      <td class="gt_row gt_right">0.947</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">B12121772</td>
      <td class="gt_row gt_left">2014</td>
      <td class="gt_row gt_right">643</td>
      <td class="gt_row gt_right">0.794</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">B12121772</td>
      <td class="gt_row gt_left">2015</td>
      <td class="gt_row gt_right">422</td>
      <td class="gt_row gt_right">0.656</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">B12121772</td>
      <td class="gt_row gt_left">2016</td>
      <td class="gt_row gt_right">724</td>
      <td class="gt_row gt_right">1.716</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">B12121772</td>
      <td class="gt_row gt_left">2017</td>
      <td class="gt_row gt_right">616</td>
      <td class="gt_row gt_right">0.851</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">B12121772</td>
      <td class="gt_row gt_left">2018</td>
      <td class="gt_row gt_right">455</td>
      <td class="gt_row gt_right">0.739</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">B12127908</td>
      <td class="gt_row gt_left">2012</td>
      <td class="gt_row gt_right">285</td>
      <td class="gt_row gt_right">NA</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">B12127908</td>
      <td class="gt_row gt_left">2013</td>
      <td class="gt_row gt_right">261</td>
      <td class="gt_row gt_right">0.916</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">B12127908</td>
      <td class="gt_row gt_left">2014</td>
      <td class="gt_row gt_right">491</td>
      <td class="gt_row gt_right">1.881</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">B12127908</td>
      <td class="gt_row gt_left">2015</td>
      <td class="gt_row gt_right">138</td>
      <td class="gt_row gt_right">0.281</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">B12127908</td>
      <td class="gt_row gt_left">2016</td>
      <td class="gt_row gt_right">485</td>
      <td class="gt_row gt_right">3.514</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">B12127908</td>
      <td class="gt_row gt_left">2017</td>
      <td class="gt_row gt_right">403</td>
      <td class="gt_row gt_right">0.831</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">B12127908</td>
      <td class="gt_row gt_left">2018</td>
      <td class="gt_row gt_right">436</td>
      <td class="gt_row gt_right">1.082</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">B22111559</td>
      <td class="gt_row gt_left">2012</td>
      <td class="gt_row gt_right">1377</td>
      <td class="gt_row gt_right">NA</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">B22111559</td>
      <td class="gt_row gt_left">2013</td>
      <td class="gt_row gt_right">188</td>
      <td class="gt_row gt_right">0.137</td>
    </tr>
  </tbody>
  
  
</table></div>
</div>
</div>
</section>
<section id="前年度比算出の手順" class="slide level2">
<h2>前年度比算出の手順</h2>
<ul>
<li><ol type="1">
<li>long_empを企業コードとyearでソートする</li>
</ol></li>
<li><ol start="2" type="1">
<li>group_byと<strong>lag</strong>関数で企業コードごとの前年従業員数カラムを作る</li>
</ol></li>
<li><ol start="3" type="1">
<li>mutateと<strong>if_else</strong>関数で従業員数伸び率カラムを作る</li>
</ol>
<ul>
<li>分子が0以下または分母が0以下のときはNAで返す</li>
<li>上記以外は従業員数÷前年従業員数を返す</li>
</ul></li>
<li><ol start="4" type="1">
<li>見栄えを整える</li>
</ol></li>
</ul>
<p>従業員数に注目したタテ持ちデータのlong_emp_lをlong_empとして使用します。</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>long_emp <span class="ot">&lt;-</span> long_emp_l</span></code></pre></div>
</section>
<section id="tejun_sort" class="slide level2">
<h2>手順１：データのソート</h2>
<ul>
<li>前年比算出準備として企業コードとyearでソートします</li>
<li>ソートすることでカラム間の差分が計算できるからです</li>
</ul>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>long_emp <span class="ot">&lt;-</span> long_emp <span class="sc">%&gt;%</span> </span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(企業コード, year)</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>long_emp</span></code></pre></div>
<pre><code># A tibble: 12,516 x 3
   企業コード year  従業員数
   &lt;chr&gt;      &lt;chr&gt;    &lt;dbl&gt;
 1 B02111302  2012      1254
 2 B02111302  2013       768
 3 B02111302  2014      1242
 4 B02111302  2015      1409
 5 B02111302  2016       728
 6 B02111302  2017      1401
 7 B02111302  2018      1096
 8 B02117802  2012        82
 9 B02117802  2013       376
10 B02117802  2014       374
# ... with 12,506 more rows</code></pre>
</section>
<section id="tejun_zennenjuu" class="slide level2">
<h2>手順２：前年従業員数の作成</h2>
<ul>
<li>企業コードごとに前年従業員数カラムを作成します</li>
<li>lag関数は指定したベクトルを前にnずらす関数です</li>
</ul>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>long_emp <span class="ot">&lt;-</span> long_emp <span class="sc">%&gt;%</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(企業コード) <span class="sc">%&gt;%</span> </span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(前年従業員数 <span class="ot">=</span> <span class="fu">lag</span>(従業員数, <span class="at">n =</span> <span class="dv">1</span>))</span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>long_emp</span></code></pre></div>
<pre><code># A tibble: 12,516 x 4
# Groups:   企業コード [1,788]
   企業コード year  従業員数 前年従業員数
   &lt;chr&gt;      &lt;chr&gt;    &lt;dbl&gt;        &lt;dbl&gt;
 1 B02111302  2012      1254           NA
 2 B02111302  2013       768         1254
 3 B02111302  2014      1242          768
 4 B02111302  2015      1409         1242
 5 B02111302  2016       728         1409
 6 B02111302  2017      1401          728
 7 B02111302  2018      1096         1401
 8 B02117802  2012        82           NA
 9 B02117802  2013       376           82
10 B02117802  2014       374          376
# ... with 12,506 more rows</code></pre>
</section>
<section id="tejun_zennenhi" class="slide level2">
<h2>手順３：前年度比算出</h2>
<ul>
<li>従業員数伸び率カラムを作成します</li>
</ul>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>long_emp <span class="ot">&lt;-</span> long_emp <span class="sc">%&gt;%</span> </span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(従業員数伸び率 <span class="ot">=</span></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>      <span class="fu">if_else</span>(前年従業員数 <span class="sc">&lt;=</span> <span class="dv">0</span> <span class="sc">|</span> 従業員数 <span class="sc">&lt;=</span> <span class="dv">0</span>,</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>              <span class="fu">as.double</span>(<span class="cn">NA</span>), 従業員数 <span class="sc">/</span> 前年従業員数))</span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>long_emp</span></code></pre></div>
<pre><code># A tibble: 12,516 x 5
# Groups:   企業コード [1,788]
   企業コード year  従業員数 前年従業員数 従業員数伸び率
   &lt;chr&gt;      &lt;chr&gt;    &lt;dbl&gt;        &lt;dbl&gt;          &lt;dbl&gt;
 1 B02111302  2012      1254           NA         NA    
 2 B02111302  2013       768         1254          0.612
 3 B02111302  2014      1242          768          1.62 
 4 B02111302  2015      1409         1242          1.13 
 5 B02111302  2016       728         1409          0.517
 6 B02111302  2017      1401          728          1.92 
 7 B02111302  2018      1096         1401          0.782
 8 B02117802  2012        82           NA         NA    
 9 B02117802  2013       376           82          4.59 
10 B02117802  2014       374          376          0.995
# ... with 12,506 more rows</code></pre>
</section>
<section id="tejun_mibae" class="slide level2">
<h2>手順４：見栄えを整える</h2>
<ul>
<li>従業員数伸び率を小数点以下3桁にまるめ、中間変数である前年従業員数を消去します</li>
</ul>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>long_emp <span class="ot">&lt;-</span> long_emp <span class="sc">%&gt;%</span> </span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> <span class="co"># group化はもう不要なのでgroupを解除します</span></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(従業員数伸び率 <span class="ot">=</span> <span class="fu">round</span>(従業員数伸び率, <span class="dv">3</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>前年従業員数) </span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>long_emp</span></code></pre></div>
<pre><code># A tibble: 12,516 x 4
   企業コード year  従業員数 従業員数伸び率
   &lt;chr&gt;      &lt;chr&gt;    &lt;dbl&gt;          &lt;dbl&gt;
 1 B02111302  2012      1254         NA    
 2 B02111302  2013       768          0.612
 3 B02111302  2014      1242          1.62 
 4 B02111302  2015      1409          1.13 
 5 B02111302  2016       728          0.517
 6 B02111302  2017      1401          1.92 
 7 B02111302  2018      1096          0.782
 8 B02117802  2012        82         NA    
 9 B02117802  2013       376          4.58 
10 B02117802  2014       374          0.995
# ... with 12,506 more rows</code></pre>
</section>
<section id="hi_matome" class="slide level2">
<h2>前年度比算出まとめ</h2>
<ul>
<li>スライドの都合上、逐一代入をしましたが、最終的には以下のようにパイプを繋げて書きましょう</li>
<li>これ以上パイプが長くなるようなときは、適宜中間変数などを作成しましょう</li>
</ul>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>long_emp <span class="ot">&lt;-</span> long_emp <span class="sc">%&gt;%</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(企業コード, year) <span class="sc">%&gt;%</span> </span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(企業コード) <span class="sc">%&gt;%</span> </span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(前年従業員数 <span class="ot">=</span> <span class="fu">lag</span>(従業員数, <span class="at">n =</span> <span class="dv">1</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(従業員数伸び率 <span class="ot">=</span></span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a>      <span class="fu">if_else</span>(前年従業員数 <span class="sc">&lt;=</span> <span class="dv">0</span> <span class="sc">|</span> 従業員数 <span class="sc">&lt;=</span> <span class="dv">0</span>,</span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a>             <span class="fu">as.double</span>(<span class="cn">NA</span>), 従業員数 <span class="sc">/</span> 前年従業員数)) <span class="sc">%&gt;%</span> </span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(従業員数伸び率 <span class="ot">=</span> <span class="fu">round</span>(従業員数伸び率, <span class="dv">3</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>前年従業員数) </span></code></pre></div>
</section>
<section id="zennenhi_sanko" class="slide level2">
<h2>参考：横持ちで表示</h2>
<ul>
<li>従業員数伸び率をタテ持ちデータで算出しました。これは以下のようにしてヨコ持ちデータに変換できます</li>
</ul>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>long_emp <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="sc">-</span>従業員数) <span class="sc">%&gt;%</span> </span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> year,</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>              <span class="at">values_from =</span> 従業員数伸び率,</span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>              <span class="at">names_prefix =</span> <span class="st">&quot;従業員数_伸び率&quot;</span>)</span></code></pre></div>
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

#cdaixkccxr .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 20px;
  font-weight: normal;
  font-style: normal;
  background-color: #F4F7E2;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#cdaixkccxr .gt_heading {
  background-color: #F4F7E2;
  text-align: center;
  border-bottom-color: #F4F7E2;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#cdaixkccxr .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  border-bottom-color: #F4F7E2;
  border-bottom-width: 0;
}

#cdaixkccxr .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 4px;
  border-top-color: #F4F7E2;
  border-top-width: 0;
}

#cdaixkccxr .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#cdaixkccxr .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#cdaixkccxr .gt_col_heading {
  color: #333333;
  background-color: #F4F7E2;
  font-size: 22px;
  font-weight: bold;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#cdaixkccxr .gt_column_spanner_outer {
  color: #333333;
  background-color: #F4F7E2;
  font-size: 22px;
  font-weight: bold;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#cdaixkccxr .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#cdaixkccxr .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#cdaixkccxr .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#cdaixkccxr .gt_group_heading {
  padding: 8px;
  color: #333333;
  background-color: #F4F7E2;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
}

#cdaixkccxr .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #F4F7E2;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#cdaixkccxr .gt_from_md > :first-child {
  margin-top: 0;
}

#cdaixkccxr .gt_from_md > :last-child {
  margin-bottom: 0;
}

#cdaixkccxr .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#cdaixkccxr .gt_stub {
  color: #333333;
  background-color: #F4F7E2;
  font-size: 100%;
  font-weight: bold;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 12px;
}

#cdaixkccxr .gt_summary_row {
  color: #333333;
  background-color: #F4F7E2;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#cdaixkccxr .gt_first_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
}

#cdaixkccxr .gt_grand_summary_row {
  color: #333333;
  background-color: #F4F7E2;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#cdaixkccxr .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#cdaixkccxr .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#cdaixkccxr .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#cdaixkccxr .gt_footnotes {
  color: #333333;
  background-color: #F4F7E2;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#cdaixkccxr .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding: 4px;
}

#cdaixkccxr .gt_sourcenotes {
  color: #333333;
  background-color: #F4F7E2;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#cdaixkccxr .gt_sourcenote {
  font-size: 90%;
  padding: 4px;
}

#cdaixkccxr .gt_left {
  text-align: left;
}

#cdaixkccxr .gt_center {
  text-align: center;
}

#cdaixkccxr .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#cdaixkccxr .gt_font_normal {
  font-weight: normal;
}

#cdaixkccxr .gt_font_bold {
  font-weight: bold;
}

#cdaixkccxr .gt_font_italic {
  font-style: italic;
}

#cdaixkccxr .gt_super {
  font-size: 65%;
}

#cdaixkccxr .gt_footnote_marks {
  font-style: italic;
  font-size: 65%;
}
</style>
<div id="cdaixkccxr" style="overflow-x:auto;overflow-y:auto;width:auto;height:270px;"><table class="gt_table">
  
  <thead class="gt_col_headings">
    <tr>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1">企業コード</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">従業員数伸び率_2012</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">従業員数伸び率_2013</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">従業員数伸び率_2014</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">従業員数伸び率_2015</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">従業員数伸び率_2016</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">従業員数伸び率_2017</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">従業員数伸び率_2018</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr>
      <td class="gt_row gt_left">B02111302</td>
      <td class="gt_row gt_right">NA</td>
      <td class="gt_row gt_right">0.612</td>
      <td class="gt_row gt_right">1.617</td>
      <td class="gt_row gt_right">1.134</td>
      <td class="gt_row gt_right">0.517</td>
      <td class="gt_row gt_right">1.924</td>
      <td class="gt_row gt_right">0.782</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">B02117802</td>
      <td class="gt_row gt_right">NA</td>
      <td class="gt_row gt_right">4.585</td>
      <td class="gt_row gt_right">0.995</td>
      <td class="gt_row gt_right">0.786</td>
      <td class="gt_row gt_right">1.435</td>
      <td class="gt_row gt_right">0.552</td>
      <td class="gt_row gt_right">0.742</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">B02122250</td>
      <td class="gt_row gt_right">NA</td>
      <td class="gt_row gt_right">0.873</td>
      <td class="gt_row gt_right">1.557</td>
      <td class="gt_row gt_right">1.046</td>
      <td class="gt_row gt_right">0.264</td>
      <td class="gt_row gt_right">1.761</td>
      <td class="gt_row gt_right">1.329</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">B02122602</td>
      <td class="gt_row gt_right">NA</td>
      <td class="gt_row gt_right">0.182</td>
      <td class="gt_row gt_right">1.445</td>
      <td class="gt_row gt_right">0.117</td>
      <td class="gt_row gt_right">23.962</td>
      <td class="gt_row gt_right">0.445</td>
      <td class="gt_row gt_right">1.652</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">B02125529</td>
      <td class="gt_row gt_right">NA</td>
      <td class="gt_row gt_right">0.928</td>
      <td class="gt_row gt_right">0.496</td>
      <td class="gt_row gt_right">1.071</td>
      <td class="gt_row gt_right">1.508</td>
      <td class="gt_row gt_right">1.028</td>
      <td class="gt_row gt_right">1.087</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">B02128716</td>
      <td class="gt_row gt_right">NA</td>
      <td class="gt_row gt_right">0.936</td>
      <td class="gt_row gt_right">0.150</td>
      <td class="gt_row gt_right">9.548</td>
      <td class="gt_row gt_right">0.815</td>
      <td class="gt_row gt_right">0.798</td>
      <td class="gt_row gt_right">1.441</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">B02129789</td>
      <td class="gt_row gt_right">NA</td>
      <td class="gt_row gt_right">1.496</td>
      <td class="gt_row gt_right">0.874</td>
      <td class="gt_row gt_right">0.884</td>
      <td class="gt_row gt_right">1.383</td>
      <td class="gt_row gt_right">0.591</td>
      <td class="gt_row gt_right">1.529</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">B02153443</td>
      <td class="gt_row gt_right">NA</td>
      <td class="gt_row gt_right">1.716</td>
      <td class="gt_row gt_right">1.475</td>
      <td class="gt_row gt_right">1.456</td>
      <td class="gt_row gt_right">0.548</td>
      <td class="gt_row gt_right">1.098</td>
      <td class="gt_row gt_right">1.405</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">B02505784</td>
      <td class="gt_row gt_right">NA</td>
      <td class="gt_row gt_right">1.871</td>
      <td class="gt_row gt_right">1.557</td>
      <td class="gt_row gt_right">0.688</td>
      <td class="gt_row gt_right">0.731</td>
      <td class="gt_row gt_right">1.811</td>
      <td class="gt_row gt_right">0.807</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">B02514384</td>
      <td class="gt_row gt_right">NA</td>
      <td class="gt_row gt_right">8.889</td>
      <td class="gt_row gt_right">0.506</td>
      <td class="gt_row gt_right">3.901</td>
      <td class="gt_row gt_right">0.753</td>
      <td class="gt_row gt_right">0.647</td>
      <td class="gt_row gt_right">2.104</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">B12083033</td>
      <td class="gt_row gt_right">NA</td>
      <td class="gt_row gt_right">0.638</td>
      <td class="gt_row gt_right">0.757</td>
      <td class="gt_row gt_right">1.000</td>
      <td class="gt_row gt_right">1.670</td>
      <td class="gt_row gt_right">0.279</td>
      <td class="gt_row gt_right">3.617</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">B12117505</td>
      <td class="gt_row gt_right">NA</td>
      <td class="gt_row gt_right">1.579</td>
      <td class="gt_row gt_right">0.621</td>
      <td class="gt_row gt_right">1.149</td>
      <td class="gt_row gt_right">0.446</td>
      <td class="gt_row gt_right">0.150</td>
      <td class="gt_row gt_right">3.904</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">B12121772</td>
      <td class="gt_row gt_right">NA</td>
      <td class="gt_row gt_right">0.947</td>
      <td class="gt_row gt_right">0.794</td>
      <td class="gt_row gt_right">0.656</td>
      <td class="gt_row gt_right">1.716</td>
      <td class="gt_row gt_right">0.851</td>
      <td class="gt_row gt_right">0.739</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">B12127908</td>
      <td class="gt_row gt_right">NA</td>
      <td class="gt_row gt_right">0.916</td>
      <td class="gt_row gt_right">1.881</td>
      <td class="gt_row gt_right">0.281</td>
      <td class="gt_row gt_right">3.514</td>
      <td class="gt_row gt_right">0.831</td>
      <td class="gt_row gt_right">1.082</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">B22111559</td>
      <td class="gt_row gt_right">NA</td>
      <td class="gt_row gt_right">0.137</td>
      <td class="gt_row gt_right">11.479</td>
      <td class="gt_row gt_right">0.648</td>
      <td class="gt_row gt_right">0.386</td>
      <td class="gt_row gt_right">1.796</td>
      <td class="gt_row gt_right">1.769</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">B22118371</td>
      <td class="gt_row gt_right">NA</td>
      <td class="gt_row gt_right">0.756</td>
      <td class="gt_row gt_right">0.528</td>
      <td class="gt_row gt_right">0.301</td>
      <td class="gt_row gt_right">3.082</td>
      <td class="gt_row gt_right">2.172</td>
      <td class="gt_row gt_right">0.018</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">B42105710</td>
      <td class="gt_row gt_right">NA</td>
      <td class="gt_row gt_right">0.716</td>
      <td class="gt_row gt_right">0.935</td>
      <td class="gt_row gt_right">0.556</td>
      <td class="gt_row gt_right">0.540</td>
      <td class="gt_row gt_right">4.047</td>
      <td class="gt_row gt_right">1.102</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">B42112673</td>
      <td class="gt_row gt_right">NA</td>
      <td class="gt_row gt_right">1.464</td>
      <td class="gt_row gt_right">1.636</td>
      <td class="gt_row gt_right">3.261</td>
      <td class="gt_row gt_right">0.411</td>
      <td class="gt_row gt_right">1.139</td>
      <td class="gt_row gt_right">0.620</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">B42113715</td>
      <td class="gt_row gt_right">NA</td>
      <td class="gt_row gt_right">0.974</td>
      <td class="gt_row gt_right">0.755</td>
      <td class="gt_row gt_right">1.742</td>
      <td class="gt_row gt_right">0.273</td>
      <td class="gt_row gt_right">3.379</td>
      <td class="gt_row gt_right">0.991</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">B42116333</td>
      <td class="gt_row gt_right">NA</td>
      <td class="gt_row gt_right">0.188</td>
      <td class="gt_row gt_right">3.293</td>
      <td class="gt_row gt_right">0.627</td>
      <td class="gt_row gt_right">0.621</td>
      <td class="gt_row gt_right">3.732</td>
      <td class="gt_row gt_right">0.977</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">B42119099</td>
      <td class="gt_row gt_right">NA</td>
      <td class="gt_row gt_right">0.754</td>
      <td class="gt_row gt_right">0.708</td>
      <td class="gt_row gt_right">1.032</td>
      <td class="gt_row gt_right">2.212</td>
      <td class="gt_row gt_right">0.403</td>
      <td class="gt_row gt_right">1.345</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">B42120113</td>
      <td class="gt_row gt_right">NA</td>
      <td class="gt_row gt_right">1.771</td>
      <td class="gt_row gt_right">0.748</td>
      <td class="gt_row gt_right">1.522</td>
      <td class="gt_row gt_right">0.469</td>
      <td class="gt_row gt_right">0.089</td>
      <td class="gt_row gt_right">17.400</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">B42124422</td>
      <td class="gt_row gt_right">NA</td>
      <td class="gt_row gt_right">0.951</td>
      <td class="gt_row gt_right">1.604</td>
      <td class="gt_row gt_right">0.803</td>
      <td class="gt_row gt_right">1.646</td>
      <td class="gt_row gt_right">0.415</td>
      <td class="gt_row gt_right">1.327</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">B42125462</td>
      <td class="gt_row gt_right">NA</td>
      <td class="gt_row gt_right">2.710</td>
      <td class="gt_row gt_right">1.865</td>
      <td class="gt_row gt_right">1.347</td>
      <td class="gt_row gt_right">0.525</td>
      <td class="gt_row gt_right">1.449</td>
      <td class="gt_row gt_right">0.702</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">B42126156</td>
      <td class="gt_row gt_right">NA</td>
      <td class="gt_row gt_right">0.873</td>
      <td class="gt_row gt_right">0.785</td>
      <td class="gt_row gt_right">0.388</td>
      <td class="gt_row gt_right">2.503</td>
      <td class="gt_row gt_right">0.557</td>
      <td class="gt_row gt_right">0.981</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">B42126640</td>
      <td class="gt_row gt_right">NA</td>
      <td class="gt_row gt_right">1.579</td>
      <td class="gt_row gt_right">1.864</td>
      <td class="gt_row gt_right">0.856</td>
      <td class="gt_row gt_right">0.089</td>
      <td class="gt_row gt_right">9.062</td>
      <td class="gt_row gt_right">0.743</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">B42152322</td>
      <td class="gt_row gt_right">NA</td>
      <td class="gt_row gt_right">1.106</td>
      <td class="gt_row gt_right">0.889</td>
      <td class="gt_row gt_right">1.499</td>
      <td class="gt_row gt_right">0.302</td>
      <td class="gt_row gt_right">1.354</td>
      <td class="gt_row gt_right">2.713</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">B42193155</td>
      <td class="gt_row gt_right">NA</td>
      <td class="gt_row gt_right">39.812</td>
      <td class="gt_row gt_right">1.527</td>
      <td class="gt_row gt_right">0.825</td>
      <td class="gt_row gt_right">1.014</td>
      <td class="gt_row gt_right">1.009</td>
      <td class="gt_row gt_right">0.752</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">B42504542</td>
      <td class="gt_row gt_right">NA</td>
      <td class="gt_row gt_right">1.260</td>
      <td class="gt_row gt_right">0.561</td>
      <td class="gt_row gt_right">0.982</td>
      <td class="gt_row gt_right">1.106</td>
      <td class="gt_row gt_right">1.200</td>
      <td class="gt_row gt_right">0.447</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">B42539783</td>
      <td class="gt_row gt_right">NA</td>
      <td class="gt_row gt_right">1.701</td>
      <td class="gt_row gt_right">0.935</td>
      <td class="gt_row gt_right">0.679</td>
      <td class="gt_row gt_right">2.112</td>
      <td class="gt_row gt_right">0.430</td>
      <td class="gt_row gt_right">0.127</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">B42588245</td>
      <td class="gt_row gt_right">NA</td>
      <td class="gt_row gt_right">0.725</td>
      <td class="gt_row gt_right">0.567</td>
      <td class="gt_row gt_right">0.537</td>
      <td class="gt_row gt_right">2.579</td>
      <td class="gt_row gt_right">0.736</td>
      <td class="gt_row gt_right">1.546</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">B42597519</td>
      <td class="gt_row gt_right">NA</td>
      <td class="gt_row gt_right">2.696</td>
      <td class="gt_row gt_right">0.555</td>
      <td class="gt_row gt_right">1.576</td>
      <td class="gt_row gt_right">0.204</td>
      <td class="gt_row gt_right">4.103</td>
      <td class="gt_row gt_right">1.207</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">B42633350</td>
      <td class="gt_row gt_right">NA</td>
      <td class="gt_row gt_right">0.445</td>
      <td class="gt_row gt_right">1.903</td>
      <td class="gt_row gt_right">0.797</td>
      <td class="gt_row gt_right">1.358</td>
      <td class="gt_row gt_right">0.797</td>
      <td class="gt_row gt_right">0.307</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">B52112726</td>
      <td class="gt_row gt_right">NA</td>
      <td class="gt_row gt_right">0.198</td>
      <td class="gt_row gt_right">9.000</td>
      <td class="gt_row gt_right">0.543</td>
      <td class="gt_row gt_right">1.146</td>
      <td class="gt_row gt_right">1.590</td>
      <td class="gt_row gt_right">0.443</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">B52119466</td>
      <td class="gt_row gt_right">NA</td>
      <td class="gt_row gt_right">0.733</td>
      <td class="gt_row gt_right">2.052</td>
      <td class="gt_row gt_right">0.919</td>
      <td class="gt_row gt_right">0.320</td>
      <td class="gt_row gt_right">2.415</td>
      <td class="gt_row gt_right">0.911</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">B58115159</td>
      <td class="gt_row gt_right">NA</td>
      <td class="gt_row gt_right">1.782</td>
      <td class="gt_row gt_right">0.529</td>
      <td class="gt_row gt_right">2.206</td>
      <td class="gt_row gt_right">0.466</td>
      <td class="gt_row gt_right">1.061</td>
      <td class="gt_row gt_right">1.566</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">B82147010</td>
      <td class="gt_row gt_right">NA</td>
      <td class="gt_row gt_right">1.701</td>
      <td class="gt_row gt_right">0.768</td>
      <td class="gt_row gt_right">1.102</td>
      <td class="gt_row gt_right">1.058</td>
      <td class="gt_row gt_right">2.050</td>
      <td class="gt_row gt_right">0.631</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">B92111476</td>
      <td class="gt_row gt_right">NA</td>
      <td class="gt_row gt_right">1.156</td>
      <td class="gt_row gt_right">1.445</td>
      <td class="gt_row gt_right">0.179</td>
      <td class="gt_row gt_right">5.001</td>
      <td class="gt_row gt_right">0.166</td>
      <td class="gt_row gt_right">3.004</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">B92111910</td>
      <td class="gt_row gt_right">NA</td>
      <td class="gt_row gt_right">1.097</td>
      <td class="gt_row gt_right">0.302</td>
      <td class="gt_row gt_right">2.273</td>
      <td class="gt_row gt_right">1.028</td>
      <td class="gt_row gt_right">0.992</td>
      <td class="gt_row gt_right">0.795</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">B92122805</td>
      <td class="gt_row gt_right">NA</td>
      <td class="gt_row gt_right">1.634</td>
      <td class="gt_row gt_right">0.437</td>
      <td class="gt_row gt_right">2.889</td>
      <td class="gt_row gt_right">0.437</td>
      <td class="gt_row gt_right">1.963</td>
      <td class="gt_row gt_right">0.017</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">B92159680</td>
      <td class="gt_row gt_right">NA</td>
      <td class="gt_row gt_right">0.805</td>
      <td class="gt_row gt_right">0.533</td>
      <td class="gt_row gt_right">4.522</td>
      <td class="gt_row gt_right">0.135</td>
      <td class="gt_row gt_right">1.273</td>
      <td class="gt_row gt_right">2.629</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">B92598280</td>
      <td class="gt_row gt_right">NA</td>
      <td class="gt_row gt_right">0.419</td>
      <td class="gt_row gt_right">3.651</td>
      <td class="gt_row gt_right">0.767</td>
      <td class="gt_row gt_right">0.292</td>
      <td class="gt_row gt_right">4.478</td>
      <td class="gt_row gt_right">0.751</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">C02122267</td>
      <td class="gt_row gt_right">NA</td>
      <td class="gt_row gt_right">1.619</td>
      <td class="gt_row gt_right">1.050</td>
      <td class="gt_row gt_right">0.983</td>
      <td class="gt_row gt_right">0.724</td>
      <td class="gt_row gt_right">1.209</td>
      <td class="gt_row gt_right">0.987</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">C02128399</td>
      <td class="gt_row gt_right">NA</td>
      <td class="gt_row gt_right">1.502</td>
      <td class="gt_row gt_right">0.030</td>
      <td class="gt_row gt_right">36.333</td>
      <td class="gt_row gt_right">0.913</td>
      <td class="gt_row gt_right">0.767</td>
      <td class="gt_row gt_right">0.881</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">C02137964</td>
      <td class="gt_row gt_right">NA</td>
      <td class="gt_row gt_right">3.113</td>
      <td class="gt_row gt_right">0.588</td>
      <td class="gt_row gt_right">0.680</td>
      <td class="gt_row gt_right">0.858</td>
      <td class="gt_row gt_right">1.802</td>
      <td class="gt_row gt_right">0.342</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">C02522283</td>
      <td class="gt_row gt_right">NA</td>
      <td class="gt_row gt_right">1.166</td>
      <td class="gt_row gt_right">1.290</td>
      <td class="gt_row gt_right">0.381</td>
      <td class="gt_row gt_right">1.133</td>
      <td class="gt_row gt_right">1.638</td>
      <td class="gt_row gt_right">0.883</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">C12118341</td>
      <td class="gt_row gt_right">NA</td>
      <td class="gt_row gt_right">1.396</td>
      <td class="gt_row gt_right">0.334</td>
      <td class="gt_row gt_right">0.160</td>
      <td class="gt_row gt_right">11.147</td>
      <td class="gt_row gt_right">0.786</td>
      <td class="gt_row gt_right">2.007</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">C12582479</td>
      <td class="gt_row gt_right">NA</td>
      <td class="gt_row gt_right">0.667</td>
      <td class="gt_row gt_right">1.291</td>
      <td class="gt_row gt_right">1.424</td>
      <td class="gt_row gt_right">1.160</td>
      <td class="gt_row gt_right">1.224</td>
      <td class="gt_row gt_right">0.072</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">C22116979</td>
      <td class="gt_row gt_right">NA</td>
      <td class="gt_row gt_right">0.356</td>
      <td class="gt_row gt_right">1.675</td>
      <td class="gt_row gt_right">2.848</td>
      <td class="gt_row gt_right">0.763</td>
      <td class="gt_row gt_right">0.869</td>
      <td class="gt_row gt_right">1.405</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">C22158694</td>
      <td class="gt_row gt_right">NA</td>
      <td class="gt_row gt_right">0.990</td>
      <td class="gt_row gt_right">0.726</td>
      <td class="gt_row gt_right">0.214</td>
      <td class="gt_row gt_right">12.149</td>
      <td class="gt_row gt_right">0.380</td>
      <td class="gt_row gt_right">1.114</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">C32114510</td>
      <td class="gt_row gt_right">NA</td>
      <td class="gt_row gt_right">0.706</td>
      <td class="gt_row gt_right">0.440</td>
      <td class="gt_row gt_right">3.041</td>
      <td class="gt_row gt_right">0.375</td>
      <td class="gt_row gt_right">0.920</td>
      <td class="gt_row gt_right">2.372</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">C32118312</td>
      <td class="gt_row gt_right">NA</td>
      <td class="gt_row gt_right">0.766</td>
      <td class="gt_row gt_right">0.817</td>
      <td class="gt_row gt_right">4.179</td>
      <td class="gt_row gt_right">0.391</td>
      <td class="gt_row gt_right">0.927</td>
      <td class="gt_row gt_right">0.296</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">C32618733</td>
      <td class="gt_row gt_right">NA</td>
      <td class="gt_row gt_right">0.882</td>
      <td class="gt_row gt_right">0.948</td>
      <td class="gt_row gt_right">1.385</td>
      <td class="gt_row gt_right">0.872</td>
      <td class="gt_row gt_right">2.646</td>
      <td class="gt_row gt_right">0.267</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">C42103174</td>
      <td class="gt_row gt_right">NA</td>
      <td class="gt_row gt_right">4.812</td>
      <td class="gt_row gt_right">0.107</td>
      <td class="gt_row gt_right">0.404</td>
      <td class="gt_row gt_right">31.952</td>
      <td class="gt_row gt_right">0.358</td>
      <td class="gt_row gt_right">0.912</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">C42110360</td>
      <td class="gt_row gt_right">NA</td>
      <td class="gt_row gt_right">1.270</td>
      <td class="gt_row gt_right">0.473</td>
      <td class="gt_row gt_right">0.169</td>
      <td class="gt_row gt_right">7.533</td>
      <td class="gt_row gt_right">1.292</td>
      <td class="gt_row gt_right">1.021</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">C42112827</td>
      <td class="gt_row gt_right">NA</td>
      <td class="gt_row gt_right">0.595</td>
      <td class="gt_row gt_right">3.546</td>
      <td class="gt_row gt_right">1.226</td>
      <td class="gt_row gt_right">0.239</td>
      <td class="gt_row gt_right">2.856</td>
      <td class="gt_row gt_right">1.369</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">C42125774</td>
      <td class="gt_row gt_right">NA</td>
      <td class="gt_row gt_right">1.019</td>
      <td class="gt_row gt_right">0.744</td>
      <td class="gt_row gt_right">0.125</td>
      <td class="gt_row gt_right">6.950</td>
      <td class="gt_row gt_right">0.727</td>
      <td class="gt_row gt_right">1.218</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">C42142466</td>
      <td class="gt_row gt_right">NA</td>
      <td class="gt_row gt_right">0.907</td>
      <td class="gt_row gt_right">0.850</td>
      <td class="gt_row gt_right">1.326</td>
      <td class="gt_row gt_right">0.392</td>
      <td class="gt_row gt_right">1.702</td>
      <td class="gt_row gt_right">1.387</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">C42142500</td>
      <td class="gt_row gt_right">NA</td>
      <td class="gt_row gt_right">0.962</td>
      <td class="gt_row gt_right">0.710</td>
      <td class="gt_row gt_right">0.154</td>
      <td class="gt_row gt_right">18.017</td>
      <td class="gt_row gt_right">0.820</td>
      <td class="gt_row gt_right">0.720</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">C42151200</td>
      <td class="gt_row gt_right">NA</td>
      <td class="gt_row gt_right">0.534</td>
      <td class="gt_row gt_right">0.831</td>
      <td class="gt_row gt_right">1.340</td>
      <td class="gt_row gt_right">0.866</td>
      <td class="gt_row gt_right">1.461</td>
      <td class="gt_row gt_right">0.713</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">C42151408</td>
      <td class="gt_row gt_right">NA</td>
      <td class="gt_row gt_right">1.667</td>
      <td class="gt_row gt_right">0.774</td>
      <td class="gt_row gt_right">0.666</td>
      <td class="gt_row gt_right">1.058</td>
      <td class="gt_row gt_right">0.473</td>
      <td class="gt_row gt_right">1.583</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">C42151590</td>
      <td class="gt_row gt_right">NA</td>
      <td class="gt_row gt_right">1.115</td>
      <td class="gt_row gt_right">1.099</td>
      <td class="gt_row gt_right">1.453</td>
      <td class="gt_row gt_right">0.514</td>
      <td class="gt_row gt_right">1.598</td>
      <td class="gt_row gt_right">0.705</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">C42159269</td>
      <td class="gt_row gt_right">NA</td>
      <td class="gt_row gt_right">0.565</td>
      <td class="gt_row gt_right">1.355</td>
      <td class="gt_row gt_right">1.160</td>
      <td class="gt_row gt_right">0.799</td>
      <td class="gt_row gt_right">1.447</td>
      <td class="gt_row gt_right">1.000</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">C42166567</td>
      <td class="gt_row gt_right">NA</td>
      <td class="gt_row gt_right">0.997</td>
      <td class="gt_row gt_right">1.116</td>
      <td class="gt_row gt_right">1.349</td>
      <td class="gt_row gt_right">0.649</td>
      <td class="gt_row gt_right">0.454</td>
      <td class="gt_row gt_right">3.488</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">C42175682</td>
      <td class="gt_row gt_right">NA</td>
      <td class="gt_row gt_right">0.785</td>
      <td class="gt_row gt_right">1.123</td>
      <td class="gt_row gt_right">1.602</td>
      <td class="gt_row gt_right">0.541</td>
      <td class="gt_row gt_right">1.376</td>
      <td class="gt_row gt_right">1.652</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">C42516470</td>
      <td class="gt_row gt_right">NA</td>
      <td class="gt_row gt_right">1.072</td>
      <td class="gt_row gt_right">0.558</td>
      <td class="gt_row gt_right">0.159</td>
      <td class="gt_row gt_right">31.459</td>
      <td class="gt_row gt_right">0.729</td>
      <td class="gt_row gt_right">1.383</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">C42516485</td>
      <td class="gt_row gt_right">NA</td>
      <td class="gt_row gt_right">1.245</td>
      <td class="gt_row gt_right">1.135</td>
      <td class="gt_row gt_right">1.109</td>
      <td class="gt_row gt_right">0.013</td>
      <td class="gt_row gt_right">54.000</td>
      <td class="gt_row gt_right">1.049</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">C42538173</td>
      <td class="gt_row gt_right">NA</td>
      <td class="gt_row gt_right">0.250</td>
      <td class="gt_row gt_right">5.857</td>
      <td class="gt_row gt_right">0.463</td>
      <td class="gt_row gt_right">1.974</td>
      <td class="gt_row gt_right">1.213</td>
      <td class="gt_row gt_right">0.484</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">C42564567</td>
      <td class="gt_row gt_right">NA</td>
      <td class="gt_row gt_right">1.230</td>
      <td class="gt_row gt_right">0.633</td>
      <td class="gt_row gt_right">1.669</td>
      <td class="gt_row gt_right">0.660</td>
      <td class="gt_row gt_right">1.494</td>
      <td class="gt_row gt_right">0.507</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">C42616089</td>
      <td class="gt_row gt_right">NA</td>
      <td class="gt_row gt_right">14.617</td>
      <td class="gt_row gt_right">0.766</td>
      <td class="gt_row gt_right">1.423</td>
      <td class="gt_row gt_right">0.381</td>
      <td class="gt_row gt_right">3.897</td>
      <td class="gt_row gt_right">1.046</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">C42657447</td>
      <td class="gt_row gt_right">NA</td>
      <td class="gt_row gt_right">0.673</td>
      <td class="gt_row gt_right">0.876</td>
      <td class="gt_row gt_right">1.475</td>
      <td class="gt_row gt_right">0.831</td>
      <td class="gt_row gt_right">1.309</td>
      <td class="gt_row gt_right">1.819</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">C42833600</td>
      <td class="gt_row gt_right">NA</td>
      <td class="gt_row gt_right">0.938</td>
      <td class="gt_row gt_right">0.042</td>
      <td class="gt_row gt_right">5.800</td>
      <td class="gt_row gt_right">1.172</td>
      <td class="gt_row gt_right">2.794</td>
      <td class="gt_row gt_right">0.863</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">C52143315</td>
      <td class="gt_row gt_right">NA</td>
      <td class="gt_row gt_right">0.976</td>
      <td class="gt_row gt_right">1.520</td>
      <td class="gt_row gt_right">0.824</td>
      <td class="gt_row gt_right">1.090</td>
      <td class="gt_row gt_right">1.075</td>
      <td class="gt_row gt_right">1.182</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">C52174709</td>
      <td class="gt_row gt_right">NA</td>
      <td class="gt_row gt_right">0.487</td>
      <td class="gt_row gt_right">0.608</td>
      <td class="gt_row gt_right">2.444</td>
      <td class="gt_row gt_right">0.264</td>
      <td class="gt_row gt_right">2.828</td>
      <td class="gt_row gt_right">2.207</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">C62163186</td>
      <td class="gt_row gt_right">NA</td>
      <td class="gt_row gt_right">1.549</td>
      <td class="gt_row gt_right">1.139</td>
      <td class="gt_row gt_right">1.417</td>
      <td class="gt_row gt_right">0.697</td>
      <td class="gt_row gt_right">0.180</td>
      <td class="gt_row gt_right">4.863</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">C62177407</td>
      <td class="gt_row gt_right">NA</td>
      <td class="gt_row gt_right">1.425</td>
      <td class="gt_row gt_right">1.028</td>
      <td class="gt_row gt_right">0.737</td>
      <td class="gt_row gt_right">1.511</td>
      <td class="gt_row gt_right">1.554</td>
      <td class="gt_row gt_right">0.823</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">C62547310</td>
      <td class="gt_row gt_right">NA</td>
      <td class="gt_row gt_right">1.390</td>
      <td class="gt_row gt_right">1.274</td>
      <td class="gt_row gt_right">0.994</td>
      <td class="gt_row gt_right">2.115</td>
      <td class="gt_row gt_right">0.094</td>
      <td class="gt_row gt_right">0.381</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">C72119562</td>
      <td class="gt_row gt_right">NA</td>
      <td class="gt_row gt_right">0.976</td>
      <td class="gt_row gt_right">1.847</td>
      <td class="gt_row gt_right">0.628</td>
      <td class="gt_row gt_right">1.425</td>
      <td class="gt_row gt_right">0.490</td>
      <td class="gt_row gt_right">0.548</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">C72124439</td>
      <td class="gt_row gt_right">NA</td>
      <td class="gt_row gt_right">0.802</td>
      <td class="gt_row gt_right">1.072</td>
      <td class="gt_row gt_right">1.807</td>
      <td class="gt_row gt_right">0.486</td>
      <td class="gt_row gt_right">2.172</td>
      <td class="gt_row gt_right">0.787</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">C82108010</td>
      <td class="gt_row gt_right">NA</td>
      <td class="gt_row gt_right">1.226</td>
      <td class="gt_row gt_right">1.095</td>
      <td class="gt_row gt_right">0.416</td>
      <td class="gt_row gt_right">1.984</td>
      <td class="gt_row gt_right">0.819</td>
      <td class="gt_row gt_right">1.118</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">C82126227</td>
      <td class="gt_row gt_right">NA</td>
      <td class="gt_row gt_right">0.665</td>
      <td class="gt_row gt_right">0.959</td>
      <td class="gt_row gt_right">1.702</td>
      <td class="gt_row gt_right">0.609</td>
      <td class="gt_row gt_right">0.861</td>
      <td class="gt_row gt_right">0.830</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">C82153425</td>
      <td class="gt_row gt_right">NA</td>
      <td class="gt_row gt_right">0.511</td>
      <td class="gt_row gt_right">2.577</td>
      <td class="gt_row gt_right">0.270</td>
      <td class="gt_row gt_right">4.154</td>
      <td class="gt_row gt_right">0.367</td>
      <td class="gt_row gt_right">1.941</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">C92113550</td>
      <td class="gt_row gt_right">NA</td>
      <td class="gt_row gt_right">2.162</td>
      <td class="gt_row gt_right">2.381</td>
      <td class="gt_row gt_right">0.438</td>
      <td class="gt_row gt_right">1.113</td>
      <td class="gt_row gt_right">0.871</td>
      <td class="gt_row gt_right">0.968</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">C92114080</td>
      <td class="gt_row gt_right">NA</td>
      <td class="gt_row gt_right">0.425</td>
      <td class="gt_row gt_right">0.829</td>
      <td class="gt_row gt_right">0.615</td>
      <td class="gt_row gt_right">2.079</td>
      <td class="gt_row gt_right">2.070</td>
      <td class="gt_row gt_right">2.066</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">C92114146</td>
      <td class="gt_row gt_right">NA</td>
      <td class="gt_row gt_right">0.046</td>
      <td class="gt_row gt_right">27.127</td>
      <td class="gt_row gt_right">0.733</td>
      <td class="gt_row gt_right">1.013</td>
      <td class="gt_row gt_right">1.172</td>
      <td class="gt_row gt_right">0.656</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">C92114618</td>
      <td class="gt_row gt_right">NA</td>
      <td class="gt_row gt_right">0.943</td>
      <td class="gt_row gt_right">0.774</td>
      <td class="gt_row gt_right">0.117</td>
      <td class="gt_row gt_right">8.789</td>
      <td class="gt_row gt_right">0.611</td>
      <td class="gt_row gt_right">1.029</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">C92119360</td>
      <td class="gt_row gt_right">NA</td>
      <td class="gt_row gt_right">1.135</td>
      <td class="gt_row gt_right">0.402</td>
      <td class="gt_row gt_right">1.993</td>
      <td class="gt_row gt_right">2.250</td>
      <td class="gt_row gt_right">0.550</td>
      <td class="gt_row gt_right">1.602</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">C92119431</td>
      <td class="gt_row gt_right">NA</td>
      <td class="gt_row gt_right">0.327</td>
      <td class="gt_row gt_right">1.000</td>
      <td class="gt_row gt_right">0.679</td>
      <td class="gt_row gt_right">1.145</td>
      <td class="gt_row gt_right">0.966</td>
      <td class="gt_row gt_right">2.167</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">C92119510</td>
      <td class="gt_row gt_right">NA</td>
      <td class="gt_row gt_right">0.784</td>
      <td class="gt_row gt_right">1.296</td>
      <td class="gt_row gt_right">2.494</td>
      <td class="gt_row gt_right">0.710</td>
      <td class="gt_row gt_right">0.035</td>
      <td class="gt_row gt_right">37.467</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">C92123466</td>
      <td class="gt_row gt_right">NA</td>
      <td class="gt_row gt_right">0.572</td>
      <td class="gt_row gt_right">1.990</td>
      <td class="gt_row gt_right">1.256</td>
      <td class="gt_row gt_right">0.957</td>
      <td class="gt_row gt_right">0.791</td>
      <td class="gt_row gt_right">0.749</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">C92180151</td>
      <td class="gt_row gt_right">NA</td>
      <td class="gt_row gt_right">0.176</td>
      <td class="gt_row gt_right">1.534</td>
      <td class="gt_row gt_right">0.625</td>
      <td class="gt_row gt_right">4.521</td>
      <td class="gt_row gt_right">0.139</td>
      <td class="gt_row gt_right">6.639</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">C92541519</td>
      <td class="gt_row gt_right">NA</td>
      <td class="gt_row gt_right">0.948</td>
      <td class="gt_row gt_right">1.923</td>
      <td class="gt_row gt_right">1.102</td>
      <td class="gt_row gt_right">0.656</td>
      <td class="gt_row gt_right">1.309</td>
      <td class="gt_row gt_right">0.684</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">C92544080</td>
      <td class="gt_row gt_right">NA</td>
      <td class="gt_row gt_right">0.849</td>
      <td class="gt_row gt_right">0.379</td>
      <td class="gt_row gt_right">2.763</td>
      <td class="gt_row gt_right">0.501</td>
      <td class="gt_row gt_right">1.349</td>
      <td class="gt_row gt_right">0.852</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">C92544094</td>
      <td class="gt_row gt_right">NA</td>
      <td class="gt_row gt_right">1.310</td>
      <td class="gt_row gt_right">0.654</td>
      <td class="gt_row gt_right">1.802</td>
      <td class="gt_row gt_right">0.199</td>
      <td class="gt_row gt_right">0.042</td>
      <td class="gt_row gt_right">121.750</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">C92553123</td>
      <td class="gt_row gt_right">NA</td>
      <td class="gt_row gt_right">0.910</td>
      <td class="gt_row gt_right">1.075</td>
      <td class="gt_row gt_right">0.394</td>
      <td class="gt_row gt_right">1.035</td>
      <td class="gt_row gt_right">0.678</td>
      <td class="gt_row gt_right">1.192</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">C92726995</td>
      <td class="gt_row gt_right">NA</td>
      <td class="gt_row gt_right">10.178</td>
      <td class="gt_row gt_right">0.948</td>
      <td class="gt_row gt_right">1.276</td>
      <td class="gt_row gt_right">0.617</td>
      <td class="gt_row gt_right">1.658</td>
      <td class="gt_row gt_right">0.848</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">D02116397</td>
      <td class="gt_row gt_right">NA</td>
      <td class="gt_row gt_right">0.417</td>
      <td class="gt_row gt_right">2.077</td>
      <td class="gt_row gt_right">1.174</td>
      <td class="gt_row gt_right">1.535</td>
      <td class="gt_row gt_right">0.447</td>
      <td class="gt_row gt_right">1.236</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">D02122956</td>
      <td class="gt_row gt_right">NA</td>
      <td class="gt_row gt_right">1.538</td>
      <td class="gt_row gt_right">0.053</td>
      <td class="gt_row gt_right">11.786</td>
      <td class="gt_row gt_right">0.155</td>
      <td class="gt_row gt_right">8.608</td>
      <td class="gt_row gt_right">0.936</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">D02125964</td>
      <td class="gt_row gt_right">NA</td>
      <td class="gt_row gt_right">3.619</td>
      <td class="gt_row gt_right">0.886</td>
      <td class="gt_row gt_right">1.215</td>
      <td class="gt_row gt_right">0.568</td>
      <td class="gt_row gt_right">0.796</td>
      <td class="gt_row gt_right">1.560</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">D02141047</td>
      <td class="gt_row gt_right">NA</td>
      <td class="gt_row gt_right">2.521</td>
      <td class="gt_row gt_right">0.764</td>
      <td class="gt_row gt_right">1.299</td>
      <td class="gt_row gt_right">0.650</td>
      <td class="gt_row gt_right">1.294</td>
      <td class="gt_row gt_right">1.063</td>
    </tr>
  </tbody>
  
  
</table></div>
</section></section>
<section>
<section id="データの可視化" class="title-slide slide level1">
<h1>データの可視化</h1>
<ul>
<li>データの理解を深めるために必須のスキルです</li>
<li>ggplot2の基礎を習得します</li>
</ul>
</section>
<section id="なぜデータを可視化するのか" class="slide level2">
<h2>なぜデータを可視化するのか</h2>
<ul>
<li>要約統計量のみではデータの理解が困難だからです</li>
<li>データ研磨においても、データ分析においても、データを可視化しながら作業を進めるのが一般的です</li>
</ul>
<div class="columns">
<div class="column" style="width:48%;">
<p>long_emp</p>
<pre><code># A tibble: 12,516 x 4
   企業コード year  従業員数 従業員数伸び率
   &lt;chr&gt;      &lt;chr&gt;    &lt;dbl&gt;          &lt;dbl&gt;
 1 B02111302  2012      1254         NA    
 2 B02111302  2013       768          0.612
 3 B02111302  2014      1242          1.62 
 4 B02111302  2015      1409          1.13 
 5 B02111302  2016       728          0.517
 6 B02111302  2017      1401          1.92 
 7 B02111302  2018      1096          0.782
 8 B02117802  2012        82         NA    
 9 B02117802  2013       376          4.58 
10 B02117802  2014       374          0.995
# ... with 12,506 more rows</code></pre>
</div><div class="column" style="width:2%;">

</div><div class="column" style="width:48%;">
<pre><code>    従業員数       従業員数伸び率   
 Min.   :    1.0   Min.   :  0.001  
 1st Qu.:  306.8   1st Qu.:  0.615  
 Median :  668.5   Median :  1.016  
 Mean   : 1821.8   Mean   :  2.544  
 3rd Qu.: 1488.8   3rd Qu.:  1.607  
 Max.   :90164.0   Max.   :358.000  
                   NA&#39;s   :1        </code></pre>
<p><img src="04_intermediate_2nd_half_files/figure-revealjs/unnamed-chunk-22-1.png" width="100%" style="display: block; margin: auto;" /></p>
</div>
</div>
</section>
<section id="どうやって可視化するのか" class="slide level2">
<h2>どうやって可視化するのか</h2>
<ul>
<li><p>データの可視化には<strong>ggplot2</strong>を使用します</p></li>
<li><p>ggplot2はtidyverseに含まれているパッケージの1つです</p>
<ul>
<li>なぜggplot“2”なのかは気にしないでください</li>
</ul></li>
<li><p>可視化に使用するデータは<strong>必ずタテ持ちデータ</strong>です</p></li>
<li><p>またggplotはレイヤー(層)構造で設計されています</p></li>
<li><p>まずは次頁ですべてのレイヤーをまとめて確認した後に、個々のレイヤーを順番に確認していきます</p></li>
<li><p>ここではlong_empを可視化していきます</p></li>
</ul>
</section>
<section id="layer_str" class="slide level2">
<h2>ggplotのレイヤー構造</h2>
<table>
<thead>
<tr class="header">
<th style="text-align: center;">レイヤー（関数）</th>
<th style="text-align: center;">指定するもの</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">ggplot</td>
<td style="text-align: center;">使用するデータ</td>
</tr>
<tr class="even">
<td style="text-align: center;">aes</td>
<td style="text-align: center;">x軸・y軸などの値やデータの色分けなど</td>
</tr>
<tr class="odd">
<td style="text-align: center;">geom_*</td>
<td style="text-align: center;">プロットの種類（geom_histogram, geom_pointなど）</td>
</tr>
<tr class="even">
<td style="text-align: center;">labs</td>
<td style="text-align: center;">軸名やタイトルなど</td>
</tr>
<tr class="odd">
<td style="text-align: center;">facet</td>
<td style="text-align: center;">データの比較分割</td>
</tr>
</tbody>
</table>
<div class="columns">
<div class="column" style="width:55%;">
<p>レイヤーは+で追加します</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(long_emp) <span class="sc">+</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> 従業員数伸び率) <span class="sc">+</span></span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>() <span class="sc">+</span></span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;年別の従業員数伸び率&quot;</span></span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="fu">vars</span>(year))</span></code></pre></div>
</div><div class="column" style="width:2%;">

</div><div class="column" style="width:42%;">
<p><br></p>
<p><img src="04_intermediate_2nd_half_files/figure-revealjs/unnamed-chunk-23-1.png" width="100%" style="display: block; margin: auto;" /></p>
</div>
</div>
</section>
<section id="dodai" class="slide level2">
<h2><strong>ggplot</strong>：土台作成</h2>
<ul>
<li>この段階ではもちろん何の可視化もしていません</li>
<li>ggplot関数にはまず描画に使用するデータを指定します（tab補完が効くようになるのでパイプを推奨）</li>
</ul>
<div class="columns">
<div class="column" style="width:48%;">
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>()</span></code></pre></div>
<p><img src="04_intermediate_2nd_half_files/figure-revealjs/ggplot-1.png" width="100%" style="display: block; margin: auto;" /></p>
</div><div class="column" style="width:2%;">

</div><div class="column" style="width:48%;">
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>long_emp <span class="sc">%&gt;%</span> </span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>()</span></code></pre></div>
<p><img src="04_intermediate_2nd_half_files/figure-revealjs/unnamed-chunk-24-1.png" width="100%" style="display: block; margin: auto;" /></p>
</div>
</div>
</section>
<section id="aesデータの情報を指定" class="slide level2">
<h2><strong>aes</strong>：データの情報を指定</h2>
<ul>
<li>aes関数で軸のデータを指定します</li>
<li>ggplot内に書くことを推奨します</li>
</ul>
<div class="columns">
<div class="column" style="width:48%;">
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>long_emp <span class="sc">%&gt;%</span> </span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> 従業員数伸び率)</span></code></pre></div>
<p><img src="04_intermediate_2nd_half_files/figure-revealjs/aes-1.png" width="100%" style="display: block; margin: auto;" /></p>
</div><div class="column" style="width:2%;">

</div><div class="column" style="width:48%;">
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>long_emp <span class="sc">%&gt;%</span> </span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> 従業員数伸び率))</span></code></pre></div>
<p><img src="04_intermediate_2nd_half_files/figure-revealjs/unnamed-chunk-25-1.png" width="100%" style="display: block; margin: auto;" /></p>
</div>
</div>
</section>
<section id="geom" class="slide level2">
<h2><strong>geom_＊</strong>：描画</h2>
<ul>
<li>ヒストグラムならgeom_histogramを使います</li>
<li>他にも以下のようなプロットを書くことができます
<ul>
<li>geom_point：散布図</li>
<li>geom_boxplot：ボックスプロット</li>
<li>geom_line：折れ線グラフ</li>
</ul></li>
</ul>
<div class="columns">
<div class="column" style="width:55%;">
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>long_emp <span class="sc">%&gt;%</span> </span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> 従業員数伸び率)) <span class="sc">+</span></span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>()</span></code></pre></div>
</div><div class="column" style="width:2%;">

</div><div class="column" style="width:42%;">
<p><img src="04_intermediate_2nd_half_files/figure-revealjs/unnamed-chunk-26-1.png" width="100%" style="display: block; margin: auto;" /></p>
</div>
</div>
</section>
<section id="labs軸名やタイトル" class="slide level2">
<h2><strong>labs</strong>：軸名やタイトル</h2>
<ul>
<li>labsで指定できるのは以下のようなものです
<ul>
<li>x：x軸の名前</li>
<li>y：y軸の名前</li>
<li>title：タイトル</li>
<li>caption：キャプション</li>
</ul></li>
<li>軸名やタイトルを付けることは可視化のルールです</li>
</ul>
<div class="columns">
<div class="column" style="width:55%;">
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>long_emp <span class="sc">%&gt;%</span> </span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> 従業員数伸び率)) <span class="sc">+</span></span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>() <span class="sc">+</span></span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;従業員数伸び率のヒストグラム&quot;</span></span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div>
</div><div class="column" style="width:2%;">

</div><div class="column" style="width:42%;">
<p><img src="04_intermediate_2nd_half_files/figure-revealjs/unnamed-chunk-27-1.png" width="100%" style="display: block; margin: auto;" /></p>
</div>
</div>
</section>
<section id="before_facet" class="slide level2">
<h2><strong>facet</strong>の前に</h2>
<ul>
<li>ここまで可視化してきたものは、2012年から2018年のデータを分け隔てなく一枚のプロットに描画していました</li>
<li>facetは年別などのグループ比較をするために使います</li>
</ul>
<div class="columns">
<div class="column" style="width:48%;">
<p>long_emp</p>
<pre><code># A tibble: 12,516 x 4
   企業コード year  従業員数 従業員数伸び率
   &lt;chr&gt;      &lt;chr&gt;    &lt;dbl&gt;          &lt;dbl&gt;
 1 B02111302  2012      1254         NA    
 2 B02111302  2013       768          0.612
 3 B02111302  2014      1242          1.62 
 4 B02111302  2015      1409          1.13 
 5 B02111302  2016       728          0.517
 6 B02111302  2017      1401          1.92 
 7 B02111302  2018      1096          0.782
 8 B02117802  2012        82         NA    
 9 B02117802  2013       376          4.58 
10 B02117802  2014       374          0.995
# ... with 12,506 more rows</code></pre>
</div><div class="column" style="width:2%;">

</div><div class="column" style="width:48%;">
<p><br></p>
<p><img src="04_intermediate_2nd_half_files/figure-revealjs/unnamed-chunk-28-1.png" width="100%" style="display: block; margin: auto;" /></p>
</div>
</div>
</section>
<section id="facet" class="slide level2">
<h2><strong>facet</strong>：グループ比較</h2>
<ul>
<li><strong>facet_wrap</strong>関数を使えばグループ比較ができます
<ul>
<li>グループ比較する変数を“vars(変数名)”の形で指定します</li>
</ul></li>
</ul>
<div class="columns">
<div class="column" style="width:55%;">
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>long_emp <span class="sc">%&gt;%</span> </span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> 従業員数伸び率)) <span class="sc">+</span></span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>() <span class="sc">+</span></span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;年別での従業員数伸び率&quot;</span>) <span class="sc">+</span></span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="fu">vars</span>(year))</span></code></pre></div>
</div><div class="column" style="width:2%;">

</div><div class="column" style="width:42%;">
<p><img src="04_intermediate_2nd_half_files/figure-revealjs/unnamed-chunk-29-1.png" width="100%" style="display: block; margin: auto;" /></p>
</div>
</div>
</section>
<section id="可視化のススメ" class="slide level2">
<h2>可視化のススメ</h2>
<ul>
<li>ggplot2による可視化の基礎は以上になります
<ul>
<li>ggplot2を使えば、こで紹介したもの以外にも多種多様なプロットをフレキシブルに作成することができます</li>
<li>データを可視化する力はデータ研磨力と並んでとても重要です</li>
<li>書籍で勉強したり、色々なデータで色々な可視化に挑戦することをお勧めします</li>
</ul></li>
<li>最後に、今回のlong_empの可視化についていくつか参考を載せておきます</li>
</ul>
</section>
<section id="kasika_sanko1" class="slide level2">
<h2>参考１：データの整形</h2>
<ul>
<li>先ほどのヒストグラムを見ると、データに異常に大きな値が含まれていることがわかります</li>
<li>データ整形後に、パイプで一気にggplot関数にデータを入れることは往々にしてあります
<ul>
<li>従業員数伸び率が3%以下のデータのみとしました</li>
<li>2012年の従業員数伸び率は全てNAなのでなくなりました</li>
</ul></li>
<li>plotをオブジェクトに保存後のレイヤー追加もできます</li>
</ul>
<div class="columns">
<div class="column" style="width:55%;">
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> long_emp <span class="sc">%&gt;%</span> </span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(従業員数伸び率 <span class="sc">&lt;</span> <span class="dv">3</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> 従業員数伸び率)) <span class="sc">+</span></span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>() <span class="sc">+</span></span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="fu">vars</span>(year))</span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;年別での従業員数伸び率&quot;</span>)</span></code></pre></div>
</div><div class="column" style="width:2%;">

</div><div class="column" style="width:42%;">
<p><img src="04_intermediate_2nd_half_files/figure-revealjs/unnamed-chunk-30-1.png" width="100%" style="display: block; margin: auto;" /></p>
</div>
</div>
</section>
<section id="kasika_sanko2" class="slide level2">
<h2>参考２：データの比較</h2>
<ul>
<li>facetでの比較も便利ですが、少数のグループであればカラーを分けて比較する方法もあります
<ul>
<li>たとえば2013年と2018年のデータだけで比較してみましょう</li>
<li>aes内のfill(あるいはcolor)にグループのカラムを指定します</li>
<li>alphaは色の濃さを指定しています</li>
</ul></li>
</ul>
<div class="columns">
<div class="column" style="width:55%;">
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>long_emp <span class="sc">%&gt;%</span> </span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(従業員数伸び率 <span class="sc">&lt;</span> <span class="dv">3</span>,</span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>         year <span class="sc">==</span> <span class="st">&quot;2013&quot;</span> <span class="sc">|</span></span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a>         year <span class="sc">==</span> <span class="st">&quot;2018&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> 従業員数伸び率,</span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a>             <span class="at">fill =</span> year)) <span class="sc">+</span></span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">alpha =</span> <span class="fl">0.4</span>) <span class="sc">+</span></span>
<span id="cb52-8"><a href="#cb52-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;2013年と2018年の従業員数伸び率比較&quot;</span>)</span></code></pre></div>
</div><div class="column" style="width:2%;">

</div><div class="column" style="width:42%;">
<p><img src="04_intermediate_2nd_half_files/figure-revealjs/unnamed-chunk-31-1.png" width="100%" style="display: block; margin: auto;" /></p>
</div>
</div>
</section>
<section id="kasika_sanko3" class="slide level2">
<h2>参考３：適切な可視化</h2>
<ul>
<li>データを可視化する方法に答えはありませんが、適切な可視化を模索するのは大切なプロセスです</li>
</ul>
<div class="columns">
<div class="column" style="width:55%;">
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> long_emp <span class="sc">%&gt;%</span> </span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(従業員数伸び率 <span class="sc">&lt;</span> <span class="dv">3</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> year, </span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a>             <span class="at">y =</span> 従業員数伸び率)) <span class="sc">+</span></span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;従業員数伸び率比較&quot;</span>)</span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a>P <span class="sc">+</span> <span class="fu">geom_boxplot</span>()</span>
<span id="cb53-7"><a href="#cb53-7" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">geom_violin</span>()</span>
<span id="cb53-8"><a href="#cb53-8" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> </span>
<span id="cb53-9"><a href="#cb53-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_violin</span>() <span class="sc">+</span> </span>
<span id="cb53-10"><a href="#cb53-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">alpha =</span> <span class="fl">0.1</span>)</span></code></pre></div>
</div><div class="column" style="width:2%;">

</div><div class="column" style="width:42%;">
<p><img src="04_intermediate_2nd_half_files/figure-revealjs/unnamed-chunk-32-1.png" width="100%" style="display: block; margin: auto;" /><img src="04_intermediate_2nd_half_files/figure-revealjs/unnamed-chunk-32-2.png" width="100%" style="display: block; margin: auto;" /><img src="04_intermediate_2nd_half_files/figure-revealjs/unnamed-chunk-32-3.png" width="100%" style="display: block; margin: auto;" /></p>
</div>
</div>
</section></section>
<section>
<section id="ランキングの作成" class="title-slide slide level1">
<h1>ランキングの作成</h1>
<ul>
<li>データから知見を得ましょう</li>
</ul>
</section>
<section id="rank_result" class="slide level2">
<h2>結果の確認</h2>
<ul>
<li>データを可視化してデータの概要は掴めました</li>
<li>次はデータから有益な情報を得るために、従業員数データであるlong_empからランキングを作成しましょう</li>
<li>ここでは業種別に従業員数伸び率ランキングを作成します</li>
</ul>
<pre><code># A tibble: 1,667 x 4
   企業コード 従業員数伸び率 業種大分類_2018  rank
   &lt;chr&gt;               &lt;dbl&gt; &lt;chr&gt;           &lt;int&gt;
 1 F62151343           4.22  A:農業              1
 2 J30067647           0.598 D:鉱業              1
 3 J34531369           0.41  D:鉱業              2
 4 J34080260           0.269 D:鉱業              3
 5 J34809061           0.189 D:鉱業              4
 6 J34787560          15.9   E:建設業            1
 7 F12124685           8.63  E:建設業            2
 8 J34599205           6.34  E:建設業            3
 9 F82182754           4.49  E:建設業            4
10 J34598664           3.52  E:建設業            5
# ... with 1,657 more rows</code></pre>
</section>
<section id="rank_tejun0" class="slide level2">
<h2>内容と手順</h2>
<ul>
<li>内容
<ul>
<li>従業員数データ(long_sales)を用いて、産業大分類ごとに、2018年の従業員数伸び率が高い順にランキングを付与します</li>
<li>ただし2017年の従業員数が100人以上の企業を対象とし、同着であった場合は順位を飛ばしてください</li>
</ul></li>
<li>手順
<ul>
<li><ol type="1">
<li>2017年の従業員数が100人以上の条件でデータを抽出する</li>
</ol></li>
<li><ol start="2" type="1">
<li>long_empに業種大分類_2018のデータがないので、data_listのdata_2018から業種大分類_2018を企業コードで紐づける</li>
</ol></li>
<li><ol start="3" type="1">
<li>業種でグループ化して2018年従業員数伸び率ランキングを付与する</li>
</ol></li>
</ul></li>
</ul>
<p>実施前に、次頁でランキング関数の説明をします。</p>
</section>
<section id="ランキング関数" class="slide level2">
<h2>ランキング関数</h2>
<ul>
<li>はじめにランキングを付与する関数を3つ説明します
<ul>
<li>numカラムの値に対してランキングを作成しています</li>
</ul></li>
</ul>
<div class="columns">
<div class="column" style="width:48%;">
<ul>
<li>row_number
<ul>
<li>同着は先に出たほうを優先</li>
</ul></li>
<li>min_rank
<ul>
<li>同着は同じ順位、gapあり</li>
</ul></li>
<li>dense_rank
<ul>
<li>同着は同じ順位、gapなし</li>
</ul></li>
<li>（補足）
<ul>
<li>昇順がデフォルト</li>
<li>降順はdescをかませる</li>
<li>d %&gt;% mutate(rank = min_rank(desc(num)))</li>
</ul></li>
</ul>
</div><div class="column" style="width:2%;">

</div><div class="column" style="width:48%;">
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

#wpmrjnufeo .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 22px;
  font-weight: normal;
  font-style: normal;
  background-color: #F4F7E2;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#wpmrjnufeo .gt_heading {
  background-color: #F4F7E2;
  text-align: center;
  border-bottom-color: #F4F7E2;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#wpmrjnufeo .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  border-bottom-color: #F4F7E2;
  border-bottom-width: 0;
}

#wpmrjnufeo .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 4px;
  border-top-color: #F4F7E2;
  border-top-width: 0;
}

#wpmrjnufeo .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#wpmrjnufeo .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#wpmrjnufeo .gt_col_heading {
  color: #333333;
  background-color: #F4F7E2;
  font-size: 22px;
  font-weight: bold;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#wpmrjnufeo .gt_column_spanner_outer {
  color: #333333;
  background-color: #F4F7E2;
  font-size: 22px;
  font-weight: bold;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#wpmrjnufeo .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#wpmrjnufeo .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#wpmrjnufeo .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#wpmrjnufeo .gt_group_heading {
  padding: 8px;
  color: #333333;
  background-color: #F4F7E2;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
}

#wpmrjnufeo .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #F4F7E2;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#wpmrjnufeo .gt_from_md > :first-child {
  margin-top: 0;
}

#wpmrjnufeo .gt_from_md > :last-child {
  margin-bottom: 0;
}

#wpmrjnufeo .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#wpmrjnufeo .gt_stub {
  color: #333333;
  background-color: #F4F7E2;
  font-size: 100%;
  font-weight: bold;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 12px;
}

#wpmrjnufeo .gt_summary_row {
  color: #333333;
  background-color: #F4F7E2;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#wpmrjnufeo .gt_first_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
}

#wpmrjnufeo .gt_grand_summary_row {
  color: #333333;
  background-color: #F4F7E2;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#wpmrjnufeo .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#wpmrjnufeo .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#wpmrjnufeo .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#wpmrjnufeo .gt_footnotes {
  color: #333333;
  background-color: #F4F7E2;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#wpmrjnufeo .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding: 4px;
}

#wpmrjnufeo .gt_sourcenotes {
  color: #333333;
  background-color: #F4F7E2;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#wpmrjnufeo .gt_sourcenote {
  font-size: 90%;
  padding: 4px;
}

#wpmrjnufeo .gt_left {
  text-align: left;
}

#wpmrjnufeo .gt_center {
  text-align: center;
}

#wpmrjnufeo .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#wpmrjnufeo .gt_font_normal {
  font-weight: normal;
}

#wpmrjnufeo .gt_font_bold {
  font-weight: bold;
}

#wpmrjnufeo .gt_font_italic {
  font-style: italic;
}

#wpmrjnufeo .gt_super {
  font-size: 65%;
}

#wpmrjnufeo .gt_footnote_marks {
  font-style: italic;
  font-size: 65%;
}
</style>
<div id="wpmrjnufeo" style="overflow-x:auto;overflow-y:auto;width:auto;height:600px;"><table class="gt_table">
  
  <thead class="gt_col_headings">
    <tr>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">num</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1">row_number</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1">min_rank</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1">dense_rank</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr>
      <td class="gt_row gt_right">100</td>
      <td class="gt_row gt_center">1</td>
      <td class="gt_row gt_center">1</td>
      <td class="gt_row gt_center">1</td>
    </tr>
    <tr>
      <td class="gt_row gt_right">200</td>
      <td class="gt_row gt_center">2</td>
      <td class="gt_row gt_center">2</td>
      <td class="gt_row gt_center">2</td>
    </tr>
    <tr>
      <td class="gt_row gt_right">200</td>
      <td class="gt_row gt_center">3</td>
      <td class="gt_row gt_center">2</td>
      <td class="gt_row gt_center">2</td>
    </tr>
    <tr>
      <td class="gt_row gt_right">300</td>
      <td class="gt_row gt_center">4</td>
      <td class="gt_row gt_center">4</td>
      <td class="gt_row gt_center">3</td>
    </tr>
    <tr>
      <td class="gt_row gt_right">400</td>
      <td class="gt_row gt_center">5</td>
      <td class="gt_row gt_center">5</td>
      <td class="gt_row gt_center">4</td>
    </tr>
    <tr>
      <td class="gt_row gt_right">400</td>
      <td class="gt_row gt_center">6</td>
      <td class="gt_row gt_center">5</td>
      <td class="gt_row gt_center">4</td>
    </tr>
    <tr>
      <td class="gt_row gt_right">400</td>
      <td class="gt_row gt_center">7</td>
      <td class="gt_row gt_center">5</td>
      <td class="gt_row gt_center">4</td>
    </tr>
    <tr>
      <td class="gt_row gt_right">500</td>
      <td class="gt_row gt_center">8</td>
      <td class="gt_row gt_center">8</td>
      <td class="gt_row gt_center">5</td>
    </tr>
  </tbody>
  
  
</table></div>
</div>
</div>
</section>
<section id="rank_tejun1" class="slide level2">
<h2>手順１：2017年の従業員数が100人以上</h2>
<ul>
<li>2017年の従業員数が100人以上という条件でfilterをかけると、2018年のデータも消えてしまいます</li>
</ul>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>long_emp <span class="sc">%&gt;%</span> </span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">==</span> <span class="st">&quot;2017&quot;</span>, 従業員数 <span class="sc">&gt;=</span> <span class="dv">100</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(year))</span></code></pre></div>
<pre><code># A tibble: 1,667 x 4
   企業コード year  従業員数 従業員数伸び率
   &lt;chr&gt;      &lt;chr&gt;    &lt;dbl&gt;          &lt;dbl&gt;
 1 B02111302  2017      1401          1.92 
 2 B02117802  2017       233          0.552
 3 B02122250  2017       523          1.76 
 4 B02122602  2017      7564          0.445
 5 B02125529  2017      2274          1.03 
 6 B02128716  2017       261          0.798
 7 B02129789  2017       645          0.591
 8 B02153443  2017      3960          1.10 
 9 B02505784  2017       902          1.81 
10 B02514384  2017       154          0.647
# ... with 1,657 more rows</code></pre>
</section>
<section class="slide level2">

<ul>
<li>先に条件を満たす企業コードを抽出し、その企業コードに対して売上高データをjoinさせる方法で対処します</li>
<li>条件抽出したデータをemp_growth_rank_2018とします</li>
</ul>
<div class="columns">
<div class="column" style="width:55%;">
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>emp_growth_rank_2018 <span class="ot">&lt;-</span></span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>  long_emp <span class="sc">%&gt;%</span></span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">==</span> <span class="st">&quot;2017&quot;</span>, </span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a>         従業員数 <span class="sc">&gt;=</span> <span class="dv">100</span>) <span class="sc">%&gt;%</span></span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(企業コード) <span class="sc">%&gt;%</span> </span>
<span id="cb57-6"><a href="#cb57-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(long_emp,</span>
<span id="cb57-7"><a href="#cb57-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">by =</span> <span class="st">&quot;企業コード&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb57-8"><a href="#cb57-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 以降は2018年のデータのみでよい</span></span>
<span id="cb57-9"><a href="#cb57-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">==</span> <span class="st">&quot;2018&quot;</span>)</span></code></pre></div>
</div><div class="column" style="width:2%;">

</div><div class="column" style="width:41%;">
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>emp_growth_rank_2018</span></code></pre></div>
<pre><code># A tibble: 1,667 x 4
   企業コード year  従業員数 従業員数伸び率
   &lt;chr&gt;      &lt;chr&gt;    &lt;dbl&gt;          &lt;dbl&gt;
 1 B02111302  2018      1096          0.782
 2 B02117802  2018       173          0.742
 3 B02122250  2018       695          1.33 
 4 B02122602  2018     12493          1.65 
 5 B02125529  2018      2472          1.09 
 6 B02128716  2018       376          1.44 
 7 B02129789  2018       986          1.53 
 8 B02153443  2018      5563          1.40 
 9 B02505784  2018       728          0.807
10 B02514384  2018       324          2.10 
# ... with 1,657 more rows</code></pre>
</div>
</div>
</section>
<section id="rank_tejun2" class="slide level2">
<h2>手順２：業種大分類をjoin</h2>
<ul>
<li>業種大分類はdata_2018とjoinすることで付与します</li>
</ul>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>emp_growth_rank_2018 <span class="ot">&lt;-</span> emp_growth_rank_2018 <span class="sc">%&gt;%</span> </span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(data_list<span class="sc">$</span>data_2018 <span class="sc">%&gt;%</span></span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a>              <span class="fu">select</span>(<span class="st">&quot;企業コード&quot;</span>, <span class="fu">contains</span>(<span class="st">&quot;業種大分類&quot;</span>)),</span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">by =</span> <span class="st">&quot;企業コード&quot;</span>)</span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a>emp_growth_rank_2018 <span class="sc">%&gt;%</span> </span>
<span id="cb60-6"><a href="#cb60-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(<span class="st">&quot;企業コード&quot;</span>, <span class="fu">contains</span>(<span class="st">&quot;業種大分類&quot;</span>))</span></code></pre></div>
<pre><code># A tibble: 1,667 x 5
   企業コード 業種大分類_2018      year  従業員数 従業員数伸び率
   &lt;chr&gt;      &lt;chr&gt;                &lt;chr&gt;    &lt;dbl&gt;          &lt;dbl&gt;
 1 B02111302  F:製造業             2018      1096          0.782
 2 B02117802  G:卸売・小売業，飲食 2018       173          0.742
 3 B02122250  F:製造業             2018       695          1.33 
 4 B02122602  J:運輸・通信業       2018     12493          1.65 
 5 B02125529  F:製造業             2018      2472          1.09 
 6 B02128716  F:製造業             2018       376          1.44 
 7 B02129789  G:卸売・小売業，飲食 2018       986          1.53 
 8 B02153443  G:卸売・小売業，飲食 2018      5563          1.40 
 9 B02505784  F:製造業             2018       728          0.807
10 B02514384  F:製造業             2018       324          2.10 
# ... with 1,657 more rows</code></pre>
</section>
<section id="rank_tejun3" class="slide level2">
<h2>手順３：業種別ランキング作成</h2>
<ul>
<li>業種ごとに従業員数伸び率のランキングを付与します</li>
<li>同着後は飛ばす必要がある(gapあり)ランキングなのでminn_rank関数を使用し、descで降順にrankをつけます</li>
<li>業種とrankでソートし、不要なカラムを消去します</li>
</ul>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>emp_growth_rank_2018 <span class="ot">&lt;-</span></span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>  emp_growth_rank_2018 <span class="sc">%&gt;%</span> </span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(業種大分類_2018) <span class="sc">%&gt;%</span> </span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">rank =</span> <span class="fu">min_rank</span>(<span class="fu">desc</span>(従業員数伸び率))) <span class="sc">%&gt;%</span> </span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(業種大分類_2018, rank) <span class="sc">%&gt;%</span> </span>
<span id="cb62-6"><a href="#cb62-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>従業員数, <span class="sc">-</span>year) <span class="sc">%&gt;%</span> </span>
<span id="cb62-7"><a href="#cb62-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span></code></pre></div>
</section>
<section id="kekka_ranking" class="slide level2">
<h2>ランキングデータ完成</h2>
<ul>
<li>2017年の従業員数が100人以上の企業で、業種ごとに従業員数伸び率ランキングを作成したデータが完成しました</li>
</ul>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>emp_growth_rank_2018</span></code></pre></div>
<pre><code># A tibble: 1,667 x 4
   企業コード 従業員数伸び率 業種大分類_2018  rank
   &lt;chr&gt;               &lt;dbl&gt; &lt;chr&gt;           &lt;int&gt;
 1 F62151343           4.22  A:農業              1
 2 J30067647           0.598 D:鉱業              1
 3 J34531369           0.41  D:鉱業              2
 4 J34080260           0.269 D:鉱業              3
 5 J34809061           0.189 D:鉱業              4
 6 J34787560          15.9   E:建設業            1
 7 F12124685           8.63  E:建設業            2
 8 J34599205           6.34  E:建設業            3
 9 F82182754           4.49  E:建設業            4
10 J34598664           3.52  E:建設業            5
# ... with 1,657 more rows</code></pre>
</section>
<section id="rank_tejun4" class="slide level2">
<h2>ランキング作成まとめ</h2>
<p>手順１から手順３のコードをまとめたものです。</p>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 2017年の従業員数が100人以上のデータを抽出</span></span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>emp_growth_rank_2018 <span class="ot">&lt;-</span></span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a>  long_emp <span class="sc">%&gt;%</span> <span class="fu">filter</span>(year <span class="sc">==</span> <span class="st">&quot;2017&quot;</span>, 従業員数 <span class="sc">&gt;=</span> <span class="dv">100</span>) <span class="sc">%&gt;%</span></span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(企業コード) <span class="sc">%&gt;%</span> </span>
<span id="cb65-5"><a href="#cb65-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(long_emp, <span class="at">by =</span> <span class="st">&quot;企業コード&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb65-6"><a href="#cb65-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">==</span> <span class="st">&quot;2018&quot;</span>)</span>
<span id="cb65-7"><a href="#cb65-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-8"><a href="#cb65-8" aria-hidden="true" tabindex="-1"></a><span class="co"># 業種大分類を付与</span></span>
<span id="cb65-9"><a href="#cb65-9" aria-hidden="true" tabindex="-1"></a>emp_growth_rank_2018 <span class="ot">&lt;-</span> </span>
<span id="cb65-10"><a href="#cb65-10" aria-hidden="true" tabindex="-1"></a>  emp_growth_rank_2018 <span class="sc">%&gt;%</span> </span>
<span id="cb65-11"><a href="#cb65-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(data_list<span class="sc">$</span>data_2018 <span class="sc">%&gt;%</span></span>
<span id="cb65-12"><a href="#cb65-12" aria-hidden="true" tabindex="-1"></a>              <span class="fu">select</span>(<span class="st">&quot;企業コード&quot;</span>, <span class="fu">contains</span>(<span class="st">&quot;業種大分類&quot;</span>)),</span>
<span id="cb65-13"><a href="#cb65-13" aria-hidden="true" tabindex="-1"></a>            <span class="at">by =</span> <span class="st">&quot;企業コード&quot;</span>)</span>
<span id="cb65-14"><a href="#cb65-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-15"><a href="#cb65-15" aria-hidden="true" tabindex="-1"></a><span class="co"># 業種ごとにランキングを作成してデータを整形</span></span>
<span id="cb65-16"><a href="#cb65-16" aria-hidden="true" tabindex="-1"></a>emp_growth_rank_2018 <span class="ot">&lt;-</span></span>
<span id="cb65-17"><a href="#cb65-17" aria-hidden="true" tabindex="-1"></a>  emp_growth_rank_2018 <span class="sc">%&gt;%</span> </span>
<span id="cb65-18"><a href="#cb65-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(業種大分類_2018) <span class="sc">%&gt;%</span> </span>
<span id="cb65-19"><a href="#cb65-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">rank =</span> <span class="fu">min_rank</span>(<span class="fu">desc</span>(従業員数伸び率))) <span class="sc">%&gt;%</span> </span>
<span id="cb65-20"><a href="#cb65-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(業種大分類_2018, rank) <span class="sc">%&gt;%</span> </span>
<span id="cb65-21"><a href="#cb65-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>従業員数, <span class="sc">-</span>year) <span class="sc">%&gt;%</span> </span>
<span id="cb65-22"><a href="#cb65-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span></code></pre></div>
</section></section>
<section id="おわり" class="title-slide slide level1 unnumbered">
<h1 class="unnumbered">おわり</h1>
<p>中級編は以上になります。お疲れさまでした。</p>
</section>
    </div>
  </div>

  <script src="04_intermediate_2nd_half_files/reveal.js-3.3.0.1/lib/js/head.min.js"></script>
  <script src="04_intermediate_2nd_half_files/reveal.js-3.3.0.1/js/reveal.js"></script>

  <script>

      // Full list of configuration options available at:
      // https://github.com/hakimel/reveal.js#configuration
      Reveal.initialize({
        // Display the page number of the current slide
        slideNumber: 'c/t',
        // Push each slide change to the browser history
        history: true,
        // Vertical centering of slides
        center: false,
        // Enable slide navigation via mouse wheel
        mouseWheel: false,
        // Transition style
        transition: 'slide', // none/fade/slide/convex/concave/zoom
        // Transition style for full page slide backgrounds
        backgroundTransition: 'slide', // none/fade/slide/convex/concave/zoom

        menu: {
   
    
    
    
    
    
    
 
          custom: false,
          themes: false,
          transitions: false
        },



        chalkboard: {
        },

        keyboard: {
          67: function() { RevealChalkboard.toggleNotesCanvas() },    // toggle notes canvas when 'c' is pressed
          66: function() { RevealChalkboard.toggleChalkboard() }, // toggle chalkboard when 'b' is pressed
          46: function() { RevealChalkboard.clear() },    // clear chalkboard when 'DEL' is pressed
           8: function() { RevealChalkboard.reset() },    // reset chalkboard data on current slide when 'BACKSPACE' is pressed
          68: function() { RevealChalkboard.download() }, // downlad recorded chalkboard drawing when 'd' is pressed
        },

        // Optional reveal.js plugins
        dependencies: [
          { src: '04_intermediate_2nd_half_files/reveal.js-3.3.0.1/plugin/search/search.js', async: true },
          { src: '04_intermediate_2nd_half_files/reveal.js-3.3.0.1/plugin/chalkboard/chalkboard.js', async: true },
          { src: '04_intermediate_2nd_half_files/reveal.js-3.3.0.1/plugin/menu/menu.js', async: true },
        ]
      });
    </script>
  <!-- dynamically load mathjax for compatibility with self-contained -->
  <script>
    (function () {
      var script = document.createElement("script");
      script.type = "text/javascript";
      script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
      document.getElementsByTagName("head")[0].appendChild(script);
    })();
  </script>

<script>
  (function() {
    if (window.jQuery) {
      Reveal.addEventListener( 'slidechanged', function(event) {  
        window.jQuery(event.previousSlide).trigger('hidden');
        window.jQuery(event.currentSlide).trigger('shown');
      });
    }
  })();
</script>


  </body>
</html>
