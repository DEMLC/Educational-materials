<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>3 初級編後半 | データエンジニアリング人材養成演習補助教材</title>
  <meta name="description" content="本ページは、滋賀大学の集中講義「データエンジニアリング人材養成演習」の補助教材です。" />
  <meta name="generator" content="bookdown 0.21.6 and GitBook 2.6.7" />

  <meta property="og:title" content="3 初級編後半 | データエンジニアリング人材養成演習補助教材" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="本ページは、滋賀大学の集中講義「データエンジニアリング人材養成演習」の補助教材です。" />
  <meta name="github-repo" content="DEMLC/Educational-materials" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="3 初級編後半 | データエンジニアリング人材養成演習補助教材" />
  
  <meta name="twitter:description" content="本ページは、滋賀大学の集中講義「データエンジニアリング人材養成演習」の補助教材です。" />
  

<meta name="author" content="滋賀大学DEMLセンター" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="book_01_beginner_1st_half.html"/>
<link rel="next" href="book_03_intermediate_1st_half.html"/>
<script src="libs/header-attrs-2.6/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><strong><a href="https://demlc.github.io/Educational-materials/">DE人材養成演習補助教材</a></strong></li>
<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>はじめに</a></li>
<li class="chapter" data-level="1" data-path="book_00_introduction.html"><a href="book_00_introduction.html"><i class="fa fa-check"></i><b>1</b> 導入編</a>
<ul>
<li class="chapter" data-level="1.1" data-path="book_00_introduction.html"><a href="book_00_introduction.html#本資料について"><i class="fa fa-check"></i><b>1.1</b> 本資料について</a>
<ul>
<li class="chapter" data-level="1.1.1" data-path="book_00_introduction.html"><a href="book_00_introduction.html#対象読者"><i class="fa fa-check"></i><b>1.1.1</b> 対象読者</a></li>
<li class="chapter" data-level="1.1.2" data-path="book_00_introduction.html"><a href="book_00_introduction.html#目的"><i class="fa fa-check"></i><b>1.1.2</b> 目的</a></li>
<li class="chapter" data-level="1.1.3" data-path="book_00_introduction.html"><a href="book_00_introduction.html#構成"><i class="fa fa-check"></i><b>1.1.3</b> 構成</a></li>
<li class="chapter" data-level="1.1.4" data-path="book_00_introduction.html"><a href="book_00_introduction.html#到達目標"><i class="fa fa-check"></i><b>1.1.4</b> 到達目標</a></li>
<li class="chapter" data-level="1.1.5" data-path="book_00_introduction.html"><a href="book_00_introduction.html#導入編の内容"><i class="fa fa-check"></i><b>1.1.5</b> 導入編の内容</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="book_00_introduction.html"><a href="book_00_introduction.html#tidyverse"><i class="fa fa-check"></i><b>1.2</b> tidyverse</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="book_00_introduction.html"><a href="book_00_introduction.html#what_tidyverse"><i class="fa fa-check"></i><b>1.2.1</b> tidyverseとは</a></li>
<li class="chapter" data-level="1.2.2" data-path="book_00_introduction.html"><a href="book_00_introduction.html#why_tidyverse"><i class="fa fa-check"></i><b>1.2.2</b> なぜtidyverseを使うのか</a></li>
<li class="chapter" data-level="1.2.3" data-path="book_00_introduction.html"><a href="book_00_introduction.html#install_tidyverse"><i class="fa fa-check"></i><b>1.2.3</b> tidyverseのインストールと読込</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="book_00_introduction.html"><a href="book_00_introduction.html#tibble"><i class="fa fa-check"></i><b>1.3</b> tibble</a>
<ul>
<li class="chapter" data-level="1.3.1" data-path="book_00_introduction.html"><a href="book_00_introduction.html#about_tibble"><i class="fa fa-check"></i><b>1.3.1</b> tibbleとは</a></li>
<li class="chapter" data-level="1.3.2" data-path="book_00_introduction.html"><a href="book_00_introduction.html#コンソール表示の比較"><i class="fa fa-check"></i><b>1.3.2</b> コンソール表示の比較</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="book_00_introduction.html"><a href="book_00_introduction.html#パイプ演算子"><i class="fa fa-check"></i><b>1.4</b> パイプ演算子 %&gt;%</a>
<ul>
<li class="chapter" data-level="1.4.1" data-path="book_00_introduction.html"><a href="book_00_introduction.html#what_pipe"><i class="fa fa-check"></i><b>1.4.1</b> パイプ演算子とは</a></li>
<li class="chapter" data-level="1.4.2" data-path="book_00_introduction.html"><a href="book_00_introduction.html#pipemerit"><i class="fa fa-check"></i><b>1.4.2</b> パイプ演算子のメリット</a></li>
<li class="chapter" data-level="1.4.3" data-path="book_00_introduction.html"><a href="book_00_introduction.html#pipe_sanko"><i class="fa fa-check"></i><b>1.4.3</b> 参考</a></li>
</ul></li>
<li class="chapter" data-level="1.5" data-path="book_00_introduction.html"><a href="book_00_introduction.html#プロジェクト"><i class="fa fa-check"></i><b>1.5</b> プロジェクト</a>
<ul>
<li class="chapter" data-level="1.5.1" data-path="book_00_introduction.html"><a href="book_00_introduction.html#プロジェクトとは"><i class="fa fa-check"></i><b>1.5.1</b> プロジェクトとは</a></li>
<li class="chapter" data-level="1.5.2" data-path="book_00_introduction.html"><a href="book_00_introduction.html#Rproject"><i class="fa fa-check"></i><b>1.5.2</b> R project</a></li>
<li class="chapter" data-level="1.5.3" data-path="book_00_introduction.html"><a href="book_00_introduction.html#Rproject_create"><i class="fa fa-check"></i><b>1.5.3</b> R projectの作成</a></li>
<li class="chapter" data-level="1.5.4" data-path="book_00_introduction.html"><a href="book_00_introduction.html#Rproject_pros"><i class="fa fa-check"></i><b>1.5.4</b> R projectの利点</a></li>
</ul></li>
<li class="chapter" data-level="1.6" data-path="book_00_introduction.html"><a href="book_00_introduction.html#ディレクトリフォルダ構成"><i class="fa fa-check"></i><b>1.6</b> ディレクトリ(フォルダ)構成</a>
<ul>
<li class="chapter" data-level="1.6.1" data-path="book_00_introduction.html"><a href="book_00_introduction.html#ディレクトリ構成とは"><i class="fa fa-check"></i><b>1.6.1</b> ディレクトリ構成とは</a></li>
<li class="chapter" data-level="1.6.2" data-path="book_00_introduction.html"><a href="book_00_introduction.html#demo_dirのディレクトリ構成詳細"><i class="fa fa-check"></i><b>1.6.2</b> <strong>demo_dir</strong>のディレクトリ構成詳細</a></li>
<li class="chapter" data-level="1.6.3" data-path="book_00_introduction.html"><a href="book_00_introduction.html#ディレクトリ構成を定義するメリット"><i class="fa fa-check"></i><b>1.6.3</b> ディレクトリ構成を定義するメリット</a></li>
<li class="chapter" data-level="1.6.4" data-path="book_00_introduction.html"><a href="book_00_introduction.html#ディレクトリ構成の事例"><i class="fa fa-check"></i><b>1.6.4</b> ディレクトリ構成の事例</a></li>
</ul></li>
<li class="chapter" data-level="1.7" data-path="book_00_introduction.html"><a href="book_00_introduction.html#here"><i class="fa fa-check"></i><b>1.7</b> here</a>
<ul>
<li class="chapter" data-level="1.7.1" data-path="book_00_introduction.html"><a href="book_00_introduction.html#whats_here"><i class="fa fa-check"></i><b>1.7.1</b> hereパッケージとは</a></li>
<li class="chapter" data-level="1.7.2" data-path="book_00_introduction.html"><a href="book_00_introduction.html#path_problem"><i class="fa fa-check"></i><b>1.7.2</b> pathの悩みの具体例</a></li>
<li class="chapter" data-level="1.7.3" data-path="book_00_introduction.html"><a href="book_00_introduction.html#solve_path_problem"><i class="fa fa-check"></i><b>1.7.3</b> hereによる悩みの解消</a></li>
<li class="chapter" data-level="1.7.4" data-path="book_00_introduction.html"><a href="book_00_introduction.html#悩み事例の視覚的説明"><i class="fa fa-check"></i><b>1.7.4</b> 悩み事例の視覚的説明</a></li>
<li class="chapter" data-level="1.7.5" data-path="book_00_introduction.html"><a href="book_00_introduction.html#OS_ploblem"><i class="fa fa-check"></i><b>1.7.5</b> 異なるOS/個人間によるpath相違の解消</a></li>
<li class="chapter" data-level="1.7.6" data-path="book_00_introduction.html"><a href="book_00_introduction.html#solve_os_ploblem"><i class="fa fa-check"></i><b>1.7.6</b> hereを使ったpath</a></li>
<li class="chapter" data-level="1.7.7" data-path="book_00_introduction.html"><a href="book_00_introduction.html#how_here"><i class="fa fa-check"></i><b>1.7.7</b> hereの使い方</a></li>
</ul></li>
<li class="chapter" data-level="1.8" data-path="book_00_introduction.html"><a href="book_00_introduction.html#helpファイルの開き方"><i class="fa fa-check"></i><b>1.8</b> helpファイルの開き方</a>
<ul>
<li class="chapter" data-level="1.8.1" data-path="book_00_introduction.html"><a href="book_00_introduction.html#コードが動かないときの対処法"><i class="fa fa-check"></i><b>1.8.1</b> コードが動かないときの対処法</a></li>
<li class="chapter" data-level="1.8.2" data-path="book_00_introduction.html"><a href="book_00_introduction.html#help_open"><i class="fa fa-check"></i><b>1.8.2</b> “？関数名”でhelp</a></li>
</ul></li>
<li class="chapter" data-level="1.9" data-path="book_00_introduction.html"><a href="book_00_introduction.html#クォーテーションの使いわけ"><i class="fa fa-check"></i><b>1.9</b> クォーテーションの使いわけ</a>
<ul>
<li class="chapter" data-level="1.9.1" data-path="book_00_introduction.html"><a href="book_00_introduction.html#クォートを使うとき"><i class="fa fa-check"></i><b>1.9.1</b> クォートを使うとき</a></li>
<li class="chapter" data-level="1.9.2" data-path="book_00_introduction.html"><a href="book_00_introduction.html#ダブルクォートシングルクォート"><i class="fa fa-check"></i><b>1.9.2</b> ダブルクォート・シングルクォート</a></li>
<li class="chapter" data-level="1.9.3" data-path="book_00_introduction.html"><a href="book_00_introduction.html#バッククォート"><i class="fa fa-check"></i><b>1.9.3</b> バッククォート</a></li>
<li class="chapter" data-level="1.9.4" data-path="book_00_introduction.html"><a href="book_00_introduction.html#括弧つきカラムの参照"><i class="fa fa-check"></i><b>1.9.4</b> 括弧つきカラムの参照</a></li>
<li class="chapter" data-level="1.9.5" data-path="book_00_introduction.html"><a href="book_00_introduction.html#非標準文字列は必ずバッククォートを使用"><i class="fa fa-check"></i><b>1.9.5</b> 非標準文字列は必ずバッククォートを使用</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="book_00_introduction.html"><a href="book_00_introduction.html#おわり"><i class="fa fa-check"></i>おわり</a>
<ul>
<li class="chapter" data-level="" data-path="book_00_introduction.html"><a href="book_00_introduction.html#著者"><i class="fa fa-check"></i>著者</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="book_01_beginner_1st_half.html"><a href="book_01_beginner_1st_half.html"><i class="fa fa-check"></i><b>2</b> 初級編前半</a>
<ul>
<li class="chapter" data-level="" data-path="book_01_beginner_1st_half.html"><a href="book_01_beginner_1st_half.html#はじめに-1"><i class="fa fa-check"></i>はじめに</a>
<ul>
<li class="chapter" data-level="" data-path="book_01_beginner_1st_half.html"><a href="book_01_beginner_1st_half.html#研磨ストーリー"><i class="fa fa-check"></i>研磨ストーリー</a></li>
<li class="chapter" data-level="" data-path="book_01_beginner_1st_half.html"><a href="book_01_beginner_1st_half.html#作業イメージ"><i class="fa fa-check"></i>作業イメージ</a></li>
<li class="chapter" data-level="" data-path="book_01_beginner_1st_half.html"><a href="book_01_beginner_1st_half.html#ディレクトリ構成"><i class="fa fa-check"></i>ディレクトリ構成</a></li>
<li class="chapter" data-level="" data-path="book_01_beginner_1st_half.html"><a href="book_01_beginner_1st_half.html#ライブラリを読み込む"><i class="fa fa-check"></i>ライブラリを読み込む</a></li>
</ul></li>
<li class="chapter" data-level="2.1" data-path="book_01_beginner_1st_half.html"><a href="book_01_beginner_1st_half.html#ステップ１csvファイルの読み込み"><i class="fa fa-check"></i><b>2.1</b> ステップ１：CSVファイルの読み込み</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="book_01_beginner_1st_half.html"><a href="book_01_beginner_1st_half.html#sagyou_step1"><i class="fa fa-check"></i><b>2.1.1</b> 作業内容</a></li>
<li class="chapter" data-level="2.1.2" data-path="book_01_beginner_1st_half.html"><a href="book_01_beginner_1st_half.html#read_csv"><i class="fa fa-check"></i><b>2.1.2</b> <strong>read_csv</strong>でcsvデータを読み込む</a></li>
<li class="chapter" data-level="2.1.3" data-path="book_01_beginner_1st_half.html"><a href="book_01_beginner_1st_half.html#read_csv_args"><i class="fa fa-check"></i><b>2.1.3</b> read_csvの主要な引数</a></li>
<li class="chapter" data-level="2.1.4" data-path="book_01_beginner_1st_half.html"><a href="book_01_beginner_1st_half.html#col_typesの書き方"><i class="fa fa-check"></i><b>2.1.4</b> col_typesの書き方</a></li>
<li class="chapter" data-level="2.1.5" data-path="book_01_beginner_1st_half.html"><a href="book_01_beginner_1st_half.html#read_cosmos2"><i class="fa fa-check"></i><b>2.1.5</b> COSMOS2（c2）データの読み込み</a></li>
<li class="chapter" data-level="2.1.6" data-path="book_01_beginner_1st_half.html"><a href="book_01_beginner_1st_half.html#glimpse"><i class="fa fa-check"></i><b>2.1.6</b> <strong>glimpse</strong>でデータを見る</a></li>
<li class="chapter" data-level="2.1.7" data-path="book_01_beginner_1st_half.html"><a href="book_01_beginner_1st_half.html#読み込み時に注意すべき例０落ち"><i class="fa fa-check"></i><b>2.1.7</b> 読み込み時に注意すべき例：０落ち</a></li>
<li class="chapter" data-level="2.1.8" data-path="book_01_beginner_1st_half.html"><a href="book_01_beginner_1st_half.html#生データの確認方法"><i class="fa fa-check"></i><b>2.1.8</b> 生データの確認方法</a></li>
<li class="chapter" data-level="2.1.9" data-path="book_01_beginner_1st_half.html"><a href="book_01_beginner_1st_half.html#step1_sanko1"><i class="fa fa-check"></i><b>2.1.9</b> 参考１：カラム型指定tips</a></li>
<li class="chapter" data-level="2.1.10" data-path="book_01_beginner_1st_half.html"><a href="book_01_beginner_1st_half.html#step1_sanko2"><i class="fa fa-check"></i><b>2.1.10</b> 参考２：()付きカラムの取り扱い</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="book_01_beginner_1st_half.html"><a href="book_01_beginner_1st_half.html#ステップ２データの縦結合"><i class="fa fa-check"></i><b>2.2</b> ステップ２：データの縦結合</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="book_01_beginner_1st_half.html"><a href="book_01_beginner_1st_half.html#sagyou_step2"><i class="fa fa-check"></i><b>2.2.1</b> 作業内容</a></li>
<li class="chapter" data-level="2.2.2" data-path="book_01_beginner_1st_half.html"><a href="book_01_beginner_1st_half.html#bind_rowsでデータの縦行結合"><i class="fa fa-check"></i><b>2.2.2</b> <strong>bind_rows</strong>でデータの縦(行)結合</a></li>
<li class="chapter" data-level="2.2.3" data-path="book_01_beginner_1st_half.html"><a href="book_01_beginner_1st_half.html#参考１３つ以上のデータの縦結合"><i class="fa fa-check"></i><b>2.2.3</b> 参考１：３つ以上のデータの縦結合</a></li>
<li class="chapter" data-level="2.2.4" data-path="book_01_beginner_1st_half.html"><a href="book_01_beginner_1st_half.html#参考２カラム名不一致データの縦結合"><i class="fa fa-check"></i><b>2.2.4</b> 参考２：カラム名不一致データの縦結合</a></li>
<li class="chapter" data-level="2.2.5" data-path="book_01_beginner_1st_half.html"><a href="book_01_beginner_1st_half.html#参考３データの横列結合"><i class="fa fa-check"></i><b>2.2.5</b> 参考３：データの横（列）結合</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="book_01_beginner_1st_half.html"><a href="book_01_beginner_1st_half.html#ステップ３レコードの重複消去"><i class="fa fa-check"></i><b>2.3</b> ステップ３：レコードの重複消去</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="book_01_beginner_1st_half.html"><a href="book_01_beginner_1st_half.html#sagyou_step3"><i class="fa fa-check"></i><b>2.3.1</b> 作業内容</a></li>
<li class="chapter" data-level="2.3.2" data-path="book_01_beginner_1st_half.html"><a href="book_01_beginner_1st_half.html#n_distinct"><i class="fa fa-check"></i><b>2.3.2</b> <strong>n_distinct</strong>で重複があるか調べる</a></li>
<li class="chapter" data-level="2.3.3" data-path="book_01_beginner_1st_half.html"><a href="book_01_beginner_1st_half.html#distinctで重複レコードの消去"><i class="fa fa-check"></i><b>2.3.3</b> <strong>distinct</strong>で重複レコードの消去</a></li>
<li class="chapter" data-level="2.3.4" data-path="book_01_beginner_1st_half.html"><a href="book_01_beginner_1st_half.html#企業コードの重複確認と重複消去"><i class="fa fa-check"></i><b>2.3.4</b> 企業コードの重複確認と重複消去</a></li>
<li class="chapter" data-level="2.3.5" data-path="book_01_beginner_1st_half.html"><a href="book_01_beginner_1st_half.html#step3_sanko1"><i class="fa fa-check"></i><b>2.3.5</b> 参考１：複数カラムデータの重複消去</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="book_01_beginner_1st_half.html"><a href="book_01_beginner_1st_half.html#ステップ４カラムの選択"><i class="fa fa-check"></i><b>2.4</b> ステップ４：カラムの選択</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="book_01_beginner_1st_half.html"><a href="book_01_beginner_1st_half.html#sagyou_step4"><i class="fa fa-check"></i><b>2.4.1</b> 作業内容</a></li>
<li class="chapter" data-level="2.4.2" data-path="book_01_beginner_1st_half.html"><a href="book_01_beginner_1st_half.html#必要なカラム"><i class="fa fa-check"></i><b>2.4.2</b> 必要なカラム</a></li>
<li class="chapter" data-level="2.4.3" data-path="book_01_beginner_1st_half.html"><a href="book_01_beginner_1st_half.html#selectでカラムの選択"><i class="fa fa-check"></i><b>2.4.3</b> <strong>select</strong>でカラムの選択</a></li>
<li class="chapter" data-level="2.4.4" data-path="book_01_beginner_1st_half.html"><a href="book_01_beginner_1st_half.html#step4_sanko1"><i class="fa fa-check"></i><b>2.4.4</b> 参考１：不要な読み込みはしない</a></li>
<li class="chapter" data-level="2.4.5" data-path="book_01_beginner_1st_half.html"><a href="book_01_beginner_1st_half.html#step4_sanko2"><i class="fa fa-check"></i><b>2.4.5</b> 参考２：ベクトルで変数の選択</a></li>
<li class="chapter" data-level="2.4.6" data-path="book_01_beginner_1st_half.html"><a href="book_01_beginner_1st_half.html#step4_sanko3"><i class="fa fa-check"></i><b>2.4.6</b> 参考３：変数消去</a></li>
<li class="chapter" data-level="2.4.7" data-path="book_01_beginner_1st_half.html"><a href="book_01_beginner_1st_half.html#step4_sanko4"><i class="fa fa-check"></i><b>2.4.7</b> 参考４：クォート</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="book_01_beginner_1st_half.html"><a href="book_01_beginner_1st_half.html#ステップ５データの横結合"><i class="fa fa-check"></i><b>2.5</b> ステップ５：データの横結合</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="book_01_beginner_1st_half.html"><a href="book_01_beginner_1st_half.html#sagyou_step5"><i class="fa fa-check"></i><b>2.5.1</b> 作業内容</a></li>
<li class="chapter" data-level="2.5.2" data-path="book_01_beginner_1st_half.html"><a href="book_01_beginner_1st_half.html#いろいろな結合方法"><i class="fa fa-check"></i><b>2.5.2</b> いろいろな結合方法</a></li>
<li class="chapter" data-level="2.5.3" data-path="book_01_beginner_1st_half.html"><a href="book_01_beginner_1st_half.html#left_join_image"><i class="fa fa-check"></i><b>2.5.3</b> left_joinのイメージ</a></li>
<li class="chapter" data-level="2.5.4" data-path="book_01_beginner_1st_half.html"><a href="book_01_beginner_1st_half.html#結合する方法を決める"><i class="fa fa-check"></i><b>2.5.4</b> 結合する方法を決める</a></li>
<li class="chapter" data-level="2.5.5" data-path="book_01_beginner_1st_half.html"><a href="book_01_beginner_1st_half.html#left_joinでデータの結合"><i class="fa fa-check"></i><b>2.5.5</b> <strong>left_join</strong>でデータの結合</a></li>
<li class="chapter" data-level="2.5.6" data-path="book_01_beginner_1st_half.html"><a href="book_01_beginner_1st_half.html#step5_sanko"><i class="fa fa-check"></i><b>2.5.6</b> 参考：right_join</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="book_01_beginner_1st_half.html"><a href="book_01_beginner_1st_half.html#箸休めスライド"><i class="fa fa-check"></i><b>2.6</b> 箸休めスライド</a>
<ul>
<li class="chapter" data-level="2.6.1" data-path="book_01_beginner_1st_half.html"><a href="book_01_beginner_1st_half.html#relocateでカラムを少しだけ並び替え"><i class="fa fa-check"></i><b>2.6.1</b> relocateでカラムを少しだけ並び替え</a></li>
<li class="chapter" data-level="2.6.2" data-path="book_01_beginner_1st_half.html"><a href="book_01_beginner_1st_half.html#tabキーで補完入力"><i class="fa fa-check"></i><b>2.6.2</b> Tabキーで補完入力</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="book_02_beginner_2nd_half.html"><a href="book_02_beginner_2nd_half.html"><i class="fa fa-check"></i><b>3</b> 初級編後半</a>
<ul>
<li class="chapter" data-level="" data-path="book_02_beginner_2nd_half.html"><a href="book_02_beginner_2nd_half.html#作業の確認"><i class="fa fa-check"></i>作業の確認</a>
<ul>
<li class="chapter" data-level="" data-path="book_02_beginner_2nd_half.html"><a href="book_02_beginner_2nd_half.html#研磨ストーリー-1"><i class="fa fa-check"></i>研磨ストーリー</a></li>
<li class="chapter" data-level="" data-path="book_02_beginner_2nd_half.html"><a href="book_02_beginner_2nd_half.html#作業イメージ-1"><i class="fa fa-check"></i>作業イメージ</a></li>
<li class="chapter" data-level="" data-path="book_02_beginner_2nd_half.html"><a href="book_02_beginner_2nd_half.html#前半の成果物"><i class="fa fa-check"></i>前半の成果物</a></li>
</ul></li>
<li class="chapter" data-level="3.1" data-path="book_02_beginner_2nd_half.html"><a href="book_02_beginner_2nd_half.html#ステップ６カラム操作の基本"><i class="fa fa-check"></i><b>3.1</b> ステップ６：カラム操作の基本</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="book_02_beginner_2nd_half.html"><a href="book_02_beginner_2nd_half.html#sagyou_step6"><i class="fa fa-check"></i><b>3.1.1</b> 作業内容</a></li>
<li class="chapter" data-level="3.1.2" data-path="book_02_beginner_2nd_half.html"><a href="book_02_beginner_2nd_half.html#mutateの基本"><i class="fa fa-check"></i><b>3.1.2</b> <strong>mutate</strong>の基本</a></li>
<li class="chapter" data-level="3.1.3" data-path="book_02_beginner_2nd_half.html"><a href="book_02_beginner_2nd_half.html#mutate_example"><i class="fa fa-check"></i><b>3.1.3</b> mutateの使用例</a></li>
<li class="chapter" data-level="3.1.4" data-path="book_02_beginner_2nd_half.html"><a href="book_02_beginner_2nd_half.html#hosoku_mutate"><i class="fa fa-check"></i><b>3.1.4</b> 補足</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="book_02_beginner_2nd_half.html"><a href="book_02_beginner_2nd_half.html#ステップ７カラムの新設"><i class="fa fa-check"></i><b>3.2</b> ステップ７：カラムの新設</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="book_02_beginner_2nd_half.html"><a href="book_02_beginner_2nd_half.html#sagyou_step7"><i class="fa fa-check"></i><b>3.2.1</b> 作業内容</a></li>
<li class="chapter" data-level="3.2.2" data-path="book_02_beginner_2nd_half.html"><a href="book_02_beginner_2nd_half.html#substrで文字列の部分抽出"><i class="fa fa-check"></i><b>3.2.2</b> <strong>substr</strong>で文字列の部分抽出</a></li>
<li class="chapter" data-level="3.2.3" data-path="book_02_beginner_2nd_half.html"><a href="book_02_beginner_2nd_half.html#都道府県コードカラムの新設"><i class="fa fa-check"></i><b>3.2.3</b> 都道府県コードカラムの新設</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="book_02_beginner_2nd_half.html"><a href="book_02_beginner_2nd_half.html#ステップ８マスタの結合"><i class="fa fa-check"></i><b>3.3</b> ステップ８：マスタの結合</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="book_02_beginner_2nd_half.html"><a href="book_02_beginner_2nd_half.html#sagyou_step8"><i class="fa fa-check"></i><b>3.3.1</b> 作業内容</a></li>
<li class="chapter" data-level="3.3.2" data-path="book_02_beginner_2nd_half.html"><a href="book_02_beginner_2nd_half.html#read_ken_mst"><i class="fa fa-check"></i><b>3.3.2</b> 都道府県マスタの読み込み</a></li>
<li class="chapter" data-level="3.3.3" data-path="book_02_beginner_2nd_half.html"><a href="book_02_beginner_2nd_half.html#join_failed"><i class="fa fa-check"></i><b>3.3.3</b> data_2にken_mstを結合（失敗）</a></li>
<li class="chapter" data-level="3.3.4" data-path="book_02_beginner_2nd_half.html"><a href="book_02_beginner_2nd_half.html#renameでカラム名の変更"><i class="fa fa-check"></i><b>3.3.4</b> <strong>rename</strong>でカラム名の変更</a></li>
<li class="chapter" data-level="3.3.5" data-path="book_02_beginner_2nd_half.html"><a href="book_02_beginner_2nd_half.html#join_success"><i class="fa fa-check"></i><b>3.3.5</b> data_2にken_mstをジョイン（成功）</a></li>
<li class="chapter" data-level="3.3.6" data-path="book_02_beginner_2nd_half.html"><a href="book_02_beginner_2nd_half.html#不一致なカラム名をキーにする方法"><i class="fa fa-check"></i><b>3.3.6</b> 不一致なカラム名をキーにする方法</a></li>
<li class="chapter" data-level="3.3.7" data-path="book_02_beginner_2nd_half.html"><a href="book_02_beginner_2nd_half.html#hosoku_join_mst"><i class="fa fa-check"></i><b>3.3.7</b> 補足</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="book_02_beginner_2nd_half.html"><a href="book_02_beginner_2nd_half.html#ステップ９文字列の結合"><i class="fa fa-check"></i><b>3.4</b> ステップ９：文字列の結合</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="book_02_beginner_2nd_half.html"><a href="book_02_beginner_2nd_half.html#sagyou_step9"><i class="fa fa-check"></i><b>3.4.1</b> 作業内容</a></li>
<li class="chapter" data-level="3.4.2" data-path="book_02_beginner_2nd_half.html"><a href="book_02_beginner_2nd_half.html#pasteで文字列の結合"><i class="fa fa-check"></i><b>3.4.2</b> <strong>paste</strong>で文字列の結合</a></li>
<li class="chapter" data-level="3.4.3" data-path="book_02_beginner_2nd_half.html"><a href="book_02_beginner_2nd_half.html#都道府県カラムの作成"><i class="fa fa-check"></i><b>3.4.3</b> 都道府県カラムの作成</a></li>
<li class="chapter" data-level="3.4.4" data-path="book_02_beginner_2nd_half.html"><a href="book_02_beginner_2nd_half.html#step9_sanko"><i class="fa fa-check"></i><b>3.4.4</b> 参考：paste0</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="book_02_beginner_2nd_half.html"><a href="book_02_beginner_2nd_half.html#ステップ１０指標の作成"><i class="fa fa-check"></i><b>3.5</b> ステップ１０：指標の作成</a>
<ul>
<li class="chapter" data-level="3.5.1" data-path="book_02_beginner_2nd_half.html"><a href="book_02_beginner_2nd_half.html#sagyou_step10"><i class="fa fa-check"></i><b>3.5.1</b> 作業内容</a></li>
<li class="chapter" data-level="3.5.2" data-path="book_02_beginner_2nd_half.html"><a href="book_02_beginner_2nd_half.html#売上高利益率カラムの作成"><i class="fa fa-check"></i><b>3.5.2</b> 売上高利益率カラムの作成</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="book_02_beginner_2nd_half.html"><a href="book_02_beginner_2nd_half.html#ステップ１１条件分岐処理"><i class="fa fa-check"></i><b>3.6</b> ステップ１１：条件分岐処理</a>
<ul>
<li class="chapter" data-level="3.6.1" data-path="book_02_beginner_2nd_half.html"><a href="book_02_beginner_2nd_half.html#sagyou_step11"><i class="fa fa-check"></i><b>3.6.1</b> 作業内容</a></li>
<li class="chapter" data-level="3.6.2" data-path="book_02_beginner_2nd_half.html"><a href="book_02_beginner_2nd_half.html#if_else_ifelse_case_when"><i class="fa fa-check"></i><b>3.6.2</b> if_else, ifelse, case_when</a></li>
<li class="chapter" data-level="3.6.3" data-path="book_02_beginner_2nd_half.html"><a href="book_02_beginner_2nd_half.html#example_if_else_ifelse"><i class="fa fa-check"></i><b>3.6.3</b> if_else, ifelseの使用例</a></li>
<li class="chapter" data-level="3.6.4" data-path="book_02_beginner_2nd_half.html"><a href="book_02_beginner_2nd_half.html#if_else_isbetter"><i class="fa fa-check"></i><b>3.6.4</b> <strong>if_else</strong>はifelseより厳格</a></li>
<li class="chapter" data-level="3.6.5" data-path="book_02_beginner_2nd_half.html"><a href="book_02_beginner_2nd_half.html#case_whenの使用例"><i class="fa fa-check"></i><b>3.6.5</b> case_whenの使用例</a></li>
<li class="chapter" data-level="3.6.6" data-path="book_02_beginner_2nd_half.html"><a href="book_02_beginner_2nd_half.html#if_else_ver"><i class="fa fa-check"></i><b>3.6.6</b> 従業員数レンジカラム作成(if_else)</a></li>
<li class="chapter" data-level="3.6.7" data-path="book_02_beginner_2nd_half.html"><a href="book_02_beginner_2nd_half.html#case_when_ver"><i class="fa fa-check"></i><b>3.6.7</b> 従業員数レンジカラム作成(case_when)</a></li>
<li class="chapter" data-level="3.6.8" data-path="book_02_beginner_2nd_half.html"><a href="book_02_beginner_2nd_half.html#step11_sanko"><i class="fa fa-check"></i><b>3.6.8</b> 参考：条件式</a></li>
</ul></li>
<li class="chapter" data-level="3.7" data-path="book_02_beginner_2nd_half.html"><a href="book_02_beginner_2nd_half.html#ステップ１２ソート"><i class="fa fa-check"></i><b>3.7</b> ステップ１２：ソート</a>
<ul>
<li class="chapter" data-level="3.7.1" data-path="book_02_beginner_2nd_half.html"><a href="book_02_beginner_2nd_half.html#sagyou_step12"><i class="fa fa-check"></i><b>3.7.1</b> 作業内容</a></li>
<li class="chapter" data-level="3.7.2" data-path="book_02_beginner_2nd_half.html"><a href="book_02_beginner_2nd_half.html#arrangeでソート"><i class="fa fa-check"></i><b>3.7.2</b> <strong>arrange</strong>でソート</a></li>
<li class="chapter" data-level="3.7.3" data-path="book_02_beginner_2nd_half.html"><a href="book_02_beginner_2nd_half.html#複数カラムでソート"><i class="fa fa-check"></i><b>3.7.3</b> 複数カラムでソート</a></li>
</ul></li>
<li class="chapter" data-level="3.8" data-path="book_02_beginner_2nd_half.html"><a href="book_02_beginner_2nd_half.html#ステップ１３グループ集計"><i class="fa fa-check"></i><b>3.8</b> ステップ１３：グループ集計</a>
<ul>
<li class="chapter" data-level="3.8.1" data-path="book_02_beginner_2nd_half.html"><a href="book_02_beginner_2nd_half.html#sagyou_step13"><i class="fa fa-check"></i><b>3.8.1</b> 作業内容</a></li>
<li class="chapter" data-level="3.8.2" data-path="book_02_beginner_2nd_half.html"><a href="book_02_beginner_2nd_half.html#how_group_summarise"><i class="fa fa-check"></i><b>3.8.2</b> <strong>group_by</strong>と<strong>summarise</strong>での集計方法</a></li>
<li class="chapter" data-level="3.8.3" data-path="book_02_beginner_2nd_half.html"><a href="book_02_beginner_2nd_half.html#複数カラムでグループ集計"><i class="fa fa-check"></i><b>3.8.3</b> 複数カラムでグループ集計</a></li>
<li class="chapter" data-level="3.8.4" data-path="book_02_beginner_2nd_half.html"><a href="book_02_beginner_2nd_half.html#step13_sanko1"><i class="fa fa-check"></i><b>3.8.4</b> 参考１：mutateとの違い</a></li>
<li class="chapter" data-level="3.8.5" data-path="book_02_beginner_2nd_half.html"><a href="book_02_beginner_2nd_half.html#step13_sanko2"><i class="fa fa-check"></i><b>3.8.5</b> 参考２：グループごとのレコード数を集計</a></li>
<li class="chapter" data-level="3.8.6" data-path="book_02_beginner_2nd_half.html"><a href="book_02_beginner_2nd_half.html#step13_sanko3"><i class="fa fa-check"></i><b>3.8.6</b> 参考３：ピボットテーブル</a></li>
</ul></li>
<li class="chapter" data-level="3.9" data-path="book_02_beginner_2nd_half.html"><a href="book_02_beginner_2nd_half.html#ステップ１４条件抽出"><i class="fa fa-check"></i><b>3.9</b> ステップ１４：条件抽出</a>
<ul>
<li class="chapter" data-level="3.9.1" data-path="book_02_beginner_2nd_half.html"><a href="book_02_beginner_2nd_half.html#sagyou_step14"><i class="fa fa-check"></i><b>3.9.1</b> 作業内容</a></li>
<li class="chapter" data-level="3.9.2" data-path="book_02_beginner_2nd_half.html"><a href="book_02_beginner_2nd_half.html#filterで条件抽出"><i class="fa fa-check"></i><b>3.9.2</b> <strong>filter</strong>で条件抽出</a></li>
<li class="chapter" data-level="3.9.3" data-path="book_02_beginner_2nd_half.html"><a href="book_02_beginner_2nd_half.html#複数条件で抽出"><i class="fa fa-check"></i><b>3.9.3</b> 複数条件で抽出</a></li>
</ul></li>
<li class="chapter" data-level="3.10" data-path="book_02_beginner_2nd_half.html"><a href="book_02_beginner_2nd_half.html#ステップ１５ファイル出力"><i class="fa fa-check"></i><b>3.10</b> ステップ１５：ファイル出力</a>
<ul>
<li class="chapter" data-level="3.10.1" data-path="book_02_beginner_2nd_half.html"><a href="book_02_beginner_2nd_half.html#sagyou_step15"><i class="fa fa-check"></i><b>3.10.1</b> 作業内容</a></li>
<li class="chapter" data-level="3.10.2" data-path="book_02_beginner_2nd_half.html"><a href="book_02_beginner_2nd_half.html#不要な変数の消去"><i class="fa fa-check"></i><b>3.10.2</b> 不要な変数の消去</a></li>
<li class="chapter" data-level="3.10.3" data-path="book_02_beginner_2nd_half.html"><a href="book_02_beginner_2nd_half.html#カラムの並び替え"><i class="fa fa-check"></i><b>3.10.3</b> カラムの並び替え</a></li>
<li class="chapter" data-level="3.10.4" data-path="book_02_beginner_2nd_half.html"><a href="book_02_beginner_2nd_half.html#output_file"><i class="fa fa-check"></i><b>3.10.4</b> <strong>write_csv</strong>でcsvファイルの出力</a></li>
<li class="chapter" data-level="3.10.5" data-path="book_02_beginner_2nd_half.html"><a href="book_02_beginner_2nd_half.html#step15_sanko"><i class="fa fa-check"></i><b>3.10.5</b> 参考：ファイル出力のencoding</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="book_02_beginner_2nd_half.html"><a href="book_02_beginner_2nd_half.html#おわり-1"><i class="fa fa-check"></i>おわり</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="book_03_intermediate_1st_half.html"><a href="book_03_intermediate_1st_half.html"><i class="fa fa-check"></i><b>4</b> 中級編前半</a>
<ul>
<li class="chapter" data-level="" data-path="book_03_intermediate_1st_half.html"><a href="book_03_intermediate_1st_half.html#はじめに-2"><i class="fa fa-check"></i>はじめに</a>
<ul>
<li class="chapter" data-level="" data-path="book_03_intermediate_1st_half.html"><a href="book_03_intermediate_1st_half.html#中級の作業イメージ"><i class="fa fa-check"></i>中級の作業イメージ</a></li>
<li class="chapter" data-level="" data-path="book_03_intermediate_1st_half.html"><a href="book_03_intermediate_1st_half.html#目次中級前半"><i class="fa fa-check"></i>目次（中級前半）</a></li>
</ul></li>
<li class="chapter" data-level="4.1" data-path="book_03_intermediate_1st_half.html"><a href="book_03_intermediate_1st_half.html#fukusuu_image"><i class="fa fa-check"></i><b>4.1</b> 複数ファイルの一括読み込み<br>(イメージ)</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="book_03_intermediate_1st_half.html"><a href="book_03_intermediate_1st_half.html#読み込むデータの確認"><i class="fa fa-check"></i><b>4.1.1</b> 読み込むデータの確認</a></li>
<li class="chapter" data-level="4.1.2" data-path="book_03_intermediate_1st_half.html"><a href="book_03_intermediate_1st_half.html#単純な方法"><i class="fa fa-check"></i><b>4.1.2</b> 単純な方法</a></li>
<li class="chapter" data-level="4.1.3" data-path="book_03_intermediate_1st_half.html"><a href="book_03_intermediate_1st_half.html#for文を使用する方法"><i class="fa fa-check"></i><b>4.1.3</b> for文を使用する方法</a></li>
<li class="chapter" data-level="4.1.4" data-path="book_03_intermediate_1st_half.html"><a href="book_03_intermediate_1st_half.html#for_image"><i class="fa fa-check"></i><b>4.1.4</b> for文5ステップのイメージ</a></li>
<li class="chapter" data-level="4.1.5" data-path="book_03_intermediate_1st_half.html"><a href="book_03_intermediate_1st_half.html#for文による繰り返し処理のススメ"><i class="fa fa-check"></i><b>4.1.5</b> for文による繰り返し処理のススメ</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="book_03_intermediate_1st_half.html"><a href="book_03_intermediate_1st_half.html#list"><i class="fa fa-check"></i><b>4.2</b> list</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="book_03_intermediate_1st_half.html"><a href="book_03_intermediate_1st_half.html#about_list"><i class="fa fa-check"></i><b>4.2.1</b> listとは</a></li>
<li class="chapter" data-level="4.2.2" data-path="book_03_intermediate_1st_half.html"><a href="book_03_intermediate_1st_half.html#image_list"><i class="fa fa-check"></i><b>4.2.2</b> listのイメージ</a></li>
<li class="chapter" data-level="4.2.3" data-path="book_03_intermediate_1st_half.html"><a href="book_03_intermediate_1st_half.html#make_list"><i class="fa fa-check"></i><b>4.2.3</b> listの作成</a></li>
<li class="chapter" data-level="4.2.4" data-path="book_03_intermediate_1st_half.html"><a href="book_03_intermediate_1st_half.html#append_list"><i class="fa fa-check"></i><b>4.2.4</b> listに要素を追加する</a></li>
<li class="chapter" data-level="4.2.5" data-path="book_03_intermediate_1st_half.html"><a href="book_03_intermediate_1st_half.html#access_list"><i class="fa fa-check"></i><b>4.2.5</b> listの要素にアクセス</a></li>
<li class="chapter" data-level="4.2.6" data-path="book_03_intermediate_1st_half.html"><a href="book_03_intermediate_1st_half.html#list_access_image"><i class="fa fa-check"></i><b>4.2.6</b> listの要素アクセスイメージ</a></li>
<li class="chapter" data-level="4.2.7" data-path="book_03_intermediate_1st_half.html"><a href="book_03_intermediate_1st_half.html#names_list"><i class="fa fa-check"></i><b>4.2.7</b> listの要素に名前をつける</a></li>
<li class="chapter" data-level="4.2.8" data-path="book_03_intermediate_1st_half.html"><a href="book_03_intermediate_1st_half.html#list_access_name"><i class="fa fa-check"></i><b>4.2.8</b> listの要素に名前でアクセス</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="book_03_intermediate_1st_half.html"><a href="book_03_intermediate_1st_half.html#for_bun"><i class="fa fa-check"></i><b>4.3</b> for文(繰り返し処理)</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="book_03_intermediate_1st_half.html"><a href="book_03_intermediate_1st_half.html#for文イントロダクション"><i class="fa fa-check"></i><b>4.3.1</b> for文イントロダクション</a></li>
<li class="chapter" data-level="4.3.2" data-path="book_03_intermediate_1st_half.html"><a href="book_03_intermediate_1st_half.html#for文の使い方"><i class="fa fa-check"></i><b>4.3.2</b> for文の使い方</a></li>
<li class="chapter" data-level="4.3.3" data-path="book_03_intermediate_1st_half.html"><a href="book_03_intermediate_1st_half.html#適当な変数名を考える"><i class="fa fa-check"></i><b>4.3.3</b> 適当な変数名を考える</a></li>
<li class="chapter" data-level="4.3.4" data-path="book_03_intermediate_1st_half.html"><a href="book_03_intermediate_1st_half.html#ex_listfor"><i class="fa fa-check"></i><b>4.3.4</b> listとfor文を用いた例</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="book_03_intermediate_1st_half.html"><a href="book_03_intermediate_1st_half.html#fukusu_jisso"><i class="fa fa-check"></i><b>4.4</b> 複数ファイルの一括読み込み<br>(実装)</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="book_03_intermediate_1st_half.html"><a href="book_03_intermediate_1st_half.html#for_image_2"><i class="fa fa-check"></i><b>4.4.1</b> for文の5ステップのイメージ(再掲)</a></li>
<li class="chapter" data-level="4.4.2" data-path="book_03_intermediate_1st_half.html"><a href="book_03_intermediate_1st_half.html#for_step1"><i class="fa fa-check"></i><b>4.4.2</b> for文：ステップ１</a></li>
<li class="chapter" data-level="4.4.3" data-path="book_03_intermediate_1st_half.html"><a href="book_03_intermediate_1st_half.html#for_step2"><i class="fa fa-check"></i><b>4.4.3</b> for文：ステップ２</a></li>
<li class="chapter" data-level="4.4.4" data-path="book_03_intermediate_1st_half.html"><a href="book_03_intermediate_1st_half.html#for_step345"><i class="fa fa-check"></i><b>4.4.4</b> for文：ステップ３,４,５</a></li>
<li class="chapter" data-level="4.4.5" data-path="book_03_intermediate_1st_half.html"><a href="book_03_intermediate_1st_half.html#for_matome"><i class="fa fa-check"></i><b>4.4.5</b> 複数ファイル読み込みまとめ</a></li>
<li class="chapter" data-level="4.4.6" data-path="book_03_intermediate_1st_half.html"><a href="book_03_intermediate_1st_half.html#複数ファイルの一括読み込み結果"><i class="fa fa-check"></i><b>4.4.6</b> 複数ファイルの一括読み込み結果</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="book_03_intermediate_1st_half.html"><a href="book_03_intermediate_1st_half.html#複数データの結合方法"><i class="fa fa-check"></i><b>4.5</b> 複数データの結合方法</a>
<ul>
<li class="chapter" data-level="4.5.1" data-path="book_03_intermediate_1st_half.html"><a href="book_03_intermediate_1st_half.html#タテ結合とヨコ結合"><i class="fa fa-check"></i><b>4.5.1</b> タテ結合とヨコ結合</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="book_03_intermediate_1st_half.html"><a href="book_03_intermediate_1st_half.html#複数データのタテ結合"><i class="fa fa-check"></i><b>4.6</b> 複数データのタテ結合</a>
<ul>
<li class="chapter" data-level="4.6.1" data-path="book_03_intermediate_1st_half.html"><a href="book_03_intermediate_1st_half.html#タテ結合結果"><i class="fa fa-check"></i><b>4.6.1</b> タテ結合結果</a></li>
<li class="chapter" data-level="4.6.2" data-path="book_03_intermediate_1st_half.html"><a href="book_03_intermediate_1st_half.html#タテ結合の手順"><i class="fa fa-check"></i><b>4.6.2</b> タテ結合の手順</a></li>
<li class="chapter" data-level="4.6.3" data-path="book_03_intermediate_1st_half.html"><a href="book_03_intermediate_1st_half.html#make_yearcol"><i class="fa fa-check"></i><b>4.6.3</b> 1. yearカラムの作成</a></li>
<li class="chapter" data-level="4.6.4" data-path="book_03_intermediate_1st_half.html"><a href="book_03_intermediate_1st_half.html#bind_tateketu"><i class="fa fa-check"></i><b>4.6.4</b> 2. bind_rowsでタテ結合</a></li>
<li class="chapter" data-level="4.6.5" data-path="book_03_intermediate_1st_half.html"><a href="book_03_intermediate_1st_half.html#tateketugou_hosoku"><i class="fa fa-check"></i><b>4.6.5</b> 補足</a></li>
<li class="chapter" data-level="4.6.6" data-path="book_03_intermediate_1st_half.html"><a href="book_03_intermediate_1st_half.html#tateketugou_sanko"><i class="fa fa-check"></i><b>4.6.6</b> 参考</a></li>
</ul></li>
<li class="chapter" data-level="4.7" data-path="book_03_intermediate_1st_half.html"><a href="book_03_intermediate_1st_half.html#複数データのヨコ結合"><i class="fa fa-check"></i><b>4.7</b> 複数データのヨコ結合</a>
<ul>
<li class="chapter" data-level="4.7.1" data-path="book_03_intermediate_1st_half.html"><a href="book_03_intermediate_1st_half.html#ヨコ結合結果"><i class="fa fa-check"></i><b>4.7.1</b> ヨコ結合結果</a></li>
<li class="chapter" data-level="4.7.2" data-path="book_03_intermediate_1st_half.html"><a href="book_03_intermediate_1st_half.html#ヨコ結合の手順"><i class="fa fa-check"></i><b>4.7.2</b> ヨコ結合の手順</a></li>
<li class="chapter" data-level="4.7.3" data-path="book_03_intermediate_1st_half.html"><a href="book_03_intermediate_1st_half.html#rename_with"><i class="fa fa-check"></i><b>4.7.3</b> 1. rename_withでカラム名の変更</a></li>
<li class="chapter" data-level="4.7.4" data-path="book_03_intermediate_1st_half.html"><a href="book_03_intermediate_1st_half.html#leftjoin_yokoketugo"><i class="fa fa-check"></i><b>4.7.4</b> 2. left_joinでヨコ結合</a></li>
<li class="chapter" data-level="4.7.5" data-path="book_03_intermediate_1st_half.html"><a href="book_03_intermediate_1st_half.html#yokoketugou_hosoku"><i class="fa fa-check"></i><b>4.7.5</b> 補足</a></li>
<li class="chapter" data-level="4.7.6" data-path="book_03_intermediate_1st_half.html"><a href="book_03_intermediate_1st_half.html#yokoketugou_sanko"><i class="fa fa-check"></i><b>4.7.6</b> 参考</a></li>
</ul></li>
<li class="chapter" data-level="4.8" data-path="book_03_intermediate_1st_half.html"><a href="book_03_intermediate_1st_half.html#rest_intermediate"><i class="fa fa-check"></i><b>4.8</b> 箸休めスライド</a>
<ul>
<li class="chapter" data-level="4.8.1" data-path="book_03_intermediate_1st_half.html"><a href="book_03_intermediate_1st_half.html#map関数"><i class="fa fa-check"></i><b>4.8.1</b> map関数</a></li>
<li class="chapter" data-level="4.8.2" data-path="book_03_intermediate_1st_half.html"><a href="book_03_intermediate_1st_half.html#select_helper"><i class="fa fa-check"></i><b>4.8.2</b> selectのhelper関数</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="book_04_intermediate_2nd_half.html"><a href="book_04_intermediate_2nd_half.html"><i class="fa fa-check"></i><b>5</b> 中級編後半</a>
<ul>
<li class="chapter" data-level="" data-path="book_04_intermediate_2nd_half.html"><a href="book_04_intermediate_2nd_half.html#作業の確認-1"><i class="fa fa-check"></i>作業の確認</a>
<ul>
<li class="chapter" data-level="" data-path="book_04_intermediate_2nd_half.html"><a href="book_04_intermediate_2nd_half.html#中級の作業イメージ-1"><i class="fa fa-check"></i>中級の作業イメージ</a></li>
<li class="chapter" data-level="" data-path="book_04_intermediate_2nd_half.html"><a href="book_04_intermediate_2nd_half.html#目次中級後半"><i class="fa fa-check"></i>目次（中級後半）</a></li>
</ul></li>
<li class="chapter" data-level="5.1" data-path="book_04_intermediate_2nd_half.html"><a href="book_04_intermediate_2nd_half.html#前半の作業のおさらい"><i class="fa fa-check"></i><b>5.1</b> 前半の作業のおさらい</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="book_04_intermediate_2nd_half.html"><a href="book_04_intermediate_2nd_half.html#複数データの読み込み"><i class="fa fa-check"></i><b>5.1.1</b> 複数データの読み込み</a></li>
<li class="chapter" data-level="5.1.2" data-path="book_04_intermediate_2nd_half.html"><a href="book_04_intermediate_2nd_half.html#タテ結合とヨコ結合-1"><i class="fa fa-check"></i><b>5.1.2</b> タテ結合とヨコ結合</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="book_04_intermediate_2nd_half.html"><a href="book_04_intermediate_2nd_half.html#widedata_longdata"><i class="fa fa-check"></i><b>5.2</b> タテ持ちデータ・ヨコ持ちデータ</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="book_04_intermediate_2nd_half.html"><a href="book_04_intermediate_2nd_half.html#what_widelong"><i class="fa fa-check"></i><b>5.2.1</b> タテ持ち・ヨコ持ちとは</a></li>
<li class="chapter" data-level="5.2.2" data-path="book_04_intermediate_2nd_half.html"><a href="book_04_intermediate_2nd_half.html#tokutyo_widelong"><i class="fa fa-check"></i><b>5.2.2</b> タテ持ち・ヨコ持ちの特徴</a></li>
<li class="chapter" data-level="5.2.3" data-path="book_04_intermediate_2nd_half.html"><a href="book_04_intermediate_2nd_half.html#タテヨコ変換"><i class="fa fa-check"></i><b>5.2.3</b> タテ⇔ヨコ変換</a></li>
<li class="chapter" data-level="5.2.4" data-path="book_04_intermediate_2nd_half.html"><a href="book_04_intermediate_2nd_half.html#タテヨコ変換イメージ画像"><i class="fa fa-check"></i><b>5.2.4</b> タテヨコ変換イメージ画像</a></li>
<li class="chapter" data-level="5.2.5" data-path="book_04_intermediate_2nd_half.html"><a href="book_04_intermediate_2nd_half.html#image_wide_long_2"><i class="fa fa-check"></i><b>5.2.5</b> タテヨコ変換イメージgif</a></li>
<li class="chapter" data-level="5.2.6" data-path="book_04_intermediate_2nd_half.html"><a href="book_04_intermediate_2nd_half.html#image_jisso"><i class="fa fa-check"></i><b>5.2.6</b> タテヨコ変換実装</a></li>
<li class="chapter" data-level="5.2.7" data-path="book_04_intermediate_2nd_half.html"><a href="book_04_intermediate_2nd_half.html#wide_to_long"><i class="fa fa-check"></i><b>5.2.7</b> <strong>pivot_longer</strong>でヨコ → タテ変換</a></li>
<li class="chapter" data-level="5.2.8" data-path="book_04_intermediate_2nd_half.html"><a href="book_04_intermediate_2nd_half.html#long_to_wide"><i class="fa fa-check"></i><b>5.2.8</b> <strong>pivot_wider</strong>でタテ → ヨコ変換</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="book_04_intermediate_2nd_half.html"><a href="book_04_intermediate_2nd_half.html#研磨データの比較検証"><i class="fa fa-check"></i><b>5.3</b> 研磨データの比較検証</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="book_04_intermediate_2nd_half.html"><a href="book_04_intermediate_2nd_half.html#比較検証をする理由"><i class="fa fa-check"></i><b>5.3.1</b> 比較検証をする理由</a></li>
<li class="chapter" data-level="5.3.2" data-path="book_04_intermediate_2nd_half.html"><a href="book_04_intermediate_2nd_half.html#比較検証をする方法"><i class="fa fa-check"></i><b>5.3.2</b> 比較検証をする方法</a></li>
<li class="chapter" data-level="5.3.3" data-path="book_04_intermediate_2nd_half.html"><a href="book_04_intermediate_2nd_half.html#検証データの作成long_data"><i class="fa fa-check"></i><b>5.3.3</b> 検証データの作成：long_data</a></li>
<li class="chapter" data-level="5.3.4" data-path="book_04_intermediate_2nd_half.html"><a href="book_04_intermediate_2nd_half.html#wide_data2"><i class="fa fa-check"></i><b>5.3.4</b> 検証データの作成：wide_data</a></li>
<li class="chapter" data-level="5.3.5" data-path="book_04_intermediate_2nd_half.html"><a href="book_04_intermediate_2nd_half.html#diffdfで一致確認"><i class="fa fa-check"></i><b>5.3.5</b> diffdfで一致確認</a></li>
<li class="chapter" data-level="5.3.6" data-path="book_04_intermediate_2nd_half.html"><a href="book_04_intermediate_2nd_half.html#不一致の原因"><i class="fa fa-check"></i><b>5.3.6</b> 不一致の原因</a></li>
<li class="chapter" data-level="5.3.7" data-path="book_04_intermediate_2nd_half.html"><a href="book_04_intermediate_2nd_half.html#不一致の理由"><i class="fa fa-check"></i><b>5.3.7</b> 不一致の理由</a></li>
<li class="chapter" data-level="5.3.8" data-path="book_04_intermediate_2nd_half.html"><a href="book_04_intermediate_2nd_half.html#条件を揃える準備"><i class="fa fa-check"></i><b>5.3.8</b> 条件を揃える準備</a></li>
<li class="chapter" data-level="5.3.9" data-path="book_04_intermediate_2nd_half.html"><a href="book_04_intermediate_2nd_half.html#再度検証"><i class="fa fa-check"></i><b>5.3.9</b> 再度検証</a></li>
<li class="chapter" data-level="5.3.10" data-path="book_04_intermediate_2nd_half.html"><a href="book_04_intermediate_2nd_half.html#hikaku_sanko"><i class="fa fa-check"></i><b>5.3.10</b> 参考：グループ解除</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="book_04_intermediate_2nd_half.html"><a href="book_04_intermediate_2nd_half.html#前年度比の算出"><i class="fa fa-check"></i><b>5.4</b> 前年度比の算出</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="book_04_intermediate_2nd_half.html"><a href="book_04_intermediate_2nd_half.html#hi_result"><i class="fa fa-check"></i><b>5.4.1</b> 結果の確認</a></li>
<li class="chapter" data-level="5.4.2" data-path="book_04_intermediate_2nd_half.html"><a href="book_04_intermediate_2nd_half.html#前年度比算出の手順"><i class="fa fa-check"></i><b>5.4.2</b> 前年度比算出の手順</a></li>
<li class="chapter" data-level="5.4.3" data-path="book_04_intermediate_2nd_half.html"><a href="book_04_intermediate_2nd_half.html#tejun_sort"><i class="fa fa-check"></i><b>5.4.3</b> 手順１：データのソート</a></li>
<li class="chapter" data-level="5.4.4" data-path="book_04_intermediate_2nd_half.html"><a href="book_04_intermediate_2nd_half.html#tejun_zennenjuu"><i class="fa fa-check"></i><b>5.4.4</b> 手順２：前年従業員数の作成</a></li>
<li class="chapter" data-level="5.4.5" data-path="book_04_intermediate_2nd_half.html"><a href="book_04_intermediate_2nd_half.html#tejun_zennenhi"><i class="fa fa-check"></i><b>5.4.5</b> 手順３：前年度比算出</a></li>
<li class="chapter" data-level="5.4.6" data-path="book_04_intermediate_2nd_half.html"><a href="book_04_intermediate_2nd_half.html#tejun_mibae"><i class="fa fa-check"></i><b>5.4.6</b> 手順４：見栄えを整える</a></li>
<li class="chapter" data-level="5.4.7" data-path="book_04_intermediate_2nd_half.html"><a href="book_04_intermediate_2nd_half.html#hi_matome"><i class="fa fa-check"></i><b>5.4.7</b> 前年度比算出まとめ</a></li>
<li class="chapter" data-level="5.4.8" data-path="book_04_intermediate_2nd_half.html"><a href="book_04_intermediate_2nd_half.html#zennenhi_sanko"><i class="fa fa-check"></i><b>5.4.8</b> 参考：横持ちで表示</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="book_04_intermediate_2nd_half.html"><a href="book_04_intermediate_2nd_half.html#データの可視化"><i class="fa fa-check"></i><b>5.5</b> データの可視化</a>
<ul>
<li class="chapter" data-level="5.5.1" data-path="book_04_intermediate_2nd_half.html"><a href="book_04_intermediate_2nd_half.html#なぜデータを可視化するのか"><i class="fa fa-check"></i><b>5.5.1</b> なぜデータを可視化するのか</a></li>
<li class="chapter" data-level="5.5.2" data-path="book_04_intermediate_2nd_half.html"><a href="book_04_intermediate_2nd_half.html#どうやって可視化するのか"><i class="fa fa-check"></i><b>5.5.2</b> どうやって可視化するのか</a></li>
<li class="chapter" data-level="5.5.3" data-path="book_04_intermediate_2nd_half.html"><a href="book_04_intermediate_2nd_half.html#layer_str"><i class="fa fa-check"></i><b>5.5.3</b> ggplotのレイヤー構造</a></li>
<li class="chapter" data-level="5.5.4" data-path="book_04_intermediate_2nd_half.html"><a href="book_04_intermediate_2nd_half.html#dodai"><i class="fa fa-check"></i><b>5.5.4</b> <strong>ggplot</strong>：土台作成</a></li>
<li class="chapter" data-level="5.5.5" data-path="book_04_intermediate_2nd_half.html"><a href="book_04_intermediate_2nd_half.html#aesデータの情報を指定"><i class="fa fa-check"></i><b>5.5.5</b> <strong>aes</strong>：データの情報を指定</a></li>
<li class="chapter" data-level="5.5.6" data-path="book_04_intermediate_2nd_half.html"><a href="book_04_intermediate_2nd_half.html#geom"><i class="fa fa-check"></i><b>5.5.6</b> <strong>geom_＊</strong>：描画</a></li>
<li class="chapter" data-level="5.5.7" data-path="book_04_intermediate_2nd_half.html"><a href="book_04_intermediate_2nd_half.html#labs軸名やタイトル"><i class="fa fa-check"></i><b>5.5.7</b> <strong>labs</strong>：軸名やタイトル</a></li>
<li class="chapter" data-level="5.5.8" data-path="book_04_intermediate_2nd_half.html"><a href="book_04_intermediate_2nd_half.html#before_facet"><i class="fa fa-check"></i><b>5.5.8</b> <strong>facet</strong>の前に</a></li>
<li class="chapter" data-level="5.5.9" data-path="book_04_intermediate_2nd_half.html"><a href="book_04_intermediate_2nd_half.html#facet"><i class="fa fa-check"></i><b>5.5.9</b> <strong>facet</strong>：グループ比較</a></li>
<li class="chapter" data-level="5.5.10" data-path="book_04_intermediate_2nd_half.html"><a href="book_04_intermediate_2nd_half.html#可視化のススメ"><i class="fa fa-check"></i><b>5.5.10</b> 可視化のススメ</a></li>
<li class="chapter" data-level="5.5.11" data-path="book_04_intermediate_2nd_half.html"><a href="book_04_intermediate_2nd_half.html#kasika_sanko1"><i class="fa fa-check"></i><b>5.5.11</b> 参考１：データの整形</a></li>
<li class="chapter" data-level="5.5.12" data-path="book_04_intermediate_2nd_half.html"><a href="book_04_intermediate_2nd_half.html#kasika_sanko2"><i class="fa fa-check"></i><b>5.5.12</b> 参考２：データの比較</a></li>
<li class="chapter" data-level="5.5.13" data-path="book_04_intermediate_2nd_half.html"><a href="book_04_intermediate_2nd_half.html#kasika_sanko3"><i class="fa fa-check"></i><b>5.5.13</b> 参考３：適切な可視化</a></li>
</ul></li>
<li class="chapter" data-level="5.6" data-path="book_04_intermediate_2nd_half.html"><a href="book_04_intermediate_2nd_half.html#ランキングの作成"><i class="fa fa-check"></i><b>5.6</b> ランキングの作成</a>
<ul>
<li class="chapter" data-level="5.6.1" data-path="book_04_intermediate_2nd_half.html"><a href="book_04_intermediate_2nd_half.html#rank_result"><i class="fa fa-check"></i><b>5.6.1</b> 結果の確認</a></li>
<li class="chapter" data-level="5.6.2" data-path="book_04_intermediate_2nd_half.html"><a href="book_04_intermediate_2nd_half.html#rank_tejun0"><i class="fa fa-check"></i><b>5.6.2</b> 内容と手順</a></li>
<li class="chapter" data-level="5.6.3" data-path="book_04_intermediate_2nd_half.html"><a href="book_04_intermediate_2nd_half.html#ランキング関数"><i class="fa fa-check"></i><b>5.6.3</b> ランキング関数</a></li>
<li class="chapter" data-level="5.6.4" data-path="book_04_intermediate_2nd_half.html"><a href="book_04_intermediate_2nd_half.html#rank_tejun1"><i class="fa fa-check"></i><b>5.6.4</b> 手順１：2017年の従業員数が100人以上</a></li>
<li class="chapter" data-level="5.6.5" data-path="book_04_intermediate_2nd_half.html"><a href="book_04_intermediate_2nd_half.html#rank_tejun2"><i class="fa fa-check"></i><b>5.6.5</b> 手順２：業種大分類をjoin</a></li>
<li class="chapter" data-level="5.6.6" data-path="book_04_intermediate_2nd_half.html"><a href="book_04_intermediate_2nd_half.html#rank_tejun3"><i class="fa fa-check"></i><b>5.6.6</b> 手順３：業種別ランキング作成</a></li>
<li class="chapter" data-level="5.6.7" data-path="book_04_intermediate_2nd_half.html"><a href="book_04_intermediate_2nd_half.html#kekka_ranking"><i class="fa fa-check"></i><b>5.6.7</b> ランキングデータ完成</a></li>
<li class="chapter" data-level="5.6.8" data-path="book_04_intermediate_2nd_half.html"><a href="book_04_intermediate_2nd_half.html#rank_tejun4"><i class="fa fa-check"></i><b>5.6.8</b> ランキング作成まとめ</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="book_04_intermediate_2nd_half.html"><a href="book_04_intermediate_2nd_half.html#おわり-2"><i class="fa fa-check"></i>おわり</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="environment.html"><a href="environment.html"><i class="fa fa-check"></i>動作環境</a></li>
<li class="divider"></li>
<li><strong><a href="https://www.ds.shiga-u.ac.jp/DEML/">滋賀大学DEMLセンター</a></strong></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">データエンジニアリング人材養成演習補助教材</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="sec_02" class="section level1" number="3">
<h1><span class="header-section-number">3</span> 初級編後半</h1>
<div id="作業の確認" class="section level2 unnumbered">
<h2>作業の確認</h2>
<div id="研磨ストーリー-1" class="section level3 unnumbered">
<h3>研磨ストーリー</h3>
<p>顧客から受領した企業リストに対して企業概要データを付与し、データの集計表や指標を算出して顧客へ渡します。</p>
<p><img src="../pictures/begginer/story.png" width="100%" style="display: block; margin: auto;" /></p>
</div>
<div id="作業イメージ-1" class="section level3 unnumbered">
<h3>作業イメージ</h3>
<p>添えてある数字が各ステップに対応しています。</p>
<p><img src="../pictures/begginer/story-image-beg.png" width="65%" style="display: block; margin: auto;" /></p>
</div>
<div id="前半の成果物" class="section level3 unnumbered">
<h3>前半の成果物</h3>
<p>企業コードをキーにしてdf_3_distinctとc2_201901_selectedを結合した<strong>data_1</strong>を作成しました。</p>
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

#htucorlpvv .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 18px;
  font-weight: normal;
  font-style: normal;
  background-color: white;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#htucorlpvv .gt_heading {
  background-color: white;
  text-align: center;
  border-bottom-color: white;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#htucorlpvv .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  border-bottom-color: white;
  border-bottom-width: 0;
}

#htucorlpvv .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 4px;
  border-top-color: white;
  border-top-width: 0;
}

#htucorlpvv .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#htucorlpvv .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#htucorlpvv .gt_col_heading {
  color: #333333;
  background-color: white;
  font-size: 100%;
  font-weight: bold;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#htucorlpvv .gt_column_spanner_outer {
  color: #333333;
  background-color: white;
  font-size: 100%;
  font-weight: bold;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#htucorlpvv .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#htucorlpvv .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#htucorlpvv .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#htucorlpvv .gt_group_heading {
  padding: 8px;
  color: #333333;
  background-color: white;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
}

#htucorlpvv .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: white;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#htucorlpvv .gt_from_md > :first-child {
  margin-top: 0;
}

#htucorlpvv .gt_from_md > :last-child {
  margin-bottom: 0;
}

#htucorlpvv .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#htucorlpvv .gt_stub {
  color: #333333;
  background-color: white;
  font-size: 100%;
  font-weight: bold;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 12px;
}

#htucorlpvv .gt_summary_row {
  color: #333333;
  background-color: white;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#htucorlpvv .gt_first_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
}

#htucorlpvv .gt_grand_summary_row {
  color: #333333;
  background-color: white;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#htucorlpvv .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#htucorlpvv .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#htucorlpvv .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#htucorlpvv .gt_footnotes {
  color: #333333;
  background-color: white;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#htucorlpvv .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding: 4px;
}

#htucorlpvv .gt_sourcenotes {
  color: #333333;
  background-color: white;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#htucorlpvv .gt_sourcenote {
  font-size: 90%;
  padding: 4px;
}

#htucorlpvv .gt_left {
  text-align: left;
}

#htucorlpvv .gt_center {
  text-align: center;
}

#htucorlpvv .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#htucorlpvv .gt_font_normal {
  font-weight: normal;
}

#htucorlpvv .gt_font_bold {
  font-weight: bold;
}

#htucorlpvv .gt_font_italic {
  font-style: italic;
}

#htucorlpvv .gt_super {
  font-size: 65%;
}

#htucorlpvv .gt_footnote_marks {
  font-style: italic;
  font-size: 65%;
}
</style>
<div id="htucorlpvv" style="overflow-x:auto;overflow-y:auto;width:auto;height:500px;"><table class="gt_table">
  <thead class="gt_header">
    <tr>
      <th colspan="7" class="gt_heading gt_title gt_font_normal" style>data_1</th>
    </tr>
    <tr>
      <th colspan="7" class="gt_heading gt_subtitle gt_font_normal gt_bottom_border" style></th>
    </tr>
  </thead>
  <thead class="gt_col_headings">
    <tr>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1">企業コード</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1">本社所在地市区郡</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1">業種大分類</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">資本金(千円)</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">従業員数</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">最新期業績売上高(百万円)</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">最新期業績税引後利益(千円)</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr>
      <td class="gt_row gt_left">J31299770</td>
      <td class="gt_row gt_left">13103_東京都港区</td>
      <td class="gt_row gt_left">I:不動産業</td>
      <td class="gt_row gt_right">931300</td>
      <td class="gt_row gt_right">64</td>
      <td class="gt_row gt_right">6555</td>
      <td class="gt_row gt_right">910536</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">E32002046</td>
      <td class="gt_row gt_left">27123_大阪府大阪市淀川区</td>
      <td class="gt_row gt_left">L:サービス業</td>
      <td class="gt_row gt_right">1098300</td>
      <td class="gt_row gt_right">1120</td>
      <td class="gt_row gt_right">100</td>
      <td class="gt_row gt_right">1775694</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">D42585413</td>
      <td class="gt_row gt_left">13103_東京都港区</td>
      <td class="gt_row gt_left">J:運輸・通信業</td>
      <td class="gt_row gt_right">6120900</td>
      <td class="gt_row gt_right">216</td>
      <td class="gt_row gt_right">31746</td>
      <td class="gt_row gt_right">408523</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">J39971897</td>
      <td class="gt_row gt_left">13101_東京都千代田区</td>
      <td class="gt_row gt_left">L:サービス業</td>
      <td class="gt_row gt_right">15432800</td>
      <td class="gt_row gt_right">31059</td>
      <td class="gt_row gt_right">334093</td>
      <td class="gt_row gt_right">2544502</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">J93122775</td>
      <td class="gt_row gt_left">14102_神奈川県横浜市神奈川区</td>
      <td class="gt_row gt_left">F:製造業</td>
      <td class="gt_row gt_right">9904900</td>
      <td class="gt_row gt_right">314</td>
      <td class="gt_row gt_right">69308</td>
      <td class="gt_row gt_right">763986</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">J34719839</td>
      <td class="gt_row gt_left">13111_東京都大田区</td>
      <td class="gt_row gt_left">F:製造業</td>
      <td class="gt_row gt_right">27761400</td>
      <td class="gt_row gt_right">1167</td>
      <td class="gt_row gt_right">54667</td>
      <td class="gt_row gt_right">31954410</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">L12571447</td>
      <td class="gt_row gt_left">23105_愛知県名古屋市中村区</td>
      <td class="gt_row gt_left">G:卸売・小売業，飲食</td>
      <td class="gt_row gt_right">131800</td>
      <td class="gt_row gt_right">880</td>
      <td class="gt_row gt_right">107643</td>
      <td class="gt_row gt_right">7455793</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">D42395106</td>
      <td class="gt_row gt_left">13103_東京都港区</td>
      <td class="gt_row gt_left">G:卸売・小売業，飲食</td>
      <td class="gt_row gt_right">1523000</td>
      <td class="gt_row gt_right">1555</td>
      <td class="gt_row gt_right">65714</td>
      <td class="gt_row gt_right">1387429</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">J34594067</td>
      <td class="gt_row gt_left">13103_東京都港区</td>
      <td class="gt_row gt_left">E:建設業</td>
      <td class="gt_row gt_right">8297700</td>
      <td class="gt_row gt_right">452</td>
      <td class="gt_row gt_right">63388</td>
      <td class="gt_row gt_right">2149032</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">E32304350</td>
      <td class="gt_row gt_left">27126_大阪府大阪市平野区</td>
      <td class="gt_row gt_left">F:製造業</td>
      <td class="gt_row gt_right">458000</td>
      <td class="gt_row gt_right">801</td>
      <td class="gt_row gt_right">40125</td>
      <td class="gt_row gt_right">530833</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">K01110418</td>
      <td class="gt_row gt_left">13102_東京都中央区</td>
      <td class="gt_row gt_left">F:製造業</td>
      <td class="gt_row gt_right">11610300</td>
      <td class="gt_row gt_right">365</td>
      <td class="gt_row gt_right">44279</td>
      <td class="gt_row gt_right">2804433</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">E32110564</td>
      <td class="gt_row gt_left">27104_大阪府大阪市此花区</td>
      <td class="gt_row gt_left">F:製造業</td>
      <td class="gt_row gt_right">9146900</td>
      <td class="gt_row gt_right">486</td>
      <td class="gt_row gt_right">71359</td>
      <td class="gt_row gt_right">6506672</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">E12517408</td>
      <td class="gt_row gt_left">28201_兵庫県姫路市</td>
      <td class="gt_row gt_left">E:建設業</td>
      <td class="gt_row gt_right">1132800</td>
      <td class="gt_row gt_right">79</td>
      <td class="gt_row gt_right">20300</td>
      <td class="gt_row gt_right">1600471</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">E32113347</td>
      <td class="gt_row gt_left">27127_大阪府大阪市北区</td>
      <td class="gt_row gt_left">G:卸売・小売業，飲食</td>
      <td class="gt_row gt_right">4053400</td>
      <td class="gt_row gt_right">302</td>
      <td class="gt_row gt_right">96496</td>
      <td class="gt_row gt_right">913238</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">J30505243</td>
      <td class="gt_row gt_left">13103_東京都港区</td>
      <td class="gt_row gt_left">H:金融・保険業</td>
      <td class="gt_row gt_right">1448400</td>
      <td class="gt_row gt_right">346</td>
      <td class="gt_row gt_right">10969</td>
      <td class="gt_row gt_right">22448</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">J34873560</td>
      <td class="gt_row gt_left">12227_千葉県浦安市</td>
      <td class="gt_row gt_left">G:卸売・小売業，飲食</td>
      <td class="gt_row gt_right">4569300</td>
      <td class="gt_row gt_right">204</td>
      <td class="gt_row gt_right">22993</td>
      <td class="gt_row gt_right">1415250</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">J39977283</td>
      <td class="gt_row gt_left">13103_東京都港区</td>
      <td class="gt_row gt_left">G:卸売・小売業，飲食</td>
      <td class="gt_row gt_right">246000</td>
      <td class="gt_row gt_right">1338</td>
      <td class="gt_row gt_right">24184</td>
      <td class="gt_row gt_right">225865</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">B02122602</td>
      <td class="gt_row gt_left">34207_広島県福山市</td>
      <td class="gt_row gt_left">J:運輸・通信業</td>
      <td class="gt_row gt_right">45597500</td>
      <td class="gt_row gt_right">13645</td>
      <td class="gt_row gt_right">100</td>
      <td class="gt_row gt_right">11584519</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">J34529468</td>
      <td class="gt_row gt_left">13104_東京都新宿区</td>
      <td class="gt_row gt_left">F:製造業</td>
      <td class="gt_row gt_right">3166100</td>
      <td class="gt_row gt_right">895</td>
      <td class="gt_row gt_right">26787</td>
      <td class="gt_row gt_right">261723</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">J36362624</td>
      <td class="gt_row gt_left">13113_東京都渋谷区</td>
      <td class="gt_row gt_left">L:サービス業</td>
      <td class="gt_row gt_right">14780400</td>
      <td class="gt_row gt_right">1054</td>
      <td class="gt_row gt_right">33010</td>
      <td class="gt_row gt_right">4750633</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">J34598062</td>
      <td class="gt_row gt_left">13109_東京都品川区</td>
      <td class="gt_row gt_left">F:製造業</td>
      <td class="gt_row gt_right">10348100</td>
      <td class="gt_row gt_right">673</td>
      <td class="gt_row gt_right">49987</td>
      <td class="gt_row gt_right">1589201</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">J34789669</td>
      <td class="gt_row gt_left">22206_静岡県三島市</td>
      <td class="gt_row gt_left">F:製造業</td>
      <td class="gt_row gt_right">655500</td>
      <td class="gt_row gt_right">162</td>
      <td class="gt_row gt_right">1237</td>
      <td class="gt_row gt_right">1844422</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">D82177528</td>
      <td class="gt_row gt_left">11102_埼玉県さいたま市北区</td>
      <td class="gt_row gt_left">G:卸売・小売業，飲食</td>
      <td class="gt_row gt_right">11203800</td>
      <td class="gt_row gt_right">3828</td>
      <td class="gt_row gt_right">325136</td>
      <td class="gt_row gt_right">24136962</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">E62123226</td>
      <td class="gt_row gt_left">28110_兵庫県神戸市中央区</td>
      <td class="gt_row gt_left">J:運輸・通信業</td>
      <td class="gt_row gt_right">37907900</td>
      <td class="gt_row gt_right">3025</td>
      <td class="gt_row gt_right">152859</td>
      <td class="gt_row gt_right">27785573</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">J34109661</td>
      <td class="gt_row gt_left">13101_東京都千代田区</td>
      <td class="gt_row gt_left">F:製造業</td>
      <td class="gt_row gt_right">31451600</td>
      <td class="gt_row gt_right">3413</td>
      <td class="gt_row gt_right">461075</td>
      <td class="gt_row gt_right">63185341</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">L82121236</td>
      <td class="gt_row gt_left">24216_三重県伊賀市</td>
      <td class="gt_row gt_left">F:製造業</td>
      <td class="gt_row gt_right">4035100</td>
      <td class="gt_row gt_right">216</td>
      <td class="gt_row gt_right">40114</td>
      <td class="gt_row gt_right">2272837</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">J34124165</td>
      <td class="gt_row gt_left">13102_東京都中央区</td>
      <td class="gt_row gt_left">H:金融・保険業</td>
      <td class="gt_row gt_right">9860900</td>
      <td class="gt_row gt_right">368</td>
      <td class="gt_row gt_right">8612</td>
      <td class="gt_row gt_right">914978</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">E32995244</td>
      <td class="gt_row gt_left">27113_大阪府大阪市西淀川区</td>
      <td class="gt_row gt_left">F:製造業</td>
      <td class="gt_row gt_right">1371100</td>
      <td class="gt_row gt_right">332</td>
      <td class="gt_row gt_right">6355</td>
      <td class="gt_row gt_right">1005090</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">D42265223</td>
      <td class="gt_row gt_left">14102_神奈川県横浜市神奈川区</td>
      <td class="gt_row gt_left">G:卸売・小売業，飲食</td>
      <td class="gt_row gt_right">4215900</td>
      <td class="gt_row gt_right">970</td>
      <td class="gt_row gt_right">60473</td>
      <td class="gt_row gt_right">995979</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">J34881765</td>
      <td class="gt_row gt_left">13101_東京都千代田区</td>
      <td class="gt_row gt_left">F:製造業</td>
      <td class="gt_row gt_right">518000</td>
      <td class="gt_row gt_right">1062</td>
      <td class="gt_row gt_right">65101</td>
      <td class="gt_row gt_right">732120</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">E32523679</td>
      <td class="gt_row gt_left">27127_大阪府大阪市北区</td>
      <td class="gt_row gt_left">K:電気・ガス・水道・</td>
      <td class="gt_row gt_right">274560500</td>
      <td class="gt_row gt_right">39916</td>
      <td class="gt_row gt_right">2639445</td>
      <td class="gt_row gt_right">191071717</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">D42093690</td>
      <td class="gt_row gt_left">11219_埼玉県上尾市</td>
      <td class="gt_row gt_left">F:製造業</td>
      <td class="gt_row gt_right">2387500</td>
      <td class="gt_row gt_right">367</td>
      <td class="gt_row gt_right">45837</td>
      <td class="gt_row gt_right">540698</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">J34512464</td>
      <td class="gt_row gt_left">13107_東京都墨田区</td>
      <td class="gt_row gt_left">F:製造業</td>
      <td class="gt_row gt_right">9345600</td>
      <td class="gt_row gt_right">1013</td>
      <td class="gt_row gt_right">26587</td>
      <td class="gt_row gt_right">1352980</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">E32119566</td>
      <td class="gt_row gt_left">27227_大阪府東大阪市</td>
      <td class="gt_row gt_left">F:製造業</td>
      <td class="gt_row gt_right">4827300</td>
      <td class="gt_row gt_right">274</td>
      <td class="gt_row gt_right">12865</td>
      <td class="gt_row gt_right">7773787</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">J34803363</td>
      <td class="gt_row gt_left">13106_東京都台東区</td>
      <td class="gt_row gt_left">F:製造業</td>
      <td class="gt_row gt_right">5229900</td>
      <td class="gt_row gt_right">113</td>
      <td class="gt_row gt_right">19812</td>
      <td class="gt_row gt_right">1599935</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">E42159736</td>
      <td class="gt_row gt_left">25201_滋賀県大津市</td>
      <td class="gt_row gt_left">F:製造業</td>
      <td class="gt_row gt_right">38393900</td>
      <td class="gt_row gt_right">825</td>
      <td class="gt_row gt_right">153467</td>
      <td class="gt_row gt_right">54729062</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">F92118101</td>
      <td class="gt_row gt_left">20380_長野県上伊那郡</td>
      <td class="gt_row gt_left">F:製造業</td>
      <td class="gt_row gt_right">1800900</td>
      <td class="gt_row gt_right">602</td>
      <td class="gt_row gt_right">15863</td>
      <td class="gt_row gt_right">119657</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">J34161865</td>
      <td class="gt_row gt_left">13108_東京都江東区</td>
      <td class="gt_row gt_left">E:建設業</td>
      <td class="gt_row gt_right">587600</td>
      <td class="gt_row gt_right">876</td>
      <td class="gt_row gt_right">29707</td>
      <td class="gt_row gt_right">585028</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">J36287728</td>
      <td class="gt_row gt_left">13113_東京都渋谷区</td>
      <td class="gt_row gt_left">L:サービス業</td>
      <td class="gt_row gt_right">1661000</td>
      <td class="gt_row gt_right">521</td>
      <td class="gt_row gt_right">34446</td>
      <td class="gt_row gt_right">6019471</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">J34887367</td>
      <td class="gt_row gt_left">14207_神奈川県茅ヶ崎市</td>
      <td class="gt_row gt_left">F:製造業</td>
      <td class="gt_row gt_right">21189400</td>
      <td class="gt_row gt_right">734</td>
      <td class="gt_row gt_right">119784</td>
      <td class="gt_row gt_right">7205311</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">B42504542</td>
      <td class="gt_row gt_left">34102_広島県広島市東区</td>
      <td class="gt_row gt_left">G:卸売・小売業，飲食</td>
      <td class="gt_row gt_right">14969400</td>
      <td class="gt_row gt_right">1828</td>
      <td class="gt_row gt_right">549883</td>
      <td class="gt_row gt_right">44261837</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">J32201436</td>
      <td class="gt_row gt_left">13101_東京都千代田区</td>
      <td class="gt_row gt_left">J:運輸・通信業</td>
      <td class="gt_row gt_right">3065900</td>
      <td class="gt_row gt_right">15</td>
      <td class="gt_row gt_right">59626</td>
      <td class="gt_row gt_right">186881</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">J34381066</td>
      <td class="gt_row gt_left">13102_東京都中央区</td>
      <td class="gt_row gt_left">G:卸売・小売業，飲食</td>
      <td class="gt_row gt_right">1593300</td>
      <td class="gt_row gt_right">357</td>
      <td class="gt_row gt_right">12778</td>
      <td class="gt_row gt_right">793484</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">E32129109</td>
      <td class="gt_row gt_left">28202_兵庫県尼崎市</td>
      <td class="gt_row gt_left">F:製造業</td>
      <td class="gt_row gt_right">8152300</td>
      <td class="gt_row gt_right">249</td>
      <td class="gt_row gt_right">25256</td>
      <td class="gt_row gt_right">3228269</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">J34751865</td>
      <td class="gt_row gt_left">13102_東京都中央区</td>
      <td class="gt_row gt_left">F:製造業</td>
      <td class="gt_row gt_right">4389400</td>
      <td class="gt_row gt_right">746</td>
      <td class="gt_row gt_right">33832</td>
      <td class="gt_row gt_right">783540</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">E42768626</td>
      <td class="gt_row gt_left">26102_京都府京都市上京区</td>
      <td class="gt_row gt_left">F:製造業</td>
      <td class="gt_row gt_right">3143100</td>
      <td class="gt_row gt_right">332</td>
      <td class="gt_row gt_right">8744</td>
      <td class="gt_row gt_right">3152288</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">E30971315</td>
      <td class="gt_row gt_left">27128_大阪府大阪市中央区</td>
      <td class="gt_row gt_left">G:卸売・小売業，飲食</td>
      <td class="gt_row gt_right">740000</td>
      <td class="gt_row gt_right">33</td>
      <td class="gt_row gt_right">18699</td>
      <td class="gt_row gt_right">539378</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">J34887766</td>
      <td class="gt_row gt_left">13103_東京都港区</td>
      <td class="gt_row gt_left">F:製造業</td>
      <td class="gt_row gt_right">28245200</td>
      <td class="gt_row gt_right">536</td>
      <td class="gt_row gt_right">396128</td>
      <td class="gt_row gt_right">7942273</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">F12183760</td>
      <td class="gt_row gt_left">15106_新潟県新潟市南区</td>
      <td class="gt_row gt_left">G:卸売・小売業，飲食</td>
      <td class="gt_row gt_right">31079600</td>
      <td class="gt_row gt_right">4521</td>
      <td class="gt_row gt_right">349321</td>
      <td class="gt_row gt_right">8512802</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">E32794904</td>
      <td class="gt_row gt_left">13108_東京都江東区</td>
      <td class="gt_row gt_left">H:金融・保険業</td>
      <td class="gt_row gt_right">21939800</td>
      <td class="gt_row gt_right">363</td>
      <td class="gt_row gt_right">5028</td>
      <td class="gt_row gt_right">532019</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">D42069420</td>
      <td class="gt_row gt_left">14133_神奈川県川崎市中原区</td>
      <td class="gt_row gt_left">L:サービス業</td>
      <td class="gt_row gt_right">278500</td>
      <td class="gt_row gt_right">343</td>
      <td class="gt_row gt_right">14507</td>
      <td class="gt_row gt_right">1276802</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">J34940466</td>
      <td class="gt_row gt_left">13101_東京都千代田区</td>
      <td class="gt_row gt_left">F:製造業</td>
      <td class="gt_row gt_right">82935900</td>
      <td class="gt_row gt_right">4890</td>
      <td class="gt_row gt_right">987787</td>
      <td class="gt_row gt_right">21213347</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">E42556694</td>
      <td class="gt_row gt_left">26106_京都府京都市下京区</td>
      <td class="gt_row gt_left">L:サービス業</td>
      <td class="gt_row gt_right">979200</td>
      <td class="gt_row gt_right">760</td>
      <td class="gt_row gt_right">8556</td>
      <td class="gt_row gt_right">458470</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">E32147647</td>
      <td class="gt_row gt_left">27106_大阪府大阪市西区</td>
      <td class="gt_row gt_left">F:製造業</td>
      <td class="gt_row gt_right">7838500</td>
      <td class="gt_row gt_right">519</td>
      <td class="gt_row gt_right">138481</td>
      <td class="gt_row gt_right">6237376</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">D42029989</td>
      <td class="gt_row gt_left">14103_神奈川県横浜市西区</td>
      <td class="gt_row gt_left">G:卸売・小売業，飲食</td>
      <td class="gt_row gt_right">10240500</td>
      <td class="gt_row gt_right">573</td>
      <td class="gt_row gt_right">140672</td>
      <td class="gt_row gt_right">2555513</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">D22165655</td>
      <td class="gt_row gt_left">12217_千葉県柏市</td>
      <td class="gt_row gt_left">L:サービス業</td>
      <td class="gt_row gt_right">601800</td>
      <td class="gt_row gt_right">733</td>
      <td class="gt_row gt_right">23109</td>
      <td class="gt_row gt_right">4859821</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">J34731169</td>
      <td class="gt_row gt_left">13113_東京都渋谷区</td>
      <td class="gt_row gt_left">J:運輸・通信業</td>
      <td class="gt_row gt_right">231966200</td>
      <td class="gt_row gt_right">1754</td>
      <td class="gt_row gt_right">255394</td>
      <td class="gt_row gt_right">67533788</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">B42539783</td>
      <td class="gt_row gt_left">13101_東京都千代田区</td>
      <td class="gt_row gt_left">H:金融・保険業</td>
      <td class="gt_row gt_right">153828200</td>
      <td class="gt_row gt_right">1649</td>
      <td class="gt_row gt_right">100</td>
      <td class="gt_row gt_right">42189533</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">E82193579</td>
      <td class="gt_row gt_left">27144_大阪府堺市西区</td>
      <td class="gt_row gt_left">G:卸売・小売業，飲食</td>
      <td class="gt_row gt_right">24150700</td>
      <td class="gt_row gt_right">2466</td>
      <td class="gt_row gt_right">466759</td>
      <td class="gt_row gt_right">10237832</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">F82182020</td>
      <td class="gt_row gt_left">16201_富山県富山市</td>
      <td class="gt_row gt_left">K:電気・ガス・水道・</td>
      <td class="gt_row gt_right">92062900</td>
      <td class="gt_row gt_right">6839</td>
      <td class="gt_row gt_right">193174</td>
      <td class="gt_row gt_right">-2695387</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">E32110345</td>
      <td class="gt_row gt_left">13101_東京都千代田区</td>
      <td class="gt_row gt_left">G:卸売・小売業，飲食</td>
      <td class="gt_row gt_right">295027000</td>
      <td class="gt_row gt_right">3376</td>
      <td class="gt_row gt_right">5297577</td>
      <td class="gt_row gt_right">293330719</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">L42491454</td>
      <td class="gt_row gt_left">23106_愛知県名古屋市中区</td>
      <td class="gt_row gt_left">E:建設業</td>
      <td class="gt_row gt_right">252600</td>
      <td class="gt_row gt_right">159</td>
      <td class="gt_row gt_right">21383</td>
      <td class="gt_row gt_right">808944</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">L02645617</td>
      <td class="gt_row gt_left">13101_東京都千代田区</td>
      <td class="gt_row gt_left">L:サービス業</td>
      <td class="gt_row gt_right">24249100</td>
      <td class="gt_row gt_right">1900</td>
      <td class="gt_row gt_right">3269</td>
      <td class="gt_row gt_right">1881133</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">J34983560</td>
      <td class="gt_row gt_left">12204_千葉県船橋市</td>
      <td class="gt_row gt_left">F:製造業</td>
      <td class="gt_row gt_right">1413700</td>
      <td class="gt_row gt_right">143</td>
      <td class="gt_row gt_right">6505</td>
      <td class="gt_row gt_right">-540851</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">E42659133</td>
      <td class="gt_row gt_left">26106_京都府京都市下京区</td>
      <td class="gt_row gt_left">L:サービス業</td>
      <td class="gt_row gt_right">244300</td>
      <td class="gt_row gt_right">228</td>
      <td class="gt_row gt_right">20908</td>
      <td class="gt_row gt_right">204122</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">J34171568</td>
      <td class="gt_row gt_left">13102_東京都中央区</td>
      <td class="gt_row gt_left">G:卸売・小売業，飲食</td>
      <td class="gt_row gt_right">4030700</td>
      <td class="gt_row gt_right">1114</td>
      <td class="gt_row gt_right">35323</td>
      <td class="gt_row gt_right">794562</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">J34647365</td>
      <td class="gt_row gt_left">13101_東京都千代田区</td>
      <td class="gt_row gt_left">E:建設業</td>
      <td class="gt_row gt_right">1390600</td>
      <td class="gt_row gt_right">685</td>
      <td class="gt_row gt_right">4378</td>
      <td class="gt_row gt_right">1394617</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">C82153425</td>
      <td class="gt_row gt_left">43105_熊本県熊本市北区</td>
      <td class="gt_row gt_left">F:製造業</td>
      <td class="gt_row gt_right">3261100</td>
      <td class="gt_row gt_right">1649</td>
      <td class="gt_row gt_right">78346</td>
      <td class="gt_row gt_right">7435384</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">J34414704</td>
      <td class="gt_row gt_left">13111_東京都大田区</td>
      <td class="gt_row gt_left">L:サービス業</td>
      <td class="gt_row gt_right">4975400</td>
      <td class="gt_row gt_right">63</td>
      <td class="gt_row gt_right">23586</td>
      <td class="gt_row gt_right">6180762</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">E32693531</td>
      <td class="gt_row gt_left">28204_兵庫県西宮市</td>
      <td class="gt_row gt_left">G:卸売・小売業，飲食</td>
      <td class="gt_row gt_right">4111300</td>
      <td class="gt_row gt_right">888</td>
      <td class="gt_row gt_right">296682</td>
      <td class="gt_row gt_right">3943989</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">J34601863</td>
      <td class="gt_row gt_left">13113_東京都渋谷区</td>
      <td class="gt_row gt_left">F:製造業</td>
      <td class="gt_row gt_right">6416100</td>
      <td class="gt_row gt_right">1507</td>
      <td class="gt_row gt_right">98350</td>
      <td class="gt_row gt_right">3038153</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">J34549760</td>
      <td class="gt_row gt_left">13111_東京都大田区</td>
      <td class="gt_row gt_left">F:製造業</td>
      <td class="gt_row gt_right">45665700</td>
      <td class="gt_row gt_right">34617</td>
      <td class="gt_row gt_right">2161788</td>
      <td class="gt_row gt_right">180020060</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">C42110360</td>
      <td class="gt_row gt_left">40132_福岡県福岡市博多区</td>
      <td class="gt_row gt_left">L:サービス業</td>
      <td class="gt_row gt_right">2198900</td>
      <td class="gt_row gt_right">194</td>
      <td class="gt_row gt_right">36462</td>
      <td class="gt_row gt_right">3031812</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">E32046058</td>
      <td class="gt_row gt_left">27128_大阪府大阪市中央区</td>
      <td class="gt_row gt_left">F:製造業</td>
      <td class="gt_row gt_right">8339300</td>
      <td class="gt_row gt_right">1235</td>
      <td class="gt_row gt_right">31980</td>
      <td class="gt_row gt_right">4160782</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">E12598679</td>
      <td class="gt_row gt_left">28110_兵庫県神戸市中央区</td>
      <td class="gt_row gt_left">F:製造業</td>
      <td class="gt_row gt_right">11966400</td>
      <td class="gt_row gt_right">2544</td>
      <td class="gt_row gt_right">128762</td>
      <td class="gt_row gt_right">29605632</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">L42193204</td>
      <td class="gt_row gt_left">23109_愛知県名古屋市熱田区</td>
      <td class="gt_row gt_left">K:電気・ガス・水道・</td>
      <td class="gt_row gt_right">39941000</td>
      <td class="gt_row gt_right">2872</td>
      <td class="gt_row gt_right">607757</td>
      <td class="gt_row gt_right">4146133</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">B12117505</td>
      <td class="gt_row gt_left">13101_東京都千代田区</td>
      <td class="gt_row gt_left">F:製造業</td>
      <td class="gt_row gt_right">9343000</td>
      <td class="gt_row gt_right">1085</td>
      <td class="gt_row gt_right">183683</td>
      <td class="gt_row gt_right">34137854</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">F22112890</td>
      <td class="gt_row gt_left">15205_新潟県柏崎市</td>
      <td class="gt_row gt_left">F:製造業</td>
      <td class="gt_row gt_right">586500</td>
      <td class="gt_row gt_right">4343</td>
      <td class="gt_row gt_right">84669</td>
      <td class="gt_row gt_right">5415627</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">L42120327</td>
      <td class="gt_row gt_left">23228_愛知県岩倉市</td>
      <td class="gt_row gt_left">F:製造業</td>
      <td class="gt_row gt_right">7717900</td>
      <td class="gt_row gt_right">463</td>
      <td class="gt_row gt_right">62486</td>
      <td class="gt_row gt_right">590755</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">J34891260</td>
      <td class="gt_row gt_left">13104_東京都新宿区</td>
      <td class="gt_row gt_left">G:卸売・小売業，飲食</td>
      <td class="gt_row gt_right">11709600</td>
      <td class="gt_row gt_right">276</td>
      <td class="gt_row gt_right">128887</td>
      <td class="gt_row gt_right">3059422</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">E32159275</td>
      <td class="gt_row gt_left">27128_大阪府大阪市中央区</td>
      <td class="gt_row gt_left">G:卸売・小売業，飲食</td>
      <td class="gt_row gt_right">7208800</td>
      <td class="gt_row gt_right">239</td>
      <td class="gt_row gt_right">243582</td>
      <td class="gt_row gt_right">6248179</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">K22100903</td>
      <td class="gt_row gt_left">33202_岡山県倉敷市</td>
      <td class="gt_row gt_left">F:製造業</td>
      <td class="gt_row gt_right">1794300</td>
      <td class="gt_row gt_right">440</td>
      <td class="gt_row gt_right">14785</td>
      <td class="gt_row gt_right">3020310</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">J30218155</td>
      <td class="gt_row gt_left">13101_東京都千代田区</td>
      <td class="gt_row gt_left">L:サービス業</td>
      <td class="gt_row gt_right">6192100</td>
      <td class="gt_row gt_right">120</td>
      <td class="gt_row gt_right">96094</td>
      <td class="gt_row gt_right">19960809</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">E32546894</td>
      <td class="gt_row gt_left">28204_兵庫県西宮市</td>
      <td class="gt_row gt_left">F:製造業</td>
      <td class="gt_row gt_right">1585900</td>
      <td class="gt_row gt_right">273</td>
      <td class="gt_row gt_right">12567</td>
      <td class="gt_row gt_right">1265389</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">J30572230</td>
      <td class="gt_row gt_left">13101_東京都千代田区</td>
      <td class="gt_row gt_left">I:不動産業</td>
      <td class="gt_row gt_right">2342600</td>
      <td class="gt_row gt_right">11</td>
      <td class="gt_row gt_right">22639</td>
      <td class="gt_row gt_right">2552005</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">D42029780</td>
      <td class="gt_row gt_left">14102_神奈川県横浜市神奈川区</td>
      <td class="gt_row gt_left">G:卸売・小売業，飲食</td>
      <td class="gt_row gt_right">1</td>
      <td class="gt_row gt_right">8</td>
      <td class="gt_row gt_right">64475</td>
      <td class="gt_row gt_right">346674</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">L42179046</td>
      <td class="gt_row gt_left">23102_愛知県名古屋市東区</td>
      <td class="gt_row gt_left">G:卸売・小売業，飲食</td>
      <td class="gt_row gt_right">12163200</td>
      <td class="gt_row gt_right">4798</td>
      <td class="gt_row gt_right">567262</td>
      <td class="gt_row gt_right">13507229</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">E62597994</td>
      <td class="gt_row gt_left">28206_兵庫県芦屋市</td>
      <td class="gt_row gt_left">F:製造業</td>
      <td class="gt_row gt_right">7014300</td>
      <td class="gt_row gt_right">246</td>
      <td class="gt_row gt_right">22666</td>
      <td class="gt_row gt_right">2952611</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">L42862459</td>
      <td class="gt_row gt_left">23108_愛知県名古屋市瑞穂区</td>
      <td class="gt_row gt_left">I:不動産業</td>
      <td class="gt_row gt_right">2536000</td>
      <td class="gt_row gt_right">466</td>
      <td class="gt_row gt_right">24333</td>
      <td class="gt_row gt_right">870778</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">L42105263</td>
      <td class="gt_row gt_left">23115_愛知県名古屋市名東区</td>
      <td class="gt_row gt_left">G:卸売・小売業，飲食</td>
      <td class="gt_row gt_right">2264700</td>
      <td class="gt_row gt_right">219</td>
      <td class="gt_row gt_right">21756</td>
      <td class="gt_row gt_right">-1646919</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">E32297874</td>
      <td class="gt_row gt_left">27128_大阪府大阪市中央区</td>
      <td class="gt_row gt_left">J:運輸・通信業</td>
      <td class="gt_row gt_right">266500</td>
      <td class="gt_row gt_right">276</td>
      <td class="gt_row gt_right">15604</td>
      <td class="gt_row gt_right">808139</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">J30660549</td>
      <td class="gt_row gt_left">13102_東京都中央区</td>
      <td class="gt_row gt_left">F:製造業</td>
      <td class="gt_row gt_right">7808400</td>
      <td class="gt_row gt_right">308</td>
      <td class="gt_row gt_right">260044</td>
      <td class="gt_row gt_right">5362516</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">E32035549</td>
      <td class="gt_row gt_left">13103_東京都港区</td>
      <td class="gt_row gt_left">G:卸売・小売業，飲食</td>
      <td class="gt_row gt_right">30488600</td>
      <td class="gt_row gt_right">843</td>
      <td class="gt_row gt_right">1083467</td>
      <td class="gt_row gt_right">3113049</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">J34500137</td>
      <td class="gt_row gt_left">13103_東京都港区</td>
      <td class="gt_row gt_left">F:製造業</td>
      <td class="gt_row gt_right">1</td>
      <td class="gt_row gt_right">43</td>
      <td class="gt_row gt_right">17870</td>
      <td class="gt_row gt_right">1966574</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">E38816281</td>
      <td class="gt_row gt_left">27128_大阪府大阪市中央区</td>
      <td class="gt_row gt_left">J:運輸・通信業</td>
      <td class="gt_row gt_right">13100</td>
      <td class="gt_row gt_right">506</td>
      <td class="gt_row gt_right">19350</td>
      <td class="gt_row gt_right">1631730</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">D22716170</td>
      <td class="gt_row gt_left">12106_千葉県千葉市美浜区</td>
      <td class="gt_row gt_left">G:卸売・小売業，飲食</td>
      <td class="gt_row gt_right">146800</td>
      <td class="gt_row gt_right">720</td>
      <td class="gt_row gt_right">545</td>
      <td class="gt_row gt_right">-28674</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">E32153587</td>
      <td class="gt_row gt_left">27106_大阪府大阪市西区</td>
      <td class="gt_row gt_left">G:卸売・小売業，飲食</td>
      <td class="gt_row gt_right">1</td>
      <td class="gt_row gt_right">163</td>
      <td class="gt_row gt_right">403477</td>
      <td class="gt_row gt_right">11550152</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">E62173130</td>
      <td class="gt_row gt_left">28102_兵庫県神戸市灘区</td>
      <td class="gt_row gt_left">G:卸売・小売業，飲食</td>
      <td class="gt_row gt_right">435100</td>
      <td class="gt_row gt_right">130</td>
      <td class="gt_row gt_right">59614</td>
      <td class="gt_row gt_right">348188</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">L42191630</td>
      <td class="gt_row gt_left">23105_愛知県名古屋市中村区</td>
      <td class="gt_row gt_left">G:卸売・小売業，飲食</td>
      <td class="gt_row gt_right">8694900</td>
      <td class="gt_row gt_right">4775</td>
      <td class="gt_row gt_right">5991945</td>
      <td class="gt_row gt_right">68601228</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">E62567837</td>
      <td class="gt_row gt_left">28101_兵庫県神戸市東灘区</td>
      <td class="gt_row gt_left">G:卸売・小売業，飲食</td>
      <td class="gt_row gt_right">929500</td>
      <td class="gt_row gt_right">883</td>
      <td class="gt_row gt_right">78181</td>
      <td class="gt_row gt_right">256179</td>
    </tr>
  </tbody>
  
  
</table></div>
</div>
</div>
<div id="ステップ６カラム操作の基本" class="section level2" number="3.1">
<h2><span class="header-section-number">3.1</span> ステップ６：カラム操作の基本</h2>
<ul>
<li>mutate</li>
</ul>
<div id="sagyou_step6" class="section level3" number="3.1.1">
<h3><span class="header-section-number">3.1.1</span> 作業内容</h3>
<p><strong>mutate</strong>を使ったカラム操作方法を習得します。</p>
<div class="sourceCode" id="cb157"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb157-1"><a href="book_02_beginner_2nd_half.html#cb157-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tibble</span>(<span class="at">a =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb157-2"><a href="book_02_beginner_2nd_half.html#cb157-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">b =</span> a<span class="sc">*</span><span class="dv">2</span>,       <span class="at">c =</span> a<span class="sc">+</span>b,</span>
<span id="cb157-3"><a href="book_02_beginner_2nd_half.html#cb157-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">d =</span> <span class="fu">log</span>(a),    <span class="at">e =</span> <span class="fu">exp</span>(a),</span>
<span id="cb157-4"><a href="book_02_beginner_2nd_half.html#cb157-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">f =</span> <span class="fu">cumsum</span>(a), <span class="at">g =</span> <span class="fu">na_if</span>(a, <span class="dv">2</span>),</span>
<span id="cb157-5"><a href="book_02_beginner_2nd_half.html#cb157-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">h =</span> <span class="fu">lead</span>(a),   <span class="at">i =</span> <span class="fu">lag</span>(a)) <span class="sc">%&gt;%</span> </span>
<span id="cb157-6"><a href="book_02_beginner_2nd_half.html#cb157-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">glimpse</span>()</span></code></pre></div>
<pre><code>Rows: 3
Columns: 9
$ a &lt;int&gt; 1, 2, 3
$ b &lt;dbl&gt; 2, 4, 6
$ c &lt;dbl&gt; 3, 6, 9
$ d &lt;dbl&gt; 0.0000000, 0.6931472, 1.0986123
$ e &lt;dbl&gt; 2.718282, 7.389056, 20.085537
$ f &lt;int&gt; 1, 3, 6
$ g &lt;int&gt; 1, NA, 3
$ h &lt;int&gt; 2, 3, NA
$ i &lt;int&gt; NA, 1, 2</code></pre>
</div>
<div id="mutateの基本" class="section level3" number="3.1.2">
<h3><span class="header-section-number">3.1.2</span> <strong>mutate</strong>の基本</h3>
<ul>
<li>mutateは、データに新しいカラムを追加する関数です</li>
<li>data %&gt;% mutate(<strong>カラム名定義</strong> = <strong>値定義</strong>)と書きます</li>
</ul>
<div class="columns">
<div class="column" style="width:48%;">
<p>元のデータ</p>
<div class="sourceCode" id="cb159"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb159-1"><a href="book_02_beginner_2nd_half.html#cb159-1" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb159-2"><a href="book_02_beginner_2nd_half.html#cb159-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">col_1 =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>)</span>
<span id="cb159-3"><a href="book_02_beginner_2nd_half.html#cb159-3" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb159-4"><a href="book_02_beginner_2nd_half.html#cb159-4" aria-hidden="true" tabindex="-1"></a>d</span></code></pre></div>
<pre><code># A tibble: 3 x 1
  col_1
  &lt;dbl&gt;
1     1
2     2
3     3</code></pre>
</div><div class="column" style="width:2%;">

</div><div class="column" style="width:48%;">
<p>データにカラムを追加</p>
<div class="sourceCode" id="cb161"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb161-1"><a href="book_02_beginner_2nd_half.html#cb161-1" aria-hidden="true" tabindex="-1"></a>vec <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">6</span>) </span>
<span id="cb161-2"><a href="book_02_beginner_2nd_half.html#cb161-2" aria-hidden="true" tabindex="-1"></a>d<span class="sc">$</span>col_2 <span class="ot">&lt;-</span> vec <span class="co"># 普通のやり方</span></span>
<span id="cb161-3"><a href="book_02_beginner_2nd_half.html#cb161-3" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> d <span class="sc">%&gt;%</span>     <span class="co"># dplyr</span></span>
<span id="cb161-4"><a href="book_02_beginner_2nd_half.html#cb161-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">col_3 =</span> vec)</span>
<span id="cb161-5"><a href="book_02_beginner_2nd_half.html#cb161-5" aria-hidden="true" tabindex="-1"></a>d</span></code></pre></div>
<pre><code># A tibble: 3 x 3
  col_1 col_2 col_3
  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1     1     2     2
2     2     4     4
3     3     6     6</code></pre>
</div>
</div>
<hr />
<ul>
<li><strong>既存のカラムに操作を加えたカラム</strong>も作成可能です</li>
<li><strong>同じカラム名の場合は上書き</strong>されます</li>
<li>mutate内では、カンマで続けてカラムを追加できます</li>
</ul>
<div class="columns">
<div class="column" style="width:48%;">
<p>既存カラムを操作して<strong>追加</strong></p>
<div class="sourceCode" id="cb163"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb163-1"><a href="book_02_beginner_2nd_half.html#cb163-1" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> d <span class="sc">%&gt;%</span> </span>
<span id="cb163-2"><a href="book_02_beginner_2nd_half.html#cb163-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb163-3"><a href="book_02_beginner_2nd_half.html#cb163-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">col_4 =</span> col_1 <span class="sc">+</span> col_2</span>
<span id="cb163-4"><a href="book_02_beginner_2nd_half.html#cb163-4" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb163-5"><a href="book_02_beginner_2nd_half.html#cb163-5" aria-hidden="true" tabindex="-1"></a>d</span></code></pre></div>
<pre><code># A tibble: 3 x 4
  col_1 col_2 col_3 col_4
  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1     1     2     2     3
2     2     4     4     6
3     3     6     6     9</code></pre>
</div><div class="column" style="width:2%;">

</div><div class="column" style="width:48%;">
<p>既存カラムを操作し<strong>上書き</strong></p>
<div class="sourceCode" id="cb165"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb165-1"><a href="book_02_beginner_2nd_half.html#cb165-1" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> d <span class="sc">%&gt;%</span> </span>
<span id="cb165-2"><a href="book_02_beginner_2nd_half.html#cb165-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb165-3"><a href="book_02_beginner_2nd_half.html#cb165-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">col_1 =</span> <span class="fu">log</span>(col_1),</span>
<span id="cb165-4"><a href="book_02_beginner_2nd_half.html#cb165-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">col_2 =</span> <span class="fu">exp</span>(col_2))</span>
<span id="cb165-5"><a href="book_02_beginner_2nd_half.html#cb165-5" aria-hidden="true" tabindex="-1"></a>d</span></code></pre></div>
<pre><code># A tibble: 3 x 4
  col_1  col_2 col_3 col_4
  &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1 0       7.39     2     3
2 0.693  54.6      4     6
3 1.10  403.       6     9</code></pre>
</div>
</div>
</div>
<div id="mutate_example" class="section level3" number="3.1.3">
<h3><span class="header-section-number">3.1.3</span> mutateの使用例</h3>
<ul>
<li>たとえば、最新期売上高の単位は百万円になっていますが、この単位を千円に変換したカラムを作る操作は以下のようにして行います
<ul>
<li>selectとheadは見やすさのために使用しています</li>
</ul></li>
</ul>
<div class="sourceCode" id="cb167"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb167-1"><a href="book_02_beginner_2nd_half.html#cb167-1" aria-hidden="true" tabindex="-1"></a>data_1 <span class="sc">%&gt;%</span> </span>
<span id="cb167-2"><a href="book_02_beginner_2nd_half.html#cb167-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="st">`</span><span class="at">最新期業績売上高(百万円)</span><span class="st">`</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb167-3"><a href="book_02_beginner_2nd_half.html#cb167-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(最新期売上高_千円<span class="ot">=</span><span class="st">`</span><span class="at">最新期業績売上高(百万円)</span><span class="st">`</span><span class="sc">*</span><span class="dv">1000</span>)<span class="sc">%&gt;%</span> </span>
<span id="cb167-4"><a href="book_02_beginner_2nd_half.html#cb167-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">3</span>)</span></code></pre></div>
<pre><code># A tibble: 3 x 2
  `最新期業績売上高(百万円)` 最新期売上高_千円
                       &lt;dbl&gt;             &lt;dbl&gt;
1                       6555           6555000
2                        100            100000
3                      31746          31746000</code></pre>
</div>
<div id="hosoku_mutate" class="section level3" number="3.1.4">
<h3><span class="header-section-number">3.1.4</span> 補足</h3>
<ul>
<li>select同様に、括弧つきカラム名は「<strong>`</strong>」で囲みます</li>
<li>値定義の部分に既存のカラム名を入力する際、カラム名を「<strong>""</strong>」で囲むと文字列だと認識してしまいます</li>
</ul>
<div class="columns">
<div class="column" style="width:48%;">
<div class="sourceCode" id="cb169"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb169-1"><a href="book_02_beginner_2nd_half.html#cb169-1" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb169-2"><a href="book_02_beginner_2nd_half.html#cb169-2" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">(col_1)</span><span class="st">`</span> <span class="ot">=</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>)</span>
<span id="cb169-3"><a href="book_02_beginner_2nd_half.html#cb169-3" aria-hidden="true" tabindex="-1"></a>d</span></code></pre></div>
<pre><code># A tibble: 3 x 1
  `(col_1)`
      &lt;int&gt;
1         1
2         2
3         3</code></pre>
</div><div class="column" style="width:2%;">

</div><div class="column" style="width:48%;">
<div class="sourceCode" id="cb171"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb171-1"><a href="book_02_beginner_2nd_half.html#cb171-1" aria-hidden="true" tabindex="-1"></a>d <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(</span>
<span id="cb171-2"><a href="book_02_beginner_2nd_half.html#cb171-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">col_2 =</span> <span class="st">`</span><span class="at">(col_1)</span><span class="st">`</span><span class="sc">*</span><span class="dv">10</span>,</span>
<span id="cb171-3"><a href="book_02_beginner_2nd_half.html#cb171-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">col_3 =</span> <span class="st">&quot;(col_1)&quot;</span>)</span></code></pre></div>
<pre><code># A tibble: 3 x 3
  `(col_1)` col_2 col_3  
      &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;  
1         1    10 (col_1)
2         2    20 (col_1)
3         3    30 (col_1)</code></pre>
</div>
</div>
</div>
</div>
<div id="ステップ７カラムの新設" class="section level2" number="3.2">
<h2><span class="header-section-number">3.2</span> ステップ７：カラムの新設</h2>
<ul>
<li>mutate</li>
<li>substr</li>
</ul>
<div id="sagyou_step7" class="section level3" number="3.2.1">
<h3><span class="header-section-number">3.2.1</span> 作業内容</h3>
<ul>
<li>mutateを使用して、以下のように、「都道府県コード」カラムを新設しましょう</li>
<li>都道府県コードは「本社所在地市区郡」の頭2文字です</li>
<li>文字列を部分的に切り取る方法がわかれば、mutateを使って都道府県コードカラムが新設できます</li>
<li>したがって、まずは文字列の部分抽出方法を説明します</li>
</ul>
<pre><code># A tibble: 5 x 8
  都道府県コード 本社所在地市区郡 企業コード 業種大分類 `資本金(千円)`
  &lt;chr&gt;          &lt;chr&gt;            &lt;chr&gt;      &lt;chr&gt;               &lt;dbl&gt;
1 13             13103_東京都港区 J31299770  I:不動産業         931300
2 27             27123_大阪府大阪市淀川区~ E32002046  L:サービス業~        1098300
3 13             13103_東京都港区 D42585413  J:運輸・通信業~        6120900
4 13             13101_東京都千代田区~ J39971897  L:サービス業~       15432800
5 14             14102_神奈川県横浜市神奈~ J93122775  F:製造業          9904900
# ... with 3 more variables: 従業員数 &lt;dbl&gt;,
#   `最新期業績売上高(百万円)` &lt;dbl&gt;, `最新期業績税引後利益(千円)` &lt;dbl&gt;</code></pre>
</div>
<div id="substrで文字列の部分抽出" class="section level3" number="3.2.2">
<h3><span class="header-section-number">3.2.2</span> <strong>substr</strong>で文字列の部分抽出</h3>
<ul>
<li>substrは、文字列のi番目からj番目までを抽出することができる関数です</li>
</ul>
<div class="sourceCode" id="cb174"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb174-1"><a href="book_02_beginner_2nd_half.html#cb174-1" aria-hidden="true" tabindex="-1"></a><span class="fu">substr</span>(<span class="st">&quot;文字列&quot;</span>, i, j)</span></code></pre></div>
<div class="columns">
<div class="column" style="width:46%;">
<p>例１</p>
<div class="sourceCode" id="cb175"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb175-1"><a href="book_02_beginner_2nd_half.html#cb175-1" aria-hidden="true" tabindex="-1"></a><span class="fu">substr</span>(<span class="st">&quot;123456789&quot;</span>, <span class="dv">1</span>, <span class="dv">5</span>) </span></code></pre></div>
<pre><code>[1] &quot;12345&quot;</code></pre>
</div><div class="column" style="width:2%;">

</div><div class="column" style="width:51%;">
<p>例２</p>
<div class="sourceCode" id="cb177"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb177-1"><a href="book_02_beginner_2nd_half.html#cb177-1" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;東京都豊島区&quot;</span> <span class="sc">%&gt;%</span> <span class="fu">substr</span>(<span class="dv">4</span>,<span class="dv">6</span>)</span></code></pre></div>
<pre><code>[1] &quot;豊島区&quot;</code></pre>
</div>
</div>
<p>substrという関数名は、sub string（部分文字列）に由来します。</p>
</div>
<div id="都道府県コードカラムの新設" class="section level3" number="3.2.3">
<h3><span class="header-section-number">3.2.3</span> 都道府県コードカラムの新設</h3>
<ul>
<li>それでは<strong>mutate</strong>と<strong>substr</strong>を使って都道府県コードのカラムを新設しましょう</li>
<li>都道府県コードは、本社所在地市区郡の頭2文字です</li>
<li>カラムを追加したデータをdata_2とします</li>
</ul>
<div class="sourceCode" id="cb179"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb179-1"><a href="book_02_beginner_2nd_half.html#cb179-1" aria-hidden="true" tabindex="-1"></a>data_2 <span class="ot">&lt;-</span> data_1 <span class="sc">%&gt;%</span> </span>
<span id="cb179-2"><a href="book_02_beginner_2nd_half.html#cb179-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(都道府県コード <span class="ot">=</span> <span class="fu">substr</span>(本社所在地市区郡, <span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb179-3"><a href="book_02_beginner_2nd_half.html#cb179-3" aria-hidden="true" tabindex="-1"></a>data_2 <span class="sc">%&gt;%</span> <span class="fu">relocate</span>(都道府県コード, 本社所在地市区郡)</span></code></pre></div>
<pre><code># A tibble: 887 x 8
   都道府県コード 本社所在地市区郡 企業コード 業種大分類 `資本金(千円)`
   &lt;chr&gt;          &lt;chr&gt;            &lt;chr&gt;      &lt;chr&gt;               &lt;dbl&gt;
 1 13             13103_東京都港区 J31299770  I:不動産業         931300
 2 27             27123_大阪府大阪市淀川区~ E32002046  L:サービス業~        1098300
 3 13             13103_東京都港区 D42585413  J:運輸・通信業~        6120900
 4 13             13101_東京都千代田区~ J39971897  L:サービス業~       15432800
 5 14             14102_神奈川県横浜市神奈~ J93122775  F:製造業          9904900
 6 13             13111_東京都大田区~ J34719839  F:製造業         27761400
 7 23             23105_愛知県名古屋市中村~ L12571447  G:卸売・小売業，~         131800
 8 13             13103_東京都港区 D42395106  G:卸売・小売業，~        1523000
 9 13             13103_東京都港区 J34594067  E:建設業          8297700
10 27             27126_大阪府大阪市平野区~ E32304350  F:製造業           458000
# ... with 877 more rows, and 3 more variables: 従業員数 &lt;dbl&gt;,
#   `最新期業績売上高(百万円)` &lt;dbl&gt;, `最新期業績税引後利益(千円)` &lt;dbl&gt;</code></pre>
</div>
</div>
<div id="ステップ８マスタの結合" class="section level2" number="3.3">
<h2><span class="header-section-number">3.3</span> ステップ８：マスタの結合</h2>
<ul>
<li>rename</li>
<li>left_join</li>
</ul>
<div id="sagyou_step8" class="section level3" number="3.3.1">
<h3><span class="header-section-number">3.3.1</span> 作業内容</h3>
<ul>
<li>data_2に、「都道府県マスタ」データを、都道府県コードをキーとして結合します</li>
</ul>
<div class="columns">
<div class="column" style="width:48%;">
<p><strong>data_2</strong></p>
<pre><code># A tibble: 887 x 8
   都道府県コード 企業コード 本社所在地市区郡 業種大分類 `資本金(千円)`
   &lt;chr&gt;          &lt;chr&gt;      &lt;chr&gt;            &lt;chr&gt;               &lt;dbl&gt;
 1 13             J31299770  13103_東京都港区 I:不動産業         931300
 2 27             E32002046  27123_大阪府大阪市淀川区~ L:サービス業~        1098300
 3 13             D42585413  13103_東京都港区 J:運輸・通信業~        6120900
 4 13             J39971897  13101_東京都千代田区~ L:サービス業~       15432800
 5 14             J93122775  14102_神奈川県横浜市神奈~ F:製造業          9904900
 6 13             J34719839  13111_東京都大田区~ F:製造業         27761400
 7 23             L12571447  23105_愛知県名古屋市中村~ G:卸売・小売業，~         131800
 8 13             D42395106  13103_東京都港区 G:卸売・小売業，~        1523000
 9 13             J34594067  13103_東京都港区 E:建設業          8297700
10 27             E32304350  27126_大阪府大阪市平野区~ F:製造業           458000
# ... with 877 more rows, and 3 more variables: 従業員数 &lt;dbl&gt;,
#   `最新期業績売上高(百万円)` &lt;dbl&gt;, `最新期業績税引後利益(千円)` &lt;dbl&gt;</code></pre>
</div><div class="column" style="width:2%;">

</div><div class="column" style="width:48%;">
<p><strong>都道府県マスタ</strong></p>
<pre><code># A tibble: 47 x 2
   都道府県CODE 都道府県名
   &lt;chr&gt;        &lt;chr&gt;     
 1 01           北海道    
 2 02           青森県    
 3 03           岩手県    
 4 04           宮城県    
 5 05           秋田県    
 6 06           山形県    
 7 07           福島県    
 8 08           茨城県    
 9 09           栃木県    
10 10           群馬県    
# ... with 37 more rows</code></pre>
</div>
</div>
</div>
<div id="read_ken_mst" class="section level3" number="3.3.2">
<h3><span class="header-section-number">3.3.2</span> 都道府県マスタの読み込み</h3>
<ul>
<li>まずは都道府県マスタを読み込みます</li>
<li>0落ちしないようにカラム型を文字列と指定します</li>
</ul>
<div class="sourceCode" id="cb183"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb183-1"><a href="book_02_beginner_2nd_half.html#cb183-1" aria-hidden="true" tabindex="-1"></a>ken_mst <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="fu">here</span>(<span class="st">&quot;input/都道府県マスタ.csv&quot;</span>),</span>
<span id="cb183-2"><a href="book_02_beginner_2nd_half.html#cb183-2" aria-hidden="true" tabindex="-1"></a>                    <span class="at">col_types =</span> <span class="fu">cols</span>(</span>
<span id="cb183-3"><a href="book_02_beginner_2nd_half.html#cb183-3" aria-hidden="true" tabindex="-1"></a>                      <span class="st">&quot;都道府県CODE&quot;</span> <span class="ot">=</span> <span class="fu">col_character</span>(),</span>
<span id="cb183-4"><a href="book_02_beginner_2nd_half.html#cb183-4" aria-hidden="true" tabindex="-1"></a>                      <span class="st">&quot;都道府県名&quot;</span>   <span class="ot">=</span> <span class="fu">col_character</span>()),</span>
<span id="cb183-5"><a href="book_02_beginner_2nd_half.html#cb183-5" aria-hidden="true" tabindex="-1"></a>                    <span class="at">locale=</span><span class="fu">locale</span>(<span class="at">encoding=</span><span class="st">&quot;shift-jis&quot;</span>))</span>
<span id="cb183-6"><a href="book_02_beginner_2nd_half.html#cb183-6" aria-hidden="true" tabindex="-1"></a>ken_mst <span class="sc">%&gt;%</span> <span class="fu">glimpse</span>()</span></code></pre></div>
<pre><code>Rows: 47
Columns: 2
$ 都道府県CODE &lt;chr&gt; &quot;01&quot;, &quot;02&quot;, &quot;03&quot;, &quot;04&quot;, &quot;05&quot;, &quot;06&quot;, &quot;07&quot;, &quot;08&quot;, &quot;09&quot;, &quot;1...
$ 都道府県名   &lt;chr&gt; &quot;北海道&quot;, &quot;青森県&quot;, &quot;岩手県&quot;, &quot;宮城県&quot;, &quot;秋田県&quot;, &quot;山形県&quot;, &quot;福島県&quot;, &quot;茨城県&quot;, &quot;...</code></pre>
</div>
<div id="join_failed" class="section level3" number="3.3.3">
<h3><span class="header-section-number">3.3.3</span> data_2にken_mstを結合（失敗）</h3>
<div class="sourceCode" id="cb185"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb185-1"><a href="book_02_beginner_2nd_half.html#cb185-1" aria-hidden="true" tabindex="-1"></a>data_2 <span class="sc">%&gt;%</span> <span class="fu">left_join</span>(ken_mst, <span class="at">by =</span> <span class="st">&quot;都道府県コード&quot;</span>)</span></code></pre></div>
<pre><code>Error: Join columns must be present in data.
x Problem with `都道府県コード`.</code></pre>
<ul>
<li><strong>都道府県コード</strong>をキーにしましたが、都道府県マスタにあるカラムは<strong>都道府県CODE</strong>となっているためerrorが出てしまいました</li>
<li>このような場合、次の2通りの対処方法があります
<ul>
<li>どちらかのデータのカラム名を変更して、キーにするカラム名を統一する</li>
<li>データごとにキーにするカラムを指定する</li>
</ul></li>
</ul>
<p>先にカラム名を変更する対処法を説明して、次にデータごとにキーにするカラムを指定する対処法を説明します。</p>
</div>
<div id="renameでカラム名の変更" class="section level3" number="3.3.4">
<h3><span class="header-section-number">3.3.4</span> <strong>rename</strong>でカラム名の変更</h3>
<ul>
<li>mutateと同様にして記述し、カラム名の変更ができます</li>
</ul>
<div class="sourceCode" id="cb187"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb187-1"><a href="book_02_beginner_2nd_half.html#cb187-1" aria-hidden="true" tabindex="-1"></a>d <span class="sc">%&gt;%</span> <span class="fu">rename</span>(<span class="st">&quot;新カラム名&quot;</span> <span class="ot">=</span> 旧カラム名)</span></code></pre></div>
<div class="columns">
<div class="column" style="width:48%;">
<div class="sourceCode" id="cb188"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb188-1"><a href="book_02_beginner_2nd_half.html#cb188-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 元の模擬データ</span></span>
<span id="cb188-2"><a href="book_02_beginner_2nd_half.html#cb188-2" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb188-3"><a href="book_02_beginner_2nd_half.html#cb188-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">col_1 =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>,</span>
<span id="cb188-4"><a href="book_02_beginner_2nd_half.html#cb188-4" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">(col_2)</span><span class="st">`</span> <span class="ot">=</span> <span class="dv">3</span><span class="sc">:</span><span class="dv">4</span>)</span>
<span id="cb188-5"><a href="book_02_beginner_2nd_half.html#cb188-5" aria-hidden="true" tabindex="-1"></a>d</span></code></pre></div>
<pre><code># A tibble: 2 x 2
  col_1 `(col_2)`
  &lt;int&gt;     &lt;int&gt;
1     1         3
2     2         4</code></pre>
</div><div class="column" style="width:2%;">

</div><div class="column" style="width:48%;">
<div class="sourceCode" id="cb190"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb190-1"><a href="book_02_beginner_2nd_half.html#cb190-1" aria-hidden="true" tabindex="-1"></a><span class="co"># カラム名を変更</span></span>
<span id="cb190-2"><a href="book_02_beginner_2nd_half.html#cb190-2" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> d <span class="sc">%&gt;%</span> <span class="fu">rename</span>(</span>
<span id="cb190-3"><a href="book_02_beginner_2nd_half.html#cb190-3" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;Col1&quot;</span> <span class="ot">=</span> col_1, </span>
<span id="cb190-4"><a href="book_02_beginner_2nd_half.html#cb190-4" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;Col2&quot;</span> <span class="ot">=</span> <span class="st">`</span><span class="at">(col_2)</span><span class="st">`</span>)</span>
<span id="cb190-5"><a href="book_02_beginner_2nd_half.html#cb190-5" aria-hidden="true" tabindex="-1"></a>d</span></code></pre></div>
<pre><code># A tibble: 2 x 2
   Col1  Col2
  &lt;int&gt; &lt;int&gt;
1     1     3
2     2     4</code></pre>
</div>
</div>
</div>
<div id="join_success" class="section level3" number="3.3.5">
<h3><span class="header-section-number">3.3.5</span> data_2にken_mstをジョイン（成功）</h3>
<ul>
<li>都道府県マスタの「都道府県CODE」カラムを「都道府県コード」に変更してからleft_joinを行います</li>
</ul>
<div class="sourceCode" id="cb192"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb192-1"><a href="book_02_beginner_2nd_half.html#cb192-1" aria-hidden="true" tabindex="-1"></a>data_3 <span class="ot">&lt;-</span> data_2 <span class="sc">%&gt;%</span> </span>
<span id="cb192-2"><a href="book_02_beginner_2nd_half.html#cb192-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>( <span class="co"># 関数の引数内でもパイプを使えます</span></span>
<span id="cb192-3"><a href="book_02_beginner_2nd_half.html#cb192-3" aria-hidden="true" tabindex="-1"></a>    ken_mst <span class="sc">%&gt;%</span> <span class="fu">rename</span>(<span class="st">&quot;都道府県コード&quot;</span> <span class="ot">=</span> 都道府県CODE),</span>
<span id="cb192-4"><a href="book_02_beginner_2nd_half.html#cb192-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">by =</span> <span class="st">&quot;都道府県コード&quot;</span>)</span>
<span id="cb192-5"><a href="book_02_beginner_2nd_half.html#cb192-5" aria-hidden="true" tabindex="-1"></a>data_3 <span class="sc">%&gt;%</span> <span class="fu">glimpse</span>()</span></code></pre></div>
<pre><code>Rows: 887
Columns: 9
$ 企業コード                   &lt;chr&gt; &quot;J31299770&quot;, &quot;E32002046&quot;, &quot;D42585413&quot;, &quot;J...
$ 本社所在地市区郡             &lt;chr&gt; &quot;13103_東京都港区&quot;, &quot;27123_大阪府大阪市淀川区&quot;, &quot;13103_東京都...
$ 業種大分類                   &lt;chr&gt; &quot;I:不動産業&quot;, &quot;L:サービス業&quot;, &quot;J:運輸・通信業&quot;, &quot;L:サービス業...
$ `資本金(千円)`               &lt;dbl&gt; 931300, 1098300, 6120900, 15432800, 99049...
$ 従業員数                     &lt;dbl&gt; 64, 1120, 216, 31059, 314, 1167, 880, 15...
$ `最新期業績売上高(百万円)`   &lt;dbl&gt; 6555, 100, 31746, 334093, 69308, 54667, 107643,...
$ `最新期業績税引後利益(千円)` &lt;dbl&gt; 910536, 1775694, 408523, 2544502, 763986, 319544...
$ 都道府県コード               &lt;chr&gt; &quot;13&quot;, &quot;27&quot;, &quot;13&quot;, &quot;13&quot;, &quot;14&quot;, &quot;13&quot;, &quot;23&quot;, &quot;...
$ 都道府県名                   &lt;chr&gt; &quot;東京都&quot;, &quot;大阪府&quot;, &quot;東京都&quot;, &quot;東京都&quot;, &quot;神奈川県&quot;, &quot;東京都&quot;...</code></pre>
</div>
<div id="不一致なカラム名をキーにする方法" class="section level3" number="3.3.6">
<h3><span class="header-section-number">3.3.6</span> 不一致なカラム名をキーにする方法</h3>
<ul>
<li>結論から書くと、以下のようにして書きます</li>
</ul>
<div class="sourceCode" id="cb194"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb194-1"><a href="book_02_beginner_2nd_half.html#cb194-1" aria-hidden="true" tabindex="-1"></a>data_3 <span class="ot">&lt;-</span> data_2 <span class="sc">%&gt;%</span> </span>
<span id="cb194-2"><a href="book_02_beginner_2nd_half.html#cb194-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(ken_mst, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">&quot;都道府県コード&quot;</span><span class="ot">=</span><span class="st">&quot;都道府県CODE&quot;</span>))</span></code></pre></div>
<ul>
<li>byで指定しているキーの順番は引数の順番に対応します</li>
<li>つまり、「data_2は都道府県コード」、「ken_mstは都道府県CODE」をキーにするという指定を行っています</li>
<li>結合後のキーカラムは“都道府県コード”のみが残ります</li>
<li>結果は先ほどと同じなので省略します</li>
<li>data_2とken_mstをジョインしたものをdata_3とします</li>
</ul>
</div>
<div id="hosoku_join_mst" class="section level3" number="3.3.7">
<h3><span class="header-section-number">3.3.7</span> 補足</h3>
<ul>
<li>キーを別々に指定する方法は著者自身も最初は知らず、<strong>helpファイル</strong>に以下の記述があったので知りました</li>
</ul>
<pre><code># if the join variables have different names
band_members %&gt;% 
  full_join(band_instruments2, by = c(&quot;name&quot; = &quot;artist&quot;))
# Note that only the key from the LHS is kept</code></pre>
<ul>
<li>不一致キーの問題はrenameでも対処できましたが、renameせずにjoinする方法がないかが気になりました</li>
<li>関数を調べるときはまずhelpファイルを見ましょう</li>
<li>導入編でも述べましたが、Rでは<strong>?left_join()</strong>のように、?を関数の前につけることでhelpファイルが見れます</li>
</ul>
</div>
</div>
<div id="ステップ９文字列の結合" class="section level2" number="3.4">
<h2><span class="header-section-number">3.4</span> ステップ９：文字列の結合</h2>
<ul>
<li>paste</li>
</ul>
<div id="sagyou_step9" class="section level3" number="3.4.1">
<h3><span class="header-section-number">3.4.1</span> 作業内容</h3>
<ul>
<li>data_3に「都道府県」カラムを新設します</li>
<li>都道府県カラムは、都道府県コードと都道府県名の間に「_」を入れた「01_北海道」のようなデータです</li>
<li>文字列を結合する方法がわかればmutateでできます</li>
<li>したがって、まずは文字列の結合方法を説明します</li>
</ul>
<pre><code># A tibble: 887 x 10
   都道府県 都道府県コード 都道府県名 企業コード 本社所在地市区郡 業種大分類
   &lt;chr&gt;    &lt;chr&gt;          &lt;chr&gt;      &lt;chr&gt;      &lt;chr&gt;            &lt;chr&gt;     
 1 13_東京都~ 13             東京都     J31299770  13103_東京都港区 I:不動産業
 2 27_大阪府~ 27             大阪府     E32002046  27123_大阪府大阪市淀川区~ L:サービス業~
 3 13_東京都~ 13             東京都     D42585413  13103_東京都港区 J:運輸・通信業~
 4 13_東京都~ 13             東京都     J39971897  13101_東京都千代田区~ L:サービス業~
 5 14_神奈川県~ 14             神奈川県   J93122775  14102_神奈川県横浜市神奈~ F:製造業  
 6 13_東京都~ 13             東京都     J34719839  13111_東京都大田区~ F:製造業  
 7 23_愛知県~ 23             愛知県     L12571447  23105_愛知県名古屋市中村~ G:卸売・小売業，~
 8 13_東京都~ 13             東京都     D42395106  13103_東京都港区 G:卸売・小売業，~
 9 13_東京都~ 13             東京都     J34594067  13103_東京都港区 E:建設業  
10 27_大阪府~ 27             大阪府     E32304350  27126_大阪府大阪市平野区~ F:製造業  
# ... with 877 more rows, and 4 more variables: `資本金(千円)` &lt;dbl&gt;,
#   従業員数 &lt;dbl&gt;, `最新期業績売上高(百万円)` &lt;dbl&gt;,
#   `最新期業績税引後利益(千円)` &lt;dbl&gt;</code></pre>
</div>
<div id="pasteで文字列の結合" class="section level3" number="3.4.2">
<h3><span class="header-section-number">3.4.2</span> <strong>paste</strong>で文字列の結合</h3>
<ul>
<li>文字列を結合するにはpaste関数を使います</li>
<li>pasteの挙動は以下のようになります</li>
</ul>
<div class="sourceCode" id="cb197"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb197-1"><a href="book_02_beginner_2nd_half.html#cb197-1" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">&quot;神奈川県&quot;</span>, <span class="st">&quot;横浜市&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;_&quot;</span>)</span></code></pre></div>
<pre><code>[1] &quot;神奈川県_横浜市&quot;</code></pre>
<div class="sourceCode" id="cb199"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb199-1"><a href="book_02_beginner_2nd_half.html#cb199-1" aria-hidden="true" tabindex="-1"></a>KEN <span class="ot">&lt;-</span> <span class="st">&quot;神奈川県&quot;</span></span>
<span id="cb199-2"><a href="book_02_beginner_2nd_half.html#cb199-2" aria-hidden="true" tabindex="-1"></a>CITY <span class="ot">&lt;-</span> <span class="st">&quot;横浜市&quot;</span></span>
<span id="cb199-3"><a href="book_02_beginner_2nd_half.html#cb199-3" aria-hidden="true" tabindex="-1"></a>TOWN <span class="ot">&lt;-</span> <span class="st">&quot;緑区&quot;</span></span>
<span id="cb199-4"><a href="book_02_beginner_2nd_half.html#cb199-4" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(KEN, CITY, TOWN, <span class="at">sep =</span> <span class="st">&quot;&quot;</span>)</span></code></pre></div>
<pre><code>[1] &quot;神奈川県横浜市緑区&quot;</code></pre>
</div>
<div id="都道府県カラムの作成" class="section level3" number="3.4.3">
<h3><span class="header-section-number">3.4.3</span> 都道府県カラムの作成</h3>
<ul>
<li>都道府県カラムは、都道府県コードと都道府県名の間に「_」を入れた「01_北海道」のようなデータです</li>
<li>都道府県カラムを追加したデータをdata_4とします</li>
</ul>
<div class="sourceCode" id="cb201"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb201-1"><a href="book_02_beginner_2nd_half.html#cb201-1" aria-hidden="true" tabindex="-1"></a>data_4 <span class="ot">&lt;-</span> data_3 <span class="sc">%&gt;%</span> </span>
<span id="cb201-2"><a href="book_02_beginner_2nd_half.html#cb201-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(都道府県 <span class="ot">=</span> <span class="fu">paste</span>(都道府県コード, 都道府県名,</span>
<span id="cb201-3"><a href="book_02_beginner_2nd_half.html#cb201-3" aria-hidden="true" tabindex="-1"></a>                            <span class="at">sep =</span> <span class="st">&quot;_&quot;</span>))</span>
<span id="cb201-4"><a href="book_02_beginner_2nd_half.html#cb201-4" aria-hidden="true" tabindex="-1"></a>data_4 <span class="sc">%&gt;%</span> <span class="fu">relocate</span>(都道府県, 都道府県コード, 都道府県名) </span></code></pre></div>
<pre><code># A tibble: 887 x 10
   都道府県 都道府県コード 都道府県名 企業コード 本社所在地市区郡 業種大分類
   &lt;chr&gt;    &lt;chr&gt;          &lt;chr&gt;      &lt;chr&gt;      &lt;chr&gt;            &lt;chr&gt;     
 1 13_東京都~ 13             東京都     J31299770  13103_東京都港区 I:不動産業
 2 27_大阪府~ 27             大阪府     E32002046  27123_大阪府大阪市淀川区~ L:サービス業~
 3 13_東京都~ 13             東京都     D42585413  13103_東京都港区 J:運輸・通信業~
 4 13_東京都~ 13             東京都     J39971897  13101_東京都千代田区~ L:サービス業~
 5 14_神奈川県~ 14             神奈川県   J93122775  14102_神奈川県横浜市神奈~ F:製造業  
 6 13_東京都~ 13             東京都     J34719839  13111_東京都大田区~ F:製造業  
 7 23_愛知県~ 23             愛知県     L12571447  23105_愛知県名古屋市中村~ G:卸売・小売業，~
 8 13_東京都~ 13             東京都     D42395106  13103_東京都港区 G:卸売・小売業，~
 9 13_東京都~ 13             東京都     J34594067  13103_東京都港区 E:建設業  
10 27_大阪府~ 27             大阪府     E32304350  27126_大阪府大阪市平野区~ F:製造業  
# ... with 877 more rows, and 4 more variables: `資本金(千円)` &lt;dbl&gt;,
#   従業員数 &lt;dbl&gt;, `最新期業績売上高(百万円)` &lt;dbl&gt;,
#   `最新期業績税引後利益(千円)` &lt;dbl&gt;</code></pre>
</div>
<div id="step9_sanko" class="section level3" number="3.4.4">
<h3><span class="header-section-number">3.4.4</span> 参考：paste0</h3>
<ul>
<li><strong>paste0</strong>関数を使うと、paste関数で引数をsep = ""とするのと同様の結果を得ることができます</li>
</ul>
<div class="sourceCode" id="cb203"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb203-1"><a href="book_02_beginner_2nd_half.html#cb203-1" aria-hidden="true" tabindex="-1"></a><span class="fu">paste0</span>(<span class="st">&quot;神奈川県&quot;</span>, <span class="st">&quot;横浜市&quot;</span>)</span></code></pre></div>
<pre><code>[1] &quot;神奈川県横浜市&quot;</code></pre>
<div class="sourceCode" id="cb205"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb205-1"><a href="book_02_beginner_2nd_half.html#cb205-1" aria-hidden="true" tabindex="-1"></a>KEN <span class="ot">&lt;-</span> <span class="st">&quot;神奈川県&quot;</span></span>
<span id="cb205-2"><a href="book_02_beginner_2nd_half.html#cb205-2" aria-hidden="true" tabindex="-1"></a>CITY <span class="ot">&lt;-</span> <span class="st">&quot;横浜市&quot;</span></span>
<span id="cb205-3"><a href="book_02_beginner_2nd_half.html#cb205-3" aria-hidden="true" tabindex="-1"></a>TOWN <span class="ot">&lt;-</span> <span class="st">&quot;緑区&quot;</span></span>
<span id="cb205-4"><a href="book_02_beginner_2nd_half.html#cb205-4" aria-hidden="true" tabindex="-1"></a><span class="fu">paste0</span>(KEN, CITY, TOWN)</span></code></pre></div>
<pre><code>[1] &quot;神奈川県横浜市緑区&quot;</code></pre>
</div>
</div>
<div id="ステップ１０指標の作成" class="section level2" number="3.5">
<h2><span class="header-section-number">3.5</span> ステップ１０：指標の作成</h2>
<ul>
<li>mutate</li>
</ul>
<div id="sagyou_step10" class="section level3" number="3.5.1">
<h3><span class="header-section-number">3.5.1</span> 作業内容</h3>
<ul>
<li>指標として売上高利益率を算出します</li>
<li>売上高利益率の計算は、(利益÷売上高)×100です</li>
<li>利益と売上高の単位が揃っていないことに注意します</li>
<li>利益率はround関数で少数点以下2桁にします</li>
</ul>
<pre><code># A tibble: 887 x 11
   売上高利益率 `最新期業績税引後利益(千円)~ `最新期業績売上高(百万円)`~ 企業コード 本社所在地市区郡
          &lt;dbl&gt;            &lt;dbl&gt;            &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;           
 1        13.9            910536             6555 J31299770  13103_東京都港区
 2      1776.            1775694              100 E32002046  27123_大阪府大阪市淀川区~
 3         1.29           408523            31746 D42585413  13103_東京都港区
 4         0.76          2544502           334093 J39971897  13101_東京都千代田区~
 5         1.1            763986            69308 J93122775  14102_神奈川県横浜市神奈~
 6        58.4          31954410            54667 J34719839  13111_東京都大田区~
 7         6.93          7455793           107643 L12571447  23105_愛知県名古屋市中村~
 8         2.11          1387429            65714 D42395106  13103_東京都港区
 9         3.39          2149032            63388 J34594067  13103_東京都港区
10         1.32           530833            40125 E32304350  27126_大阪府大阪市平野区~
# ... with 877 more rows, and 6 more variables: 業種大分類 &lt;chr&gt;,
#   `資本金(千円)` &lt;dbl&gt;, 従業員数 &lt;dbl&gt;, 都道府県コード &lt;chr&gt;,
#   都道府県名 &lt;chr&gt;, 都道府県 &lt;chr&gt;</code></pre>
</div>
<div id="売上高利益率カラムの作成" class="section level3" number="3.5.2">
<h3><span class="header-section-number">3.5.2</span> 売上高利益率カラムの作成</h3>
<ul>
<li>売上高利益率カラムを追加したものをdata_5とします</li>
</ul>
<div class="sourceCode" id="cb208"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb208-1"><a href="book_02_beginner_2nd_half.html#cb208-1" aria-hidden="true" tabindex="-1"></a>data_5 <span class="ot">&lt;-</span> data_4 <span class="sc">%&gt;%</span> </span>
<span id="cb208-2"><a href="book_02_beginner_2nd_half.html#cb208-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(売上高利益率 <span class="ot">=</span></span>
<span id="cb208-3"><a href="book_02_beginner_2nd_half.html#cb208-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">最新期業績税引後利益(千円)</span><span class="st">`</span><span class="sc">/</span>(<span class="st">`</span><span class="at">最新期業績売上高(百万円)</span><span class="st">`</span><span class="sc">*</span><span class="dv">1000</span>)<span class="sc">*</span><span class="dv">100</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb208-4"><a href="book_02_beginner_2nd_half.html#cb208-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(売上高利益率 <span class="ot">=</span> <span class="fu">round</span>(売上高利益率, <span class="dv">2</span>))</span>
<span id="cb208-5"><a href="book_02_beginner_2nd_half.html#cb208-5" aria-hidden="true" tabindex="-1"></a>data_5 <span class="sc">%&gt;%</span> <span class="fu">relocate</span>(売上高利益率, <span class="st">`</span><span class="at">最新期業績税引後利益(千円)</span><span class="st">`</span>, <span class="st">`</span><span class="at">最新期業績売上高(百万円)</span><span class="st">`</span>)</span></code></pre></div>
<pre><code># A tibble: 887 x 11
   売上高利益率 `最新期業績税引後利益(千円)~ `最新期業績売上高(百万円)`~ 企業コード 本社所在地市区郡
          &lt;dbl&gt;            &lt;dbl&gt;            &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;           
 1        13.9            910536             6555 J31299770  13103_東京都港区
 2      1776.            1775694              100 E32002046  27123_大阪府大阪市淀川区~
 3         1.29           408523            31746 D42585413  13103_東京都港区
 4         0.76          2544502           334093 J39971897  13101_東京都千代田区~
 5         1.1            763986            69308 J93122775  14102_神奈川県横浜市神奈~
 6        58.4          31954410            54667 J34719839  13111_東京都大田区~
 7         6.93          7455793           107643 L12571447  23105_愛知県名古屋市中村~
 8         2.11          1387429            65714 D42395106  13103_東京都港区
 9         3.39          2149032            63388 J34594067  13103_東京都港区
10         1.32           530833            40125 E32304350  27126_大阪府大阪市平野区~
# ... with 877 more rows, and 6 more variables: 業種大分類 &lt;chr&gt;,
#   `資本金(千円)` &lt;dbl&gt;, 従業員数 &lt;dbl&gt;, 都道府県コード &lt;chr&gt;,
#   都道府県名 &lt;chr&gt;, 都道府県 &lt;chr&gt;</code></pre>
</div>
</div>
<div id="ステップ１１条件分岐処理" class="section level2" number="3.6">
<h2><span class="header-section-number">3.6</span> ステップ１１：条件分岐処理</h2>
<ul>
<li>if_else</li>
<li>ifelse</li>
<li>case_when</li>
</ul>
<div id="sagyou_step11" class="section level3" number="3.6.1">
<h3><span class="header-section-number">3.6.1</span> 作業内容</h3>
<ul>
<li>従業員数に応じて以下の4つのカテゴリを付与します</li>
</ul>
<table>
<thead>
<tr class="header">
<th align="left">従業員数の条件</th>
<th align="left">カテゴリ</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">0 &lt; 従業員数 ≦ 500</td>
<td align="left">01_500人以下</td>
</tr>
<tr class="even">
<td align="left">500 &lt; 従業員数 ≦ 1000</td>
<td align="left">02_1000人以下</td>
</tr>
<tr class="odd">
<td align="left">1000 ≦ 従業員数</td>
<td align="left">03_1000人超</td>
</tr>
<tr class="even">
<td align="left">その他</td>
<td align="left">99_不明</td>
</tr>
</tbody>
</table>
<ul>
<li>以下のように従業員数レンジが追加できたらOKです</li>
<li>これは条件分岐処理を用いて作成することができます</li>
</ul>
<pre><code># A tibble: 5 x 2
  従業員数 従業員数レンジ
     &lt;dbl&gt; &lt;chr&gt;         
1       64 01_500人以下  
2     1120 03_1000人超   
3      216 01_500人以下  
4    31059 03_1000人超   
5      314 01_500人以下  </code></pre>
<hr />
</div>
<div id="if_else_ifelse_case_when" class="section level3" number="3.6.2">
<h3><span class="header-section-number">3.6.2</span> if_else, ifelse, case_when</h3>
<ul>
<li>条件分岐処理を行う関数を3つ紹介します
<ul>
<li>if_else</li>
<li>ifelse</li>
<li>case_when</li>
</ul></li>
<li>上から順に処理速度が早いです</li>
<li>分岐させる条件が多いときは、case_whenを使うと可読性が高くなります</li>
</ul>
<p>はじめに簡単な数値例を用いて上記3つの関数の使い方を説明し、その後に従業員数レンジカラムの作成を行います。</p>
</div>
<div id="example_if_else_ifelse" class="section level3" number="3.6.3">
<h3><span class="header-section-number">3.6.3</span> if_else, ifelseの使用例</h3>
<ul>
<li>引数名が異なるだけで、記法はほとんど同じです</li>
<li>しかし次頁で説明するように、仕様が少しだけ違います</li>
</ul>
<div class="sourceCode" id="cb211"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb211-1"><a href="book_02_beginner_2nd_half.html#cb211-1" aria-hidden="true" tabindex="-1"></a><span class="co"># if_else と ifelse の 引数名</span></span>
<span id="cb211-2"><a href="book_02_beginner_2nd_half.html#cb211-2" aria-hidden="true" tabindex="-1"></a><span class="fu">if_else</span>(<span class="at">condition=</span> , <span class="at">true=</span> , <span class="at">false=</span> )</span>
<span id="cb211-3"><a href="book_02_beginner_2nd_half.html#cb211-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ifelse</span>(<span class="at">test=</span> , <span class="at">yes=</span> , <span class="at">no=</span> )</span></code></pre></div>
<div class="columns">
<div class="column" style="width:48%;">
<p><strong>if_else</strong></p>
<div class="sourceCode" id="cb212"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb212-1"><a href="book_02_beginner_2nd_half.html#cb212-1" aria-hidden="true" tabindex="-1"></a>tmp <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>)</span>
<span id="cb212-2"><a href="book_02_beginner_2nd_half.html#cb212-2" aria-hidden="true" tabindex="-1"></a><span class="fu">if_else</span>(tmp<span class="sc">==</span><span class="dv">2</span>, <span class="st">&quot;yes&quot;</span>,<span class="st">&quot;no&quot;</span>)</span></code></pre></div>
<pre><code>[1] &quot;no&quot;  &quot;yes&quot; &quot;no&quot; </code></pre>
</div><div class="column" style="width:2%;">

</div><div class="column" style="width:48%;">
<p><strong>ifelse</strong></p>
<div class="sourceCode" id="cb214"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb214-1"><a href="book_02_beginner_2nd_half.html#cb214-1" aria-hidden="true" tabindex="-1"></a>tmp <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>)</span>
<span id="cb214-2"><a href="book_02_beginner_2nd_half.html#cb214-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ifelse</span>(tmp<span class="sc">==</span><span class="dv">2</span>, <span class="st">&quot;yes&quot;</span>,<span class="st">&quot;no&quot;</span>)</span></code></pre></div>
<pre><code>[1] &quot;no&quot;  &quot;yes&quot; &quot;no&quot; </code></pre>
</div>
</div>
</div>
<div id="if_else_isbetter" class="section level3" number="3.6.4">
<h3><span class="header-section-number">3.6.4</span> <strong>if_else</strong>はifelseより厳格</h3>
<div class="columns">
<div class="column" style="width:48%;">
<div class="sourceCode" id="cb216"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb216-1"><a href="book_02_beginner_2nd_half.html#cb216-1" aria-hidden="true" tabindex="-1"></a><span class="fu">if_else</span>(tmp<span class="sc">==</span><span class="dv">2</span>, <span class="dv">2</span>, <span class="st">&quot;no&quot;</span>)</span></code></pre></div>
<pre><code>Error: `false` must be a double vector, not a character vector.</code></pre>
</div><div class="column" style="width:2%;">

</div><div class="column" style="width:48%;">
<div class="sourceCode" id="cb218"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb218-1"><a href="book_02_beginner_2nd_half.html#cb218-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ifelse</span>(tmp<span class="sc">==</span><span class="dv">2</span>, <span class="dv">2</span>, <span class="st">&quot;no&quot;</span>)</span></code></pre></div>
<pre><code>[1] &quot;no&quot; &quot;2&quot;  &quot;no&quot;</code></pre>
</div>
</div>
<ul>
<li><strong>if_else</strong>は返り値が<strong>同じ型</strong>でなければerrorが発生します
<ul>
<li>コンピュータにとっては値の型が最初から決まっている方が楽なので、if_elseはifelseよりも処理が早くなります</li>
</ul></li>
<li><strong>ifelse</strong>は返り値が<strong>異なる型</strong>でも動きます
<ul>
<li>結果を見ると、2が文字列に変換されています</li>
<li>errorやmessageは出ませんが、返り値の型が自動で変換されてしまうので注意が必要です</li>
</ul></li>
</ul>
<p>本資料ではif_elseを使うことを推奨します。</p>
</div>
<div id="case_whenの使用例" class="section level3" number="3.6.5">
<h3><span class="header-section-number">3.6.5</span> case_whenの使用例</h3>
<div class="columns">
<div class="column" style="width:48%;">
<div class="sourceCode" id="cb220"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb220-1"><a href="book_02_beginner_2nd_half.html#cb220-1" aria-hidden="true" tabindex="-1"></a><span class="fu">case_when</span>(</span>
<span id="cb220-2"><a href="book_02_beginner_2nd_half.html#cb220-2" aria-hidden="true" tabindex="-1"></a>  条件式 <span class="sc">~</span> 返り値,</span>
<span id="cb220-3"><a href="book_02_beginner_2nd_half.html#cb220-3" aria-hidden="true" tabindex="-1"></a>  条件式 <span class="sc">~</span> 返り値,</span>
<span id="cb220-4"><a href="book_02_beginner_2nd_half.html#cb220-4" aria-hidden="true" tabindex="-1"></a>  条件式 <span class="sc">~</span> 返り値,</span>
<span id="cb220-5"><a href="book_02_beginner_2nd_half.html#cb220-5" aria-hidden="true" tabindex="-1"></a>  ...</span>
<span id="cb220-6"><a href="book_02_beginner_2nd_half.html#cb220-6" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
</div><div class="column" style="width:2%;">

</div><div class="column" style="width:48%;">
<div class="sourceCode" id="cb221"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb221-1"><a href="book_02_beginner_2nd_half.html#cb221-1" aria-hidden="true" tabindex="-1"></a>tmp <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>)</span>
<span id="cb221-2"><a href="book_02_beginner_2nd_half.html#cb221-2" aria-hidden="true" tabindex="-1"></a><span class="fu">case_when</span>(</span>
<span id="cb221-3"><a href="book_02_beginner_2nd_half.html#cb221-3" aria-hidden="true" tabindex="-1"></a>  tmp <span class="sc">==</span> <span class="dv">1</span> <span class="sc">~</span> <span class="st">&quot;one&quot;</span>,</span>
<span id="cb221-4"><a href="book_02_beginner_2nd_half.html#cb221-4" aria-hidden="true" tabindex="-1"></a>  tmp <span class="sc">==</span> <span class="dv">2</span> <span class="sc">~</span> <span class="st">&quot;two&quot;</span>,</span>
<span id="cb221-5"><a href="book_02_beginner_2nd_half.html#cb221-5" aria-hidden="true" tabindex="-1"></a>  <span class="cn">TRUE</span> <span class="sc">~</span> <span class="fu">as.character</span>(<span class="cn">NA</span>)</span>
<span id="cb221-6"><a href="book_02_beginner_2nd_half.html#cb221-6" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div>
<pre><code>[1] &quot;one&quot; &quot;two&quot; NA   </code></pre>
</div>
</div>
<ul>
<li>上記のようにして条件式と返り値を複数記述できます</li>
<li>上にある条件式から優先的に値が返ります</li>
<li>if_elseと同様に、返り値は同じ型にします</li>
<li>どの条件式にも引っかからない場合はNAが返ります
<ul>
<li>したがって、最後の条件は無条件にTRUEとすることがあります</li>
</ul></li>
</ul>
</div>
<div id="if_else_ver" class="section level3" number="3.6.6">
<h3><span class="header-section-number">3.6.6</span> 従業員数レンジカラム作成(if_else)</h3>
<ul>
<li>if_elseの場合は、条件式に偽となった値にさらに条件分岐をかけることで、条件分岐の階層構造を作ります</li>
</ul>
<div class="sourceCode" id="cb223"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb223-1"><a href="book_02_beginner_2nd_half.html#cb223-1" aria-hidden="true" tabindex="-1"></a>data_5 <span class="sc">%&gt;%</span></span>
<span id="cb223-2"><a href="book_02_beginner_2nd_half.html#cb223-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(従業員数レンジ <span class="ot">=</span> </span>
<span id="cb223-3"><a href="book_02_beginner_2nd_half.html#cb223-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">if_else</span>(   <span class="dv">0</span> <span class="sc">&lt;=</span> 従業員数 <span class="sc">&amp;</span> 従業員数 <span class="sc">&lt;=</span> <span class="dv">500</span>, <span class="st">&quot;01_500人以下&quot;</span>,</span>
<span id="cb223-4"><a href="book_02_beginner_2nd_half.html#cb223-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">if_else</span>( <span class="dv">500</span> <span class="sc">&lt;=</span> 従業員数 <span class="sc">&amp;</span> 従業員数 <span class="sc">&lt;=</span> <span class="dv">1000</span>, <span class="st">&quot;02_1000人以下&quot;</span>,</span>
<span id="cb223-5"><a href="book_02_beginner_2nd_half.html#cb223-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">if_else</span>(<span class="dv">1000</span> <span class="sc">&lt;=</span> 従業員数, <span class="st">&quot;03_1000人超&quot;</span>, <span class="st">&quot;99_不明&quot;</span>)))) <span class="sc">%&gt;%</span> </span>
<span id="cb223-6"><a href="book_02_beginner_2nd_half.html#cb223-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(従業員数レンジ, 従業員数)</span></code></pre></div>
<pre><code># A tibble: 887 x 12
   従業員数レンジ 従業員数 企業コード 本社所在地市区郡 業種大分類
   &lt;chr&gt;             &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;            &lt;chr&gt;     
 1 01_500人以下         64 J31299770  13103_東京都港区 I:不動産業
 2 03_1000人超        1120 E32002046  27123_大阪府大阪市淀川区~ L:サービス業~
 3 01_500人以下        216 D42585413  13103_東京都港区 J:運輸・通信業~
 4 03_1000人超       31059 J39971897  13101_東京都千代田区~ L:サービス業~
 5 01_500人以下        314 J93122775  14102_神奈川県横浜市神奈~ F:製造業  
 6 03_1000人超        1167 J34719839  13111_東京都大田区~ F:製造業  
 7 02_1000人以下       880 L12571447  23105_愛知県名古屋市中村~ G:卸売・小売業，~
 8 03_1000人超        1555 D42395106  13103_東京都港区 G:卸売・小売業，~
 9 01_500人以下        452 J34594067  13103_東京都港区 E:建設業  
10 02_1000人以下       801 E32304350  27126_大阪府大阪市平野区~ F:製造業  
# ... with 877 more rows, and 7 more variables: `資本金(千円)` &lt;dbl&gt;,
#   `最新期業績売上高(百万円)` &lt;dbl&gt;, `最新期業績税引後利益(千円)` &lt;dbl&gt;,
#   都道府県コード &lt;chr&gt;, 都道府県名 &lt;chr&gt;, 都道府県 &lt;chr&gt;,
#   売上高利益率 &lt;dbl&gt;</code></pre>
</div>
<div id="case_when_ver" class="section level3" number="3.6.7">
<h3><span class="header-section-number">3.6.7</span> 従業員数レンジカラム作成(case_when)</h3>
<ul>
<li>今回のように複数分岐の場合、case_whenが便利です</li>
<li>結果は先ほどと同じなので省略します</li>
<li>従業員数レンジを追加したデータをdata_6とします</li>
</ul>
<div class="sourceCode" id="cb225"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb225-1"><a href="book_02_beginner_2nd_half.html#cb225-1" aria-hidden="true" tabindex="-1"></a>data_6 <span class="ot">&lt;-</span> data_5 <span class="sc">%&gt;%</span> </span>
<span id="cb225-2"><a href="book_02_beginner_2nd_half.html#cb225-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(従業員数レンジ <span class="ot">=</span> <span class="fu">case_when</span>(</span>
<span id="cb225-3"><a href="book_02_beginner_2nd_half.html#cb225-3" aria-hidden="true" tabindex="-1"></a>       <span class="dv">0</span> <span class="sc">&lt;=</span> 従業員数 <span class="sc">&amp;</span> 従業員数 <span class="sc">&lt;=</span> <span class="dv">500</span>  <span class="sc">~</span> <span class="st">&quot;01_500人以下&quot;</span>,</span>
<span id="cb225-4"><a href="book_02_beginner_2nd_half.html#cb225-4" aria-hidden="true" tabindex="-1"></a>     <span class="dv">500</span> <span class="sc">&lt;=</span> 従業員数 <span class="sc">&amp;</span> 従業員数 <span class="sc">&lt;=</span> <span class="dv">1000</span> <span class="sc">~</span> <span class="st">&quot;02_1000人以下&quot;</span>,</span>
<span id="cb225-5"><a href="book_02_beginner_2nd_half.html#cb225-5" aria-hidden="true" tabindex="-1"></a>    <span class="dv">1000</span> <span class="sc">&lt;=</span> 従業員数                   <span class="sc">~</span> <span class="st">&quot;03_1000人超&quot;</span>,</span>
<span id="cb225-6"><a href="book_02_beginner_2nd_half.html#cb225-6" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span>                            <span class="sc">~</span> <span class="st">&quot;99_不明&quot;</span></span>
<span id="cb225-7"><a href="book_02_beginner_2nd_half.html#cb225-7" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb225-8"><a href="book_02_beginner_2nd_half.html#cb225-8" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div>
</div>
<div id="step11_sanko" class="section level3" number="3.6.8">
<h3><span class="header-section-number">3.6.8</span> 参考：条件式</h3>
<div class="columns">
<div class="column" style="width:40%;">
<table>
<thead>
<tr class="header">
<th align="center">記号</th>
<th align="left">意味</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">==</td>
<td align="left">イコール</td>
</tr>
<tr class="even">
<td align="center">!=</td>
<td align="left">ノットイコール</td>
</tr>
<tr class="odd">
<td align="center">&lt;</td>
<td align="left">未満</td>
</tr>
<tr class="even">
<td align="center">&gt;</td>
<td align="left">超過</td>
</tr>
<tr class="odd">
<td align="center">&gt;=</td>
<td align="left">以上</td>
</tr>
<tr class="even">
<td align="center">&lt;=</td>
<td align="left">以下</td>
</tr>
</tbody>
</table>
</div><div class="column" style="width:1%;">

</div><div class="column" style="width:30%;">
<table>
<thead>
<tr class="header">
<th align="left">関数</th>
<th align="left">判定</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">is.na()</td>
<td align="left">NA</td>
</tr>
<tr class="even">
<td align="left">is.null()</td>
<td align="left">NULL</td>
</tr>
<tr class="odd">
<td align="left">is.nan()</td>
<td align="left">NaN</td>
</tr>
<tr class="even">
<td align="left">is.infinite()</td>
<td align="left">Inf</td>
</tr>
<tr class="odd">
<td align="left">is.integer()</td>
<td align="left">整数</td>
</tr>
<tr class="even">
<td align="left">is.double()</td>
<td align="left">少数</td>
</tr>
</tbody>
</table>
</div><div class="column" style="width:1%;">

</div><div class="column" style="width:30%;">
<table>
<thead>
<tr class="header">
<th align="center">記号</th>
<th align="left">意味</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">!</td>
<td align="left">not</td>
</tr>
<tr class="even">
<td align="center">&amp;</td>
<td align="left">and</td>
</tr>
<tr class="odd">
<td align="center">|</td>
<td align="left">or</td>
</tr>
<tr class="even">
<td align="center">%in%</td>
<td align="left">in</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>例）<strong>%in%</strong>はとても便利なので覚えましょう。</p>
<div class="sourceCode" id="cb226"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb226-1"><a href="book_02_beginner_2nd_half.html#cb226-1" aria-hidden="true" tabindex="-1"></a><span class="co"># %in%の後ろのベクトルに値が含まれていたらTRUE</span></span>
<span id="cb226-2"><a href="book_02_beginner_2nd_half.html#cb226-2" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(<span class="st">&quot;滋賀&quot;</span>, <span class="st">&quot;彦根&quot;</span>) <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;日本&quot;</span>, <span class="st">&quot;滋賀&quot;</span>, <span class="st">&quot;米原&quot;</span>)</span></code></pre></div>
<pre><code>[1]  TRUE FALSE</code></pre>
</div>
</div>
<div id="ステップ１２ソート" class="section level2" number="3.7">
<h2><span class="header-section-number">3.7</span> ステップ１２：ソート</h2>
<ul>
<li>arrange</li>
</ul>
<div id="sagyou_step12" class="section level3" number="3.7.1">
<h3><span class="header-section-number">3.7.1</span> 作業内容</h3>
<ul>
<li>データをソートをします
<ul>
<li>はじめに都道府県で<strong>昇順</strong>ソートをし、</li>
<li>つぎに都道府県内での従業員数レンジで<strong>昇順</strong>ソートをし、</li>
<li>さいごに上記のうちから売上高利益率で<strong>降順</strong>ソートします</li>
</ul></li>
</ul>
<pre><code># A tibble: 887 x 12
   都道府県 従業員数レンジ 売上高利益率 企業コード 本社所在地市区郡 業種大分類
   &lt;chr&gt;    &lt;chr&gt;                 &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;            &lt;chr&gt;     
 1 01_北海道~ 01_500人以下          3.41  G92668203  01104_北海道札幌市白石区~ G:卸売・小売業，~
 2 01_北海道~ 01_500人以下          0.49  G92515950  01105_北海道札幌市豊平区~ F:製造業  
 3 01_北海道~ 02_1000人以下         5.05  G22109363  01203_北海道小樽市~ J:運輸・通信業~
 4 01_北海道~ 02_1000人以下         3.18  G92543356  01101_北海道札幌市中央区~ E:建設業  
 5 01_北海道~ 02_1000人以下         0.570 G92412006  01101_北海道札幌市中央区~ G:卸売・小売業，~
 6 02_青森県~ 01_500人以下          0.96  H02154711  02202_青森県弘前市~ G:卸売・小売業，~
 7 02_青森県~ 02_1000人以下         0.45  H92112963  02203_青森県八戸市~ G:卸売・小売業，~
 8 04_宮城県~ 01_500人以下          3.77  H42536370  04102_宮城県仙台市宮城野~ G:卸売・小売業，~
 9 04_宮城県~ 01_500人以下          0.86  H42053936  04104_宮城県仙台市太白区~ G:卸売・小売業，~
10 04_宮城県~ 02_1000人以下         9.45  H42127369  04102_宮城県仙台市宮城野~ G:卸売・小売業，~
# ... with 877 more rows, and 6 more variables: `資本金(千円)` &lt;dbl&gt;,
#   従業員数 &lt;dbl&gt;, `最新期業績売上高(百万円)` &lt;dbl&gt;,
#   `最新期業績税引後利益(千円)` &lt;dbl&gt;, 都道府県コード &lt;chr&gt;,
#   都道府県名 &lt;chr&gt;</code></pre>
</div>
<div id="arrangeでソート" class="section level3" number="3.7.2">
<h3><span class="header-section-number">3.7.2</span> <strong>arrange</strong>でソート</h3>
<ul>
<li>ソートしたいカラムをarrangeの引数に指定します</li>
<li><strong>デフォルトは昇順</strong>で、<strong>desc関数</strong>で降順になります</li>
</ul>
<div class="columns">
<div class="column" style="width:48%;">
<div class="sourceCode" id="cb229"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb229-1"><a href="book_02_beginner_2nd_half.html#cb229-1" aria-hidden="true" tabindex="-1"></a>data_6 <span class="sc">%&gt;%</span> <span class="co"># 昇順</span></span>
<span id="cb229-2"><a href="book_02_beginner_2nd_half.html#cb229-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(都道府県) <span class="sc">%&gt;%</span></span>
<span id="cb229-3"><a href="book_02_beginner_2nd_half.html#cb229-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(都道府県)</span></code></pre></div>
<pre><code># A tibble: 887 x 12
   都道府県 企業コード 本社所在地市区郡 業種大分類 `資本金(千円)` 従業員数
   &lt;chr&gt;    &lt;chr&gt;      &lt;chr&gt;            &lt;chr&gt;               &lt;dbl&gt;    &lt;dbl&gt;
 1 01_北海道~ G22109363  01203_北海道小樽市~ J:運輸・通信業~        1590700      807
 2 01_北海道~ G92412006  01101_北海道札幌市中央区~ G:卸売・小売業，~        1748600      606
 3 01_北海道~ G92515950  01105_北海道札幌市豊平区~ F:製造業           399000      435
 4 01_北海道~ G92543356  01101_北海道札幌市中央区~ E:建設業           252800      903
 5 01_北海道~ G92668203  01104_北海道札幌市白石区~ G:卸売・小売業，~        9316300      455
 6 02_青森県~ H02154711  02202_青森県弘前市~ G:卸売・小売業，~        1247000      288
 7 02_青森県~ H92112963  02203_青森県八戸市~ G:卸売・小売業，~        4006200      571
 8 04_宮城県~ H42150036  04101_宮城県仙台市青葉区~ K:電気・ガス・水~      418451700     5308
 9 04_宮城県~ H42127369  04102_宮城県仙台市宮城野~ G:卸売・小売業，~        1065600      892
10 04_宮城県~ H42536370  04102_宮城県仙台市宮城野~ G:卸売・小売業，~              1      303
# ... with 877 more rows, and 6 more variables:
#   `最新期業績売上高(百万円)` &lt;dbl&gt;, `最新期業績税引後利益(千円)` &lt;dbl&gt;,
#   都道府県コード &lt;chr&gt;, 都道府県名 &lt;chr&gt;, 売上高利益率 &lt;dbl&gt;,
#   従業員数レンジ &lt;chr&gt;</code></pre>
</div><div class="column" style="width:2%;">

</div><div class="column" style="width:48%;">
<div class="sourceCode" id="cb231"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb231-1"><a href="book_02_beginner_2nd_half.html#cb231-1" aria-hidden="true" tabindex="-1"></a>data_6 <span class="sc">%&gt;%</span> <span class="co"># 降順</span></span>
<span id="cb231-2"><a href="book_02_beginner_2nd_half.html#cb231-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(都道府県))<span class="sc">%&gt;%</span></span>
<span id="cb231-3"><a href="book_02_beginner_2nd_half.html#cb231-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(都道府県)</span></code></pre></div>
<pre><code># A tibble: 887 x 12
   都道府県 企業コード 本社所在地市区郡 業種大分類 `資本金(千円)` 従業員数
   &lt;chr&gt;    &lt;chr&gt;      &lt;chr&gt;            &lt;chr&gt;               &lt;dbl&gt;    &lt;dbl&gt;
 1 47_沖縄県~ J42113831  47208_沖縄県浦添市~ K:電気・ガス・水~       11473100     1823
 2 46_鹿児島県~ C72124439  46201_鹿児島県鹿児島市~ F:製造業           307700      551
 3 45_宮崎県~ C32118312  45202_宮崎県都城市~ G:卸売・小売業，~        1362500      300
 4 43_熊本県~ C82153425  43105_熊本県熊本市北区~ F:製造業          3261100     1649
 5 40_福岡県~ C42110360  40132_福岡県福岡市博多区~ L:サービス業~        2198900      194
 6 40_福岡県~ C42151200  40133_福岡県福岡市中央区~ E:建設業          2535100      211
 7 40_福岡県~ C92114080  40106_福岡県北九州市小倉~ G:卸売・小売業，~        8148900      457
 8 40_福岡県~ C92180151  40109_福岡県北九州市八幡~ F:製造業         26955300     2463
 9 40_福岡県~ C92532200  40109_福岡県北九州市八幡~ L:サービス業~          95400      538
10 40_福岡県~ C42151408  40134_福岡県福岡市南区~ E:建設業          2698300    11268
# ... with 877 more rows, and 6 more variables:
#   `最新期業績売上高(百万円)` &lt;dbl&gt;, `最新期業績税引後利益(千円)` &lt;dbl&gt;,
#   都道府県コード &lt;chr&gt;, 都道府県名 &lt;chr&gt;, 売上高利益率 &lt;dbl&gt;,
#   従業員数レンジ &lt;chr&gt;</code></pre>
</div>
</div>
</div>
<div id="複数カラムでソート" class="section level3" number="3.7.3">
<h3><span class="header-section-number">3.7.3</span> 複数カラムでソート</h3>
<ul>
<li>都道府県で昇順ソートし、都道府県内で売上高利益率を降順ソートする場合は以下のように書きます</li>
</ul>
<div class="sourceCode" id="cb233"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb233-1"><a href="book_02_beginner_2nd_half.html#cb233-1" aria-hidden="true" tabindex="-1"></a>data_6 <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(都道府県, <span class="fu">desc</span>(売上高利益率))</span></code></pre></div>
<div class="columns">
<div class="column" style="width:48%;">
<p><strong>ソート前</strong></p>
<pre><code># A tibble: 887 x 12
   都道府県 売上高利益率 企業コード 本社所在地市区郡 業種大分類 `資本金(千円)`
   &lt;chr&gt;           &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;            &lt;chr&gt;               &lt;dbl&gt;
 1 13_東京都~        13.9  J31299770  13103_東京都港区 I:不動産業         931300
 2 27_大阪府~      1776.   E32002046  27123_大阪府大阪市淀川区~ L:サービス業~        1098300
 3 13_東京都~         1.29 D42585413  13103_東京都港区 J:運輸・通信業~        6120900
 4 13_東京都~         0.76 J39971897  13101_東京都千代田区~ L:サービス業~       15432800
 5 14_神奈川県~         1.1  J93122775  14102_神奈川県横浜市神奈~ F:製造業          9904900
 6 13_東京都~        58.4  J34719839  13111_東京都大田区~ F:製造業         27761400
 7 23_愛知県~         6.93 L12571447  23105_愛知県名古屋市中村~ G:卸売・小売業，~         131800
 8 13_東京都~         2.11 D42395106  13103_東京都港区 G:卸売・小売業，~        1523000
 9 13_東京都~         3.39 J34594067  13103_東京都港区 E:建設業          8297700
10 27_大阪府~         1.32 E32304350  27126_大阪府大阪市平野区~ F:製造業           458000
# ... with 877 more rows, and 6 more variables: 従業員数 &lt;dbl&gt;,
#   `最新期業績売上高(百万円)` &lt;dbl&gt;, `最新期業績税引後利益(千円)` &lt;dbl&gt;,
#   都道府県コード &lt;chr&gt;, 都道府県名 &lt;chr&gt;, 従業員数レンジ &lt;chr&gt;</code></pre>
</div><div class="column" style="width:2%;">

</div><div class="column" style="width:48%;">
<p><strong>ソート後</strong></p>
<pre><code># A tibble: 887 x 12
   都道府県 売上高利益率 企業コード 本社所在地市区郡 業種大分類 `資本金(千円)`
   &lt;chr&gt;           &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;            &lt;chr&gt;               &lt;dbl&gt;
 1 01_北海道~        5.05  G22109363  01203_北海道小樽市~ J:運輸・通信業~        1590700
 2 01_北海道~        3.41  G92668203  01104_北海道札幌市白石区~ G:卸売・小売業，~        9316300
 3 01_北海道~        3.18  G92543356  01101_北海道札幌市中央区~ E:建設業           252800
 4 01_北海道~        0.570 G92412006  01101_北海道札幌市中央区~ G:卸売・小売業，~        1748600
 5 01_北海道~        0.49  G92515950  01105_北海道札幌市豊平区~ F:製造業           399000
 6 02_青森県~        0.96  H02154711  02202_青森県弘前市~ G:卸売・小売業，~        1247000
 7 02_青森県~        0.45  H92112963  02203_青森県八戸市~ G:卸売・小売業，~        4006200
 8 04_宮城県~        9.45  H42127369  04102_宮城県仙台市宮城野~ G:卸売・小売業，~        1065600
 9 04_宮城県~        4.93  H42150249  04102_宮城県仙台市宮城野~ E:建設業         14733200
10 04_宮城県~        4.45  H42150036  04101_宮城県仙台市青葉区~ K:電気・ガス・水~      418451700
# ... with 877 more rows, and 6 more variables: 従業員数 &lt;dbl&gt;,
#   `最新期業績売上高(百万円)` &lt;dbl&gt;, `最新期業績税引後利益(千円)` &lt;dbl&gt;,
#   都道府県コード &lt;chr&gt;, 都道府県名 &lt;chr&gt;, 従業員数レンジ &lt;chr&gt;</code></pre>
</div>
</div>
<hr />
<ul>
<li>では3つの組み合わせでソートしましょう
<ul>
<li>都道府県で<strong>昇順</strong>、従業員数レンジで<strong>昇順</strong>、売上高利益率で<strong>降順</strong>の順番で組み合わせてソートします</li>
</ul></li>
<li>ソートしたデータをdata_7とします</li>
</ul>
<div class="sourceCode" id="cb236"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb236-1"><a href="book_02_beginner_2nd_half.html#cb236-1" aria-hidden="true" tabindex="-1"></a>data_7 <span class="ot">&lt;-</span> data_6 <span class="sc">%&gt;%</span></span>
<span id="cb236-2"><a href="book_02_beginner_2nd_half.html#cb236-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(都道府県, 従業員数レンジ, <span class="fu">desc</span>(売上高利益率))</span>
<span id="cb236-3"><a href="book_02_beginner_2nd_half.html#cb236-3" aria-hidden="true" tabindex="-1"></a>data_7 <span class="sc">%&gt;%</span> <span class="fu">relocate</span>(都道府県, 従業員数レンジ, 売上高利益率)</span></code></pre></div>
<pre><code># A tibble: 887 x 12
   都道府県 従業員数レンジ 売上高利益率 企業コード 本社所在地市区郡 業種大分類
   &lt;chr&gt;    &lt;chr&gt;                 &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;            &lt;chr&gt;     
 1 01_北海道~ 01_500人以下          3.41  G92668203  01104_北海道札幌市白石区~ G:卸売・小売業，~
 2 01_北海道~ 01_500人以下          0.49  G92515950  01105_北海道札幌市豊平区~ F:製造業  
 3 01_北海道~ 02_1000人以下         5.05  G22109363  01203_北海道小樽市~ J:運輸・通信業~
 4 01_北海道~ 02_1000人以下         3.18  G92543356  01101_北海道札幌市中央区~ E:建設業  
 5 01_北海道~ 02_1000人以下         0.570 G92412006  01101_北海道札幌市中央区~ G:卸売・小売業，~
 6 02_青森県~ 01_500人以下          0.96  H02154711  02202_青森県弘前市~ G:卸売・小売業，~
 7 02_青森県~ 02_1000人以下         0.45  H92112963  02203_青森県八戸市~ G:卸売・小売業，~
 8 04_宮城県~ 01_500人以下          3.77  H42536370  04102_宮城県仙台市宮城野~ G:卸売・小売業，~
 9 04_宮城県~ 01_500人以下          0.86  H42053936  04104_宮城県仙台市太白区~ G:卸売・小売業，~
10 04_宮城県~ 02_1000人以下         9.45  H42127369  04102_宮城県仙台市宮城野~ G:卸売・小売業，~
# ... with 877 more rows, and 6 more variables: `資本金(千円)` &lt;dbl&gt;,
#   従業員数 &lt;dbl&gt;, `最新期業績売上高(百万円)` &lt;dbl&gt;,
#   `最新期業績税引後利益(千円)` &lt;dbl&gt;, 都道府県コード &lt;chr&gt;,
#   都道府県名 &lt;chr&gt;</code></pre>
</div>
</div>
<div id="ステップ１３グループ集計" class="section level2" number="3.8">
<h2><span class="header-section-number">3.8</span> ステップ１３：グループ集計</h2>
<ul>
<li>group_by</li>
<li>summarise</li>
</ul>
<div id="sagyou_step13" class="section level3" number="3.8.1">
<h3><span class="header-section-number">3.8.1</span> 作業内容</h3>
<ul>
<li><strong>group_by</strong>と<strong>summarise</strong>での集計方法を習得します</li>
</ul>
<div class="sourceCode" id="cb238"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb238-1"><a href="book_02_beginner_2nd_half.html#cb238-1" aria-hidden="true" tabindex="-1"></a>data_7 <span class="sc">%&gt;%</span> </span>
<span id="cb238-2"><a href="book_02_beginner_2nd_half.html#cb238-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(都道府県, 従業員数レンジ) <span class="sc">%&gt;%</span> </span>
<span id="cb238-3"><a href="book_02_beginner_2nd_half.html#cb238-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">count =</span> <span class="fu">n</span>(),         <span class="at">sum =</span> <span class="fu">sum</span>(従業員数),</span>
<span id="cb238-4"><a href="book_02_beginner_2nd_half.html#cb238-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">mean =</span> <span class="fu">mean</span>(従業員数), <span class="at">max =</span> <span class="fu">max</span>(従業員数))</span></code></pre></div>
<pre><code># A tibble: 83 x 6
# Groups:   都道府県 [38]
   都道府県  従業員数レンジ count   sum  mean   max
   &lt;chr&gt;     &lt;chr&gt;          &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
 1 01_北海道 01_500人以下       2   890  445    455
 2 01_北海道 02_1000人以下      3  2316  772    903
 3 02_青森県 01_500人以下       1   288  288    288
 4 02_青森県 02_1000人以下      1   571  571    571
 5 04_宮城県 01_500人以下       2   471  236.   303
 6 04_宮城県 02_1000人以下      1   892  892    892
 7 04_宮城県 03_1000人超        2 10454 5227   5308
 8 07_福島県 01_500人以下       1   192  192    192
 9 08_茨城県 02_1000人以下      1   525  525    525
10 08_茨城県 03_1000人超        2  4315 2158.  2463
# ... with 73 more rows</code></pre>
</div>
<div id="how_group_summarise" class="section level3" number="3.8.2">
<h3><span class="header-section-number">3.8.2</span> <strong>group_by</strong>と<strong>summarise</strong>での集計方法</h3>
<ul>
<li>ここでは都道府県ごとにグループ化して、都道府県ごとの従業員数の平均値を算出します</li>
<li>group_byの引数にグループ化する変数を与えます</li>
<li>summariseはmutateと同様に書き、集計値を算出します</li>
</ul>
<div class="columns">
<div class="column" style="width:48%;">
<div class="sourceCode" id="cb240"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb240-1"><a href="book_02_beginner_2nd_half.html#cb240-1" aria-hidden="true" tabindex="-1"></a>data_7 <span class="sc">%&gt;%</span> </span>
<span id="cb240-2"><a href="book_02_beginner_2nd_half.html#cb240-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(都道府県) <span class="sc">%&gt;%</span></span>
<span id="cb240-3"><a href="book_02_beginner_2nd_half.html#cb240-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb240-4"><a href="book_02_beginner_2nd_half.html#cb240-4" aria-hidden="true" tabindex="-1"></a>   従業員数平均<span class="ot">=</span><span class="fu">mean</span>(従業員数)</span>
<span id="cb240-5"><a href="book_02_beginner_2nd_half.html#cb240-5" aria-hidden="true" tabindex="-1"></a>    )</span></code></pre></div>
</div><div class="column" style="width:2%;">

</div><div class="column" style="width:48%;">
<pre><code># A tibble: 38 x 2
   都道府県  従業員数平均
 * &lt;chr&gt;            &lt;dbl&gt;
 1 01_北海道         641.
 2 02_青森県         430.
 3 04_宮城県        2363.
 4 07_福島県         192 
 5 08_茨城県        1613.
 6 09_栃木県         178 
 7 10_群馬県        1118.
 8 11_埼玉県         928.
 9 12_千葉県         873.
10 13_東京都        1545.
# ... with 28 more rows</code></pre>
</div>
</div>
</div>
<div id="複数カラムでグループ集計" class="section level3" number="3.8.3">
<h3><span class="header-section-number">3.8.3</span> 複数カラムでグループ集計</h3>
<ul>
<li>group_byの引数にカラム名を複数与えることで、複数グループでの集計ができるようになります</li>
</ul>
<div class="sourceCode" id="cb242"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb242-1"><a href="book_02_beginner_2nd_half.html#cb242-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 都道府県かつ従業員数レンジごとに従業員数平均を算出</span></span>
<span id="cb242-2"><a href="book_02_beginner_2nd_half.html#cb242-2" aria-hidden="true" tabindex="-1"></a>data_7 <span class="sc">%&gt;%</span> </span>
<span id="cb242-3"><a href="book_02_beginner_2nd_half.html#cb242-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(都道府県, 従業員数レンジ) <span class="sc">%&gt;%</span> </span>
<span id="cb242-4"><a href="book_02_beginner_2nd_half.html#cb242-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(従業員数平均 <span class="ot">=</span> <span class="fu">mean</span>(従業員数))</span></code></pre></div>
<pre><code># A tibble: 83 x 3
# Groups:   都道府県 [38]
   都道府県  従業員数レンジ 従業員数平均
   &lt;chr&gt;     &lt;chr&gt;                 &lt;dbl&gt;
 1 01_北海道 01_500人以下           445 
 2 01_北海道 02_1000人以下          772 
 3 02_青森県 01_500人以下           288 
 4 02_青森県 02_1000人以下          571 
 5 04_宮城県 01_500人以下           236.
 6 04_宮城県 02_1000人以下          892 
 7 04_宮城県 03_1000人超           5227 
 8 07_福島県 01_500人以下           192 
 9 08_茨城県 02_1000人以下          525 
10 08_茨城県 03_1000人超           2158.
# ... with 73 more rows</code></pre>
</div>
<div id="step13_sanko1" class="section level3" number="3.8.4">
<h3><span class="header-section-number">3.8.4</span> 参考１：mutateとの違い</h3>
<ul>
<li>mutateでは既存のtibbleに対してグループ集計値が格納されるので、同じ値が複数行に入ります</li>
</ul>
<div class="sourceCode" id="cb244"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb244-1"><a href="book_02_beginner_2nd_half.html#cb244-1" aria-hidden="true" tabindex="-1"></a>data_7 <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(都道府県, 従業員数レンジ) <span class="sc">%&gt;%</span> </span>
<span id="cb244-2"><a href="book_02_beginner_2nd_half.html#cb244-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(従業員数平均 <span class="ot">=</span> <span class="fu">mean</span>(従業員数)) <span class="sc">%&gt;%</span> </span>
<span id="cb244-3"><a href="book_02_beginner_2nd_half.html#cb244-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(都道府県, 従業員数レンジ, 従業員数平均, 従業員数)</span></code></pre></div>
<pre><code># A tibble: 887 x 13
# Groups:   都道府県, 従業員数レンジ [83]
   都道府県 従業員数レンジ 従業員数平均 従業員数 企業コード 本社所在地市区郡
   &lt;chr&gt;    &lt;chr&gt;                 &lt;dbl&gt;    &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;           
 1 01_北海道~ 01_500人以下           445       455 G92668203  01104_北海道札幌市白石区~
 2 01_北海道~ 01_500人以下           445       435 G92515950  01105_北海道札幌市豊平区~
 3 01_北海道~ 02_1000人以下          772       807 G22109363  01203_北海道小樽市~
 4 01_北海道~ 02_1000人以下          772       903 G92543356  01101_北海道札幌市中央区~
 5 01_北海道~ 02_1000人以下          772       606 G92412006  01101_北海道札幌市中央区~
 6 02_青森県~ 01_500人以下           288       288 H02154711  02202_青森県弘前市~
 7 02_青森県~ 02_1000人以下          571       571 H92112963  02203_青森県八戸市~
 8 04_宮城県~ 01_500人以下           236.      303 H42536370  04102_宮城県仙台市宮城野~
 9 04_宮城県~ 01_500人以下           236.      168 H42053936  04104_宮城県仙台市太白区~
10 04_宮城県~ 02_1000人以下          892       892 H42127369  04102_宮城県仙台市宮城野~
# ... with 877 more rows, and 7 more variables: 業種大分類 &lt;chr&gt;,
#   `資本金(千円)` &lt;dbl&gt;, `最新期業績売上高(百万円)` &lt;dbl&gt;,
#   `最新期業績税引後利益(千円)` &lt;dbl&gt;, 都道府県コード &lt;chr&gt;,
#   都道府県名 &lt;chr&gt;, 売上高利益率 &lt;dbl&gt;</code></pre>
</div>
<div id="step13_sanko2" class="section level3" number="3.8.5">
<h3><span class="header-section-number">3.8.5</span> 参考２：グループごとのレコード数を集計</h3>
<ul>
<li>summariseで<strong>n()</strong>を用いてレコード数を集計できます</li>
<li><strong>n()</strong>はsummariseの中で使える特殊な関数です</li>
</ul>
<div class="sourceCode" id="cb246"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb246-1"><a href="book_02_beginner_2nd_half.html#cb246-1" aria-hidden="true" tabindex="-1"></a>data_7 <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(都道府県) <span class="sc">%&gt;%</span> <span class="fu">summarise</span>(<span class="at">count =</span> <span class="fu">n</span>())</span></code></pre></div>
<div class="columns">
<div class="column" style="width:48%;">
<pre><code># A tibble: 887 x 12
   都道府県 企業コード 本社所在地市区郡 業種大分類 `資本金(千円)` 従業員数
   &lt;chr&gt;    &lt;chr&gt;      &lt;chr&gt;            &lt;chr&gt;               &lt;dbl&gt;    &lt;dbl&gt;
 1 01_北海道~ G92668203  01104_北海道札幌市白石区~ G:卸売・小売業，~        9316300      455
 2 01_北海道~ G92515950  01105_北海道札幌市豊平区~ F:製造業           399000      435
 3 01_北海道~ G22109363  01203_北海道小樽市~ J:運輸・通信業~        1590700      807
 4 01_北海道~ G92543356  01101_北海道札幌市中央区~ E:建設業           252800      903
 5 01_北海道~ G92412006  01101_北海道札幌市中央区~ G:卸売・小売業，~        1748600      606
 6 02_青森県~ H02154711  02202_青森県弘前市~ G:卸売・小売業，~        1247000      288
 7 02_青森県~ H92112963  02203_青森県八戸市~ G:卸売・小売業，~        4006200      571
 8 04_宮城県~ H42536370  04102_宮城県仙台市宮城野~ G:卸売・小売業，~              1      303
 9 04_宮城県~ H42053936  04104_宮城県仙台市太白区~ G:卸売・小売業，~        1966400      168
10 04_宮城県~ H42127369  04102_宮城県仙台市宮城野~ G:卸売・小売業，~        1065600      892
# ... with 877 more rows, and 6 more variables:
#   `最新期業績売上高(百万円)` &lt;dbl&gt;, `最新期業績税引後利益(千円)` &lt;dbl&gt;,
#   都道府県コード &lt;chr&gt;, 都道府県名 &lt;chr&gt;, 売上高利益率 &lt;dbl&gt;,
#   従業員数レンジ &lt;chr&gt;</code></pre>
</div><div class="column" style="width:2%;">

</div><div class="column" style="width:48%;">
<pre><code># A tibble: 38 x 2
   都道府県  count
 * &lt;chr&gt;     &lt;int&gt;
 1 01_北海道     5
 2 02_青森県     2
 3 04_宮城県     5
 4 07_福島県     1
 5 08_茨城県     3
 6 09_栃木県     1
 7 10_群馬県     5
 8 11_埼玉県    15
 9 12_千葉県    15
10 13_東京都   466
# ... with 28 more rows</code></pre>
</div>
</div>
<hr />
<ul>
<li>別の方法として、group_byしたデータを<strong>count()</strong>しても同様な結果を得ることができます</li>
</ul>
<div class="sourceCode" id="cb249"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb249-1"><a href="book_02_beginner_2nd_half.html#cb249-1" aria-hidden="true" tabindex="-1"></a>data_7 <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(都道府県) <span class="sc">%&gt;%</span> <span class="fu">count</span>()</span></code></pre></div>
<div class="columns">
<div class="column" style="width:48%;">
<pre><code># A tibble: 887 x 12
   都道府県 企業コード 本社所在地市区郡 業種大分類 `資本金(千円)` 従業員数
   &lt;chr&gt;    &lt;chr&gt;      &lt;chr&gt;            &lt;chr&gt;               &lt;dbl&gt;    &lt;dbl&gt;
 1 01_北海道~ G92668203  01104_北海道札幌市白石区~ G:卸売・小売業，~        9316300      455
 2 01_北海道~ G92515950  01105_北海道札幌市豊平区~ F:製造業           399000      435
 3 01_北海道~ G22109363  01203_北海道小樽市~ J:運輸・通信業~        1590700      807
 4 01_北海道~ G92543356  01101_北海道札幌市中央区~ E:建設業           252800      903
 5 01_北海道~ G92412006  01101_北海道札幌市中央区~ G:卸売・小売業，~        1748600      606
 6 02_青森県~ H02154711  02202_青森県弘前市~ G:卸売・小売業，~        1247000      288
 7 02_青森県~ H92112963  02203_青森県八戸市~ G:卸売・小売業，~        4006200      571
 8 04_宮城県~ H42536370  04102_宮城県仙台市宮城野~ G:卸売・小売業，~              1      303
 9 04_宮城県~ H42053936  04104_宮城県仙台市太白区~ G:卸売・小売業，~        1966400      168
10 04_宮城県~ H42127369  04102_宮城県仙台市宮城野~ G:卸売・小売業，~        1065600      892
# ... with 877 more rows, and 6 more variables:
#   `最新期業績売上高(百万円)` &lt;dbl&gt;, `最新期業績税引後利益(千円)` &lt;dbl&gt;,
#   都道府県コード &lt;chr&gt;, 都道府県名 &lt;chr&gt;, 売上高利益率 &lt;dbl&gt;,
#   従業員数レンジ &lt;chr&gt;</code></pre>
</div><div class="column" style="width:2%;">

</div><div class="column" style="width:48%;">
<pre><code># A tibble: 38 x 2
# Groups:   都道府県 [38]
   都道府県      n
   &lt;chr&gt;     &lt;int&gt;
 1 01_北海道     5
 2 02_青森県     2
 3 04_宮城県     5
 4 07_福島県     1
 5 08_茨城県     3
 6 09_栃木県     1
 7 10_群馬県     5
 8 11_埼玉県    15
 9 12_千葉県    15
10 13_東京都   466
# ... with 28 more rows</code></pre>
</div>
</div>
</div>
<div id="step13_sanko3" class="section level3" number="3.8.6">
<h3><span class="header-section-number">3.8.6</span> 参考３：ピボットテーブル</h3>
<p>データの横持ち変換（中級編で説明）を行えば、ピボットテーブル形式にもできます</p>
<div class="sourceCode" id="cb252"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb252-1"><a href="book_02_beginner_2nd_half.html#cb252-1" aria-hidden="true" tabindex="-1"></a>data_7 <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(都道府県, 従業員数レンジ) <span class="sc">%&gt;%</span> </span>
<span id="cb252-2"><a href="book_02_beginner_2nd_half.html#cb252-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(従業員数平均 <span class="ot">=</span> <span class="fu">mean</span>(従業員数)) <span class="sc">%&gt;%</span></span>
<span id="cb252-3"><a href="book_02_beginner_2nd_half.html#cb252-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> <span class="st">&quot;従業員数レンジ&quot;</span>, </span>
<span id="cb252-4"><a href="book_02_beginner_2nd_half.html#cb252-4" aria-hidden="true" tabindex="-1"></a>              <span class="at">values_from =</span> <span class="st">&quot;従業員数平均&quot;</span>, <span class="at">values_fill=</span><span class="dv">0</span>)</span></code></pre></div>
<pre><code># A tibble: 38 x 4
# Groups:   都道府県 [38]
   都道府県  `01_500人以下` `02_1000人以下` `03_1000人超`
   &lt;chr&gt;              &lt;dbl&gt;           &lt;dbl&gt;         &lt;dbl&gt;
 1 01_北海道           445             772             0 
 2 02_青森県           288             571             0 
 3 04_宮城県           236.            892          5227 
 4 07_福島県           192               0             0 
 5 08_茨城県             0             525          2158.
 6 09_栃木県           178               0             0 
 7 10_群馬県           192.              0          4822 
 8 11_埼玉県           211.            672.         3029.
 9 12_千葉県           225.            733          2959.
10 13_東京都           221.            723.         3592.
# ... with 28 more rows</code></pre>
</div>
</div>
<div id="ステップ１４条件抽出" class="section level2" number="3.9">
<h2><span class="header-section-number">3.9</span> ステップ１４：条件抽出</h2>
<ul>
<li>filter</li>
</ul>
<div id="sagyou_step14" class="section level3" number="3.9.1">
<h3><span class="header-section-number">3.9.1</span> 作業内容</h3>
<ul>
<li>特定の条件を満たすレコードをデータから抽出します</li>
<li>たとえば、売上高利益率がマイナスの企業は、<strong>filter</strong>を使って以下のようにして抽出できます</li>
</ul>
<div class="sourceCode" id="cb254"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb254-1"><a href="book_02_beginner_2nd_half.html#cb254-1" aria-hidden="true" tabindex="-1"></a>data_7 <span class="sc">%&gt;%</span> <span class="fu">filter</span>(売上高利益率<span class="sc">&lt;</span><span class="dv">0</span>) <span class="sc">%&gt;%</span> <span class="fu">relocate</span>(売上高利益率)</span></code></pre></div>
<div class="columns">
<div class="column" style="width:48%;">
<pre><code># A tibble: 887 x 12
   売上高利益率 企業コード 本社所在地市区郡 業種大分類 `資本金(千円)` 従業員数
          &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;            &lt;chr&gt;               &lt;dbl&gt;    &lt;dbl&gt;
 1        3.41  G92668203  01104_北海道札幌市白石区~ G:卸売・小売業，~        9316300      455
 2        0.49  G92515950  01105_北海道札幌市豊平区~ F:製造業           399000      435
 3        5.05  G22109363  01203_北海道小樽市~ J:運輸・通信業~        1590700      807
 4        3.18  G92543356  01101_北海道札幌市中央区~ E:建設業           252800      903
 5        0.570 G92412006  01101_北海道札幌市中央区~ G:卸売・小売業，~        1748600      606
 6        0.96  H02154711  02202_青森県弘前市~ G:卸売・小売業，~        1247000      288
 7        0.45  H92112963  02203_青森県八戸市~ G:卸売・小売業，~        4006200      571
 8        3.77  H42536370  04102_宮城県仙台市宮城野~ G:卸売・小売業，~              1      303
 9        0.86  H42053936  04104_宮城県仙台市太白区~ G:卸売・小売業，~        1966400      168
10        9.45  H42127369  04102_宮城県仙台市宮城野~ G:卸売・小売業，~        1065600      892
# ... with 877 more rows, and 6 more variables:
#   `最新期業績売上高(百万円)` &lt;dbl&gt;, `最新期業績税引後利益(千円)` &lt;dbl&gt;,
#   都道府県コード &lt;chr&gt;, 都道府県名 &lt;chr&gt;, 都道府県 &lt;chr&gt;,
#   従業員数レンジ &lt;chr&gt;</code></pre>
</div><div class="column" style="width:2%;">

</div><div class="column" style="width:48%;">
<pre><code># A tibble: 53 x 12
   売上高利益率 企業コード 本社所在地市区郡 業種大分類 `資本金(千円)` 従業員数
          &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;            &lt;chr&gt;               &lt;dbl&gt;    &lt;dbl&gt;
 1        -3.44 H72516758  07203_福島県郡山市~ F:製造業          6134400      192
 2        -1.15 D82130703  11102_埼玉県さいたま市北~ G:卸売・小売業，~              1      206
 3       -14.0  B92598280  11221_埼玉県草加市~ G:卸売・小売業，~        2334500       29
 4        -1.48 D22802868  12106_千葉県千葉市美浜区~ G:卸売・小売業，~        1619500       83
 5        -8.31 J34983560  12204_千葉県船橋市~ F:製造業          1413700      143
 6        -5.26 D22716170  12106_千葉県千葉市美浜区~ G:卸売・小売業，~         146800      720
 7        -0.08 J33168656  13109_東京都品川区~ J:運輸・通信業~         263200       16
 8        -0.1  J39262517  13101_東京都千代田区~ G:卸売・小売業，~        1859600      139
 9        -0.13 J31728828  13116_東京都豊島区~ G:卸売・小売業，~         528500      408
10        -0.27 J33707893  13116_東京都豊島区~ F:製造業          1281800      498
# ... with 43 more rows, and 6 more variables:
#   `最新期業績売上高(百万円)` &lt;dbl&gt;, `最新期業績税引後利益(千円)` &lt;dbl&gt;,
#   都道府県コード &lt;chr&gt;, 都道府県名 &lt;chr&gt;, 都道府県 &lt;chr&gt;,
#   従業員数レンジ &lt;chr&gt;</code></pre>
</div>
</div>
</div>
<div id="filterで条件抽出" class="section level3" number="3.9.2">
<h3><span class="header-section-number">3.9.2</span> <strong>filter</strong>で条件抽出</h3>
<ul>
<li>filterの引数に条件式を与えることで、条件式に真であるレコードのみを抽出することができます（<a href="#/step11_sanko">条件式link</a>）</li>
</ul>
<div class="sourceCode" id="cb257"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb257-1"><a href="book_02_beginner_2nd_half.html#cb257-1" aria-hidden="true" tabindex="-1"></a>data_7 <span class="sc">%&gt;%</span> <span class="fu">filter</span>(都道府県名<span class="sc">==</span><span class="st">&quot;大阪府&quot;</span>) <span class="sc">%&gt;%</span> <span class="fu">relocate</span>(都道府県名)</span></code></pre></div>
<pre><code># A tibble: 123 x 12
   都道府県名 企業コード 本社所在地市区郡 業種大分類 `資本金(千円)` 従業員数
   &lt;chr&gt;      &lt;chr&gt;      &lt;chr&gt;            &lt;chr&gt;               &lt;dbl&gt;    &lt;dbl&gt;
 1 大阪府     E32510267  27106_大阪府大阪市西区~ E:建設業          4497700      167
 2 大阪府     E32119566  27227_大阪府東大阪市~ F:製造業          4827300      274
 3 大阪府     E32012305  27128_大阪府大阪市中央区~ F:製造業          7518400      347
 4 大阪府     E32427103  27127_大阪府大阪市北区~ F:製造業          2410500      388
 5 大阪府     E32995244  27113_大阪府大阪市西淀川~ F:製造業          1371100      332
 6 大阪府     E32656531  27128_大阪府大阪市中央区~ F:製造業          3426900      217
 7 大阪府     E12576662  27123_大阪府大阪市淀川区~ L:サービス業~         935400      391
 8 大阪府     E38927358  27128_大阪府大阪市中央区~ I:不動産業        3098700      140
 9 大阪府     E62112080  27128_大阪府大阪市中央区~ F:製造業          3295700      378
10 大阪府     E38334059  27106_大阪府大阪市西区~ G:卸売・小売業，~         335700       74
# ... with 113 more rows, and 6 more variables:
#   `最新期業績売上高(百万円)` &lt;dbl&gt;, `最新期業績税引後利益(千円)` &lt;dbl&gt;,
#   都道府県コード &lt;chr&gt;, 都道府県 &lt;chr&gt;, 売上高利益率 &lt;dbl&gt;,
#   従業員数レンジ &lt;chr&gt;</code></pre>
</div>
<div id="複数条件で抽出" class="section level3" number="3.9.3">
<h3><span class="header-section-number">3.9.3</span> 複数条件で抽出</h3>
<ul>
<li>少し複雑な条件であったり、複数の条件を組み合わせたレコード抽出でもfilterで対処できます</li>
<li>たとえば、次のような条件に合致する企業のレコードを抽出する手順を順に追ってみましょう
<ul>
<li>売上高利益率が10%以上、または売上高が1兆円以上</li>
<li>東京、または大阪の企業である</li>
<li>従業員数が50人未満である</li>
</ul></li>
</ul>
<hr />
<ul>
<li>売上高利益率が10%以上、または売上高が1兆円以上の企業のレコードを抽出します（「または」は「<strong>|</strong>」）</li>
</ul>
<div class="sourceCode" id="cb259"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb259-1"><a href="book_02_beginner_2nd_half.html#cb259-1" aria-hidden="true" tabindex="-1"></a>data_7 <span class="sc">%&gt;%</span> </span>
<span id="cb259-2"><a href="book_02_beginner_2nd_half.html#cb259-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(売上高利益率<span class="sc">&gt;=</span><span class="dv">10</span> <span class="sc">|</span> <span class="st">`</span><span class="at">最新期業績売上高(百万円)</span><span class="st">`</span><span class="sc">&gt;</span><span class="dv">10</span><span class="sc">**</span><span class="dv">6</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb259-3"><a href="book_02_beginner_2nd_half.html#cb259-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(売上高利益率, <span class="st">`</span><span class="at">最新期業績売上高(百万円)</span><span class="st">`</span>)</span></code></pre></div>
<pre><code># A tibble: 239 x 12
   売上高利益率 `最新期業績売上高(百万円)`~ 企業コード 本社所在地市区郡 業種大分類
          &lt;dbl&gt;            &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;            &lt;chr&gt;     
 1         10.1            13524 D82183414  11105_埼玉県さいたま市中~ F:製造業  
 2         41.6            21267 D82325861  11107_埼玉県さいたま市浦~ G:卸売・小売業，~
 3         17.4            37081 D82402989  11211_埼玉県本庄市~ I:不動産業
 4         10.3            34488 J34003761  11206_埼玉県行田市~ F:製造業  
 5         15.8             3415 D22182297  12213_千葉県東金市~ J:運輸・通信業~
 6         14.8            10957 D22153185  12224_千葉県鎌ケ谷市~ J:運輸・通信業~
 7         21.0            23109 D22165655  12217_千葉県柏市 L:サービス業~
 8       3890.               100 J34860668  13101_東京都千代田区~ F:製造業  
 9        301.             12830 J33209601  13116_東京都豊島区~ L:サービス業~
10        230.              4960 J34732870  13109_東京都品川区~ I:不動産業
# ... with 229 more rows, and 7 more variables: `資本金(千円)` &lt;dbl&gt;,
#   従業員数 &lt;dbl&gt;, `最新期業績税引後利益(千円)` &lt;dbl&gt;, 都道府県コード &lt;chr&gt;,
#   都道府県名 &lt;chr&gt;, 都道府県 &lt;chr&gt;, 従業員数レンジ &lt;chr&gt;</code></pre>
<hr />
<ul>
<li>先ほどの条件に加えて、東京or大阪の企業であるという条件を追加します（<strong>%in% ~</strong>で、~に含まれてればTRUE）</li>
</ul>
<div class="sourceCode" id="cb261"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb261-1"><a href="book_02_beginner_2nd_half.html#cb261-1" aria-hidden="true" tabindex="-1"></a>data_7 <span class="sc">%&gt;%</span> </span>
<span id="cb261-2"><a href="book_02_beginner_2nd_half.html#cb261-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(売上高利益率<span class="sc">&gt;=</span><span class="dv">10</span> <span class="sc">|</span> <span class="st">`</span><span class="at">最新期業績売上高(百万円)</span><span class="st">`</span><span class="sc">&gt;</span><span class="dv">10</span><span class="sc">**</span><span class="dv">6</span>,</span>
<span id="cb261-3"><a href="book_02_beginner_2nd_half.html#cb261-3" aria-hidden="true" tabindex="-1"></a>         都道府県名 <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;東京都&quot;</span>, <span class="st">&quot;大阪府&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb261-4"><a href="book_02_beginner_2nd_half.html#cb261-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(売上高利益率, <span class="st">`</span><span class="at">最新期業績売上高(百万円)</span><span class="st">`</span>, 都道府県名)</span></code></pre></div>
<pre><code># A tibble: 165 x 12
   売上高利益率 `最新期業績売上高(百万円)`~ 都道府県名 企業コード 本社所在地市区郡
          &lt;dbl&gt;            &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;      &lt;chr&gt;           
 1       3890.               100 東京都     J34860668  13101_東京都千代田区~
 2        301.             12830 東京都     J33209601  13116_東京都豊島区~
 3        230.              4960 東京都     J34732870  13109_東京都品川区~
 4        123.              1115 東京都     J36311119  13101_東京都千代田区~
 5         81.2             5905 東京都     J34353008  13103_東京都港区
 6         72.2            15374 東京都     J33418285  13101_東京都千代田区~
 7         54.3             1116 東京都     J31963141  13104_東京都新宿区~
 8         42.4             8029 東京都     J31486759  13101_東京都千代田区~
 9         36.8             3316 東京都     J36322142  13113_東京都渋谷区~
10         36.0            29345 東京都     J33003842  13101_東京都千代田区~
# ... with 155 more rows, and 7 more variables: 業種大分類 &lt;chr&gt;,
#   `資本金(千円)` &lt;dbl&gt;, 従業員数 &lt;dbl&gt;, `最新期業績税引後利益(千円)` &lt;dbl&gt;,
#   都道府県コード &lt;chr&gt;, 都道府県 &lt;chr&gt;, 従業員数レンジ &lt;chr&gt;</code></pre>
<hr />
<ul>
<li>先ほどの条件に加えて、従業員数が50人未満の企業であるという条件を追加します</li>
</ul>
<div class="sourceCode" id="cb263"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb263-1"><a href="book_02_beginner_2nd_half.html#cb263-1" aria-hidden="true" tabindex="-1"></a>data_7 <span class="sc">%&gt;%</span> </span>
<span id="cb263-2"><a href="book_02_beginner_2nd_half.html#cb263-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(売上高利益率<span class="sc">&gt;=</span><span class="dv">10</span> <span class="sc">|</span> <span class="st">`</span><span class="at">最新期業績売上高(百万円)</span><span class="st">`</span><span class="sc">&gt;</span><span class="dv">10</span><span class="sc">**</span><span class="dv">6</span>,</span>
<span id="cb263-3"><a href="book_02_beginner_2nd_half.html#cb263-3" aria-hidden="true" tabindex="-1"></a>         都道府県名 <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;東京都&quot;</span>, <span class="st">&quot;大阪府&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb263-4"><a href="book_02_beginner_2nd_half.html#cb263-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(従業員数 <span class="sc">&lt;</span> <span class="dv">50</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb263-5"><a href="book_02_beginner_2nd_half.html#cb263-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(売上高利益率, <span class="st">`</span><span class="at">最新期業績売上高(百万円)</span><span class="st">`</span>, 都道府県名, 従業員数)</span></code></pre></div>
<pre><code># A tibble: 10 x 12
   売上高利益率 `最新期業績売上高(百万円)`~ 都道府県名 従業員数 企業コード
          &lt;dbl&gt;            &lt;dbl&gt; &lt;chr&gt;         &lt;dbl&gt; &lt;chr&gt;     
 1        230.              4960 東京都           35 J34732870 
 2         81.2             5905 東京都           33 J34353008 
 3         54.3             1116 東京都           22 J31963141 
 4         26.9           151194 東京都           24 J34020161 
 5         24.0            36479 東京都           48 J34014761 
 6         17.2            10673 東京都           39 J22144564 
 7         14.6            10133 東京都           16 J34338556 
 8         11.3            22639 東京都           11 J30572230 
 9         11              17870 東京都           43 J34500137 
10         12.6            24151 大阪府            1 E38259980 
# ... with 7 more variables: 本社所在地市区郡 &lt;chr&gt;, 業種大分類 &lt;chr&gt;,
#   `資本金(千円)` &lt;dbl&gt;, `最新期業績税引後利益(千円)` &lt;dbl&gt;,
#   都道府県コード &lt;chr&gt;, 都道府県 &lt;chr&gt;, 従業員数レンジ &lt;chr&gt;</code></pre>
</div>
</div>
<div id="ステップ１５ファイル出力" class="section level2" number="3.10">
<h2><span class="header-section-number">3.10</span> ステップ１５：ファイル出力</h2>
<ul>
<li>write_csv</li>
</ul>
<div id="sagyou_step15" class="section level3" number="3.10.1">
<h3><span class="header-section-number">3.10.1</span> 作業内容</h3>
<ul>
<li>作成したデータをcsv形式で出力し保存します</li>
<li>データを保存する前にデータの見栄えを整えましょう</li>
<li>見栄えを整えるために次の2つの作業を行います
<ul>
<li>不要な変数の消去</li>
<li>カラムの並び替え</li>
</ul></li>
<li>見栄えを整えたらcsvで保存します</li>
</ul>
</div>
<div id="不要な変数の消去" class="section level3" number="3.10.2">
<h3><span class="header-section-number">3.10.2</span> 不要な変数の消去</h3>
<ul>
<li>処理の過程で発生した不要な変数を消去します</li>
<li>消去する変数は、“本社所在地市区郡”, “都道府県コード”, “都道府県名”の3つです</li>
<li>初級編前半で説明したように、selectで<strong>ー変数名</strong>とすることで変数消去できます</li>
<li>不要な変数を消去したデータをdata_8とします</li>
</ul>
<div class="sourceCode" id="cb265"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb265-1"><a href="book_02_beginner_2nd_half.html#cb265-1" aria-hidden="true" tabindex="-1"></a>data_8 <span class="ot">&lt;-</span> data_7 <span class="sc">%&gt;%</span> </span>
<span id="cb265-2"><a href="book_02_beginner_2nd_half.html#cb265-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="st">&quot;本社所在地市区郡&quot;</span>, <span class="sc">-</span><span class="st">&quot;都道府県コード&quot;</span>, <span class="sc">-</span><span class="st">&quot;都道府県名&quot;</span>) </span>
<span id="cb265-3"><a href="book_02_beginner_2nd_half.html#cb265-3" aria-hidden="true" tabindex="-1"></a>data_8 <span class="sc">%&gt;%</span> <span class="fu">colnames</span>()</span></code></pre></div>
<pre><code>[1] &quot;企業コード&quot;                 &quot;業種大分類&quot;                
[3] &quot;資本金(千円)&quot;               &quot;従業員数&quot;                  
[5] &quot;最新期業績売上高(百万円)&quot;   &quot;最新期業績税引後利益(千円)&quot;
[7] &quot;都道府県&quot;                   &quot;売上高利益率&quot;              
[9] &quot;従業員数レンジ&quot;            </code></pre>
</div>
<div id="カラムの並び替え" class="section level3" number="3.10.3">
<h3><span class="header-section-number">3.10.3</span> カラムの並び替え</h3>
<ul>
<li>並び変えたい順番でカラム名をselectすることで、カラムを並び変えることができます（ここで不要カラムをselectしなければ、変数消去は不要な作業になります）</li>
<li>カラムを並び替えたデータをdata_9とします</li>
</ul>
<div class="sourceCode" id="cb267"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb267-1"><a href="book_02_beginner_2nd_half.html#cb267-1" aria-hidden="true" tabindex="-1"></a>data_9 <span class="ot">&lt;-</span> data_8 <span class="sc">%&gt;%</span></span>
<span id="cb267-2"><a href="book_02_beginner_2nd_half.html#cb267-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="st">&quot;企業コード&quot;</span>, <span class="st">&quot;都道府県&quot;</span>, <span class="st">&quot;従業員数&quot;</span>,</span>
<span id="cb267-3"><a href="book_02_beginner_2nd_half.html#cb267-3" aria-hidden="true" tabindex="-1"></a>         <span class="st">&quot;業種大分類&quot;</span>,<span class="st">&quot;最新期業績売上高(百万円)&quot;</span>,</span>
<span id="cb267-4"><a href="book_02_beginner_2nd_half.html#cb267-4" aria-hidden="true" tabindex="-1"></a>         <span class="st">&quot;最新期業績税引後利益(千円)&quot;</span>, <span class="st">&quot;売上高利益率&quot;</span>, </span>
<span id="cb267-5"><a href="book_02_beginner_2nd_half.html#cb267-5" aria-hidden="true" tabindex="-1"></a>         <span class="st">&quot;従業員数レンジ&quot;</span>)</span>
<span id="cb267-6"><a href="book_02_beginner_2nd_half.html#cb267-6" aria-hidden="true" tabindex="-1"></a>data_9 <span class="sc">%&gt;%</span> <span class="fu">colnames</span>()</span></code></pre></div>
<pre><code>[1] &quot;企業コード&quot;                 &quot;都道府県&quot;                  
[3] &quot;従業員数&quot;                   &quot;業種大分類&quot;                
[5] &quot;最新期業績売上高(百万円)&quot;   &quot;最新期業績税引後利益(千円)&quot;
[7] &quot;売上高利益率&quot;               &quot;従業員数レンジ&quot;            </code></pre>
</div>
<div id="output_file" class="section level3" number="3.10.4">
<h3><span class="header-section-number">3.10.4</span> <strong>write_csv</strong>でcsvファイルの出力</h3>
<ul>
<li>データの見栄えを整え終わったら、write_csvを使ってcsvファイルを出力します</li>
<li>出力先は、outputフォルダとします</li>
<li>第一引数にデータ、第二引数にpathを指定します
<ul>
<li>pathの末端がファイル名となります</li>
<li>拡張子を付けるのを忘れないようにしましょう</li>
<li>出力先フォルダが存在しないとエラーになります</li>
</ul></li>
<li>encodingは<strong>UTF-8</strong>になります（現状は変更不可）</li>
</ul>
<div class="sourceCode" id="cb269"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb269-1"><a href="book_02_beginner_2nd_half.html#cb269-1" aria-hidden="true" tabindex="-1"></a>data_9 <span class="sc">%&gt;%</span></span>
<span id="cb269-2"><a href="book_02_beginner_2nd_half.html#cb269-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">write_csv</span>(<span class="fu">here</span>(<span class="st">&quot;output/研磨後最終ファイル.csv&quot;</span>))</span></code></pre></div>
</div>
<div id="step15_sanko" class="section level3" number="3.10.5">
<h3><span class="header-section-number">3.10.5</span> 参考：ファイル出力のencoding</h3>
<ul>
<li>readrパッケージのwrite_csv関数では、encodingは“UTF-8”でしか出力することができません</li>
<li>理由としては恐らく、HTML5などのマークアップ言語との兼ね合いで“UTF-8”が推奨されているからです</li>
<li>それでも、<strong>“shift-jis”</strong>など“UTF-8”以外での出力が求められることもあります</li>
<li>以上の理由から、参考として“UTF-8”以外での出力方法も紹介します</li>
</ul>
<hr />
<ul>
<li>base関数の<strong>write.csv</strong>関数を使用することで、“UTF-8”以外でのファイル出力ができます</li>
<li>引数row.namesを必ずFALSEにするようにしましょう
<ul>
<li>tibbleではrow namesは使用されません</li>
<li>デフォルトではTRUEになっています</li>
</ul></li>
<li>引数fileEncodingで、encodingを指定します</li>
</ul>
<div class="sourceCode" id="cb270"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb270-1"><a href="book_02_beginner_2nd_half.html#cb270-1" aria-hidden="true" tabindex="-1"></a>data_9 <span class="sc">%&gt;%</span></span>
<span id="cb270-2"><a href="book_02_beginner_2nd_half.html#cb270-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">write.csv</span>(<span class="fu">here</span>(<span class="st">&quot;output/研磨後最終ファイル.csv&quot;</span>), </span>
<span id="cb270-3"><a href="book_02_beginner_2nd_half.html#cb270-3" aria-hidden="true" tabindex="-1"></a>            <span class="at">row.names =</span> <span class="cn">FALSE</span>,</span>
<span id="cb270-4"><a href="book_02_beginner_2nd_half.html#cb270-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">fileEncoding =</span> <span class="st">&quot;shift-jis&quot;</span>)</span></code></pre></div>
</div>
</div>
<div id="おわり-1" class="section level2 unnumbered">
<h2>おわり</h2>
<p>これで初級編は終了です。お疲れさまでした。</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="book_01_beginner_1st_half.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="book_03_intermediate_1st_half.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 1
},
"edit": null,
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "section",
"scroll_highlight": true
},
"toolbar": {
"position": "fixed"
},
"search": true,
"info": true
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
